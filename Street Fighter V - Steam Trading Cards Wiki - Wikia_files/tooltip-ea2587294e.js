define(["base_ui_module","zeus_utils"],function(t){var e,o=window.ZeusConstants,l=null,n=[],i=5,s=ZeusUtils.css,r=t.subclass({constructor:function(o){t.prototype.constructor.call(this,o),this._container=document.getElementById("tooltip-container"),e=this},init:function(){for(var t=this,e=document.getElementsByClassName("bolt-tooltip"),o=e.length,l=0;o>l;l++){var i=e[l],s=i.parentNode,r={tooltip:i,target:s,pointer:t._createTooltipPointer(i),isOpen:!1};i.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation()}),s.addEventListener("mouseenter",t.open.bind(s)),s.addEventListener("mouseleave",t.close.bind(s)),n.push(r)}for(var a in n)t._container.appendChild(n[a].tooltip);this.invalidate()},_createTooltipPointer:function(t){t.style.display="none",t.style.visibility="visible";var e=getComputedStyle(t).backgroundColor;LOG.info("tooltip bg color",e);var o=document.createElement("div");return o.setAttribute("class","tooltip-pointer"),o.style.position="absolute",o.style.width=0,o.style.height=0,o.style.borderWidth=i+"px",o.style.borderStyle="solid",o.style.borderColor=e+" transparent transparent",o.style.top=getComputedStyle(t).height,s.hasClass(t,"bolt-tooltip-bottom")&&(o.style.borderColor="transparent transparent "+e+" transparent"),t.appendChild(o),o},invalidate:function(){for(var t in n){var e=n[t];if(e.isOpen){var o=e.tooltip,l=parseFloat(getComputedStyle(o).width),r=parseFloat(getComputedStyle(o).height),a=e.pointer,p=a.offsetWidth,u=a.offsetHeight,d=e.target,c=d.offsetWidth,y=d.offsetHeight,f=ZeusUtils.getScreenPosition(d);s.hasClass(o,"bolt-tooltip-bottom")?(o.style.top=f.y+y+"px",a.style.top=-(r-u)+"px",a.style.borderColor="transparent transparent "+getComputedStyle(o).backgroundColor+" transparent"):(o.style.top=f.y-r-5+"px",a.style.borderColor=getComputedStyle(o).backgroundColor+" transparent transparent"),s.hasClass(o,"bolt-tooltip-right")?(a.style.left="auto",a.style.right=l-i+"px"):s.hasClass(o,"bolt-tooltip-left")?(a.style.right="auto",a.style.left=i+(c-2*i-p)/2+"px"):(o.style.left=f.x+(c/2-l/2)+"px",a.style.right="auto",a.style.left=(l-p)/2+"px")}}},open:function(){l&&clearTimeout(l);var t=this;for(var i in n){var s=n[i],r=s.tooltip;s.pointer;if(s.target===t){l=setTimeout(function(){clearTimeout(l),l=null,r.style.display="block",s.isOpen=!0,e.invalidate(),l=setTimeout(function(){clearTimeout(l),r.style.display="none"},1e3)},o.UI.TOOLTIP_DELAY);break}r.style.display="none",s.isOpen=!1}},close:function(){l&&(clearTimeout(l),l=null);var t=this,e=null;for(var o in n){var i=n[o];i.target===t&&(e=i.tooltip,e.style.display="none",i.isOpen=!1)}},_getTooltipOfElement:function(t,e){var o=t.querySelector('*[class*="bolt-tooltip"]');return o&&e?o.firstElementChild:o},setLabel:function(t,e){if(t){var o=this._getTooltipOfElement(t,!0);o&&(o.textContent=e)}}});return r});