define("zeus_constants",[],function(){return window.ZeusConstants={PLAYWIRE_GA:"UA-19528293-3",FLASHVERSION:"11",Ad:{PLAYER_ID_PREFIX:"ad_",VPAID_SHIM:window.zeusBaseUrl+"/swf/zeusvpaidplayer-2079610333.swf",IMA_SHIM:window.zeusBaseUrl+"/swf/zeusima-f558b27266.swf",Type:{FLASH_VPAID:"flash-vpaid",JS_VPAID:"js-vpaid",VAST:"vast",GOOGLE:"google",STATIC_IMAGE:"static-image",THREE_TWO_FIFTY:"video300x250",OVERLAY:"overlay"},Provider:{COULL:"coull",LIVERAIL:"liverail",YUME:"yume",GOOGLE:"google",ADOTUBE:"adotube",AOL:"aol",SPOTX:"spotx",ADAP:"adap"},Event:{CLICKED:"adClicked",CLOSED:"adClosed",COMPLETED:"adCompleted",FAILED:"adFailed",REMAINING_TIME_CHANGED:"adRemainingTimeChanged",REQUESTED:"adRequested",SKIPPED:"adSkipped",STARTED:"adStarted",LINEAR_CHANGED:"linearChanged",EXPANDED_CHANGED:"expandedChanged",READY:"adReady",CONTENT_PAUSE_REQUESTED:"contentPauseRequested",CONTENT_RESUME_REQUESTED:"contentResumeRequested",CUEPOINT:"adCuepoint",ABORTED:"adAborted",SESSION_START:"adSessionStart",SESSION_END:"adSessionEnd",SESSION_FAIL:"adSessionFail",SESSION_ABORT:"adSessionAbort",SESSION_AD_LOADED:"adSessionAdLoaded",SESSION_BLOCKED:"adSessionBlocked",REQUEST_START:"adRequestStart",REQUEST_FAIL:"adRequestFail",REQUEST_ABORT:"adRequestAbort",REQUEST_SUCCESS:"adRequestSuccess",TRACKING:"adTracking",VMAP_CUEPOINTS_CHANGED:"VMAPCuepointsChanged",SS_REQUESTED:"ssRequested",SS_FAILED:"ssFailed",SS_LOADED:"ssLoaded",SS_BACKFILL_REQUESTED:"ssBackfillRequested",SS_BACKFILL_SUCCESS:"ssBackfillSuccess",SS_BACKFILL_FAILED:"ssBackfillFailed"},IMA_ENABLED:!1},Player:{ID_PREFIX:"video_",SKIN_ID_PREFIX:"skin_",SWFROOT:window.zeusBaseUrl+"/swf",FLASH_SHIM:window.zeusBaseUrl+"/swf/zeusplayer-9298ef2f7b.swf",CORS_SHIM:window.zeusBaseUrl+"/swf/zeuscorsshim-b9284c11b6.swf",VIDEO_SHIM:window.zeusBaseUrl+"/swf/zeusvideoplayer-0b5569794a.swf",SWF_PLAYER:window.zeusBaseUrl+"/swf/zeusswfplayer-61b9b07fd4.swf",Event:{CANPLAY:"canplay",CANPLAYTHROUGH:"canplaythrough",CONTENT_CHANGED:"contentChanged",ENTER_FULLSCREEN:"enterFullscreen",EXIT_FULLSCREEN:"exitFullscreen",QUALITY_CHANGED:"qualityChanged",READY:"playerReady",REMOVED:"removed",SIZE_CHANGED:"sizeChanged",VIEW_READY:"viewReady",VIEW_REMOVED:"viewRemoved",CONFIG_CHANGED:"configChanged",CONFIG_NOT_FOUND:"configNotFound",FATAL_ERROR:"fatalError"}},Media:{Event:{DURATION_CHANGE:"media_durationchange",EMPTIED:"media_emptied",ENDED:"media_ended",FIRSTQUARTILE:"media_firstQuartile",LOAD_PROGRESS:"media_loadProgress",LOAD_START:"media_loadstart",LOADED:"media_loaded",METADATA:"media_metadataLoaded",MIDPOINT:"media_midpoint",MUTED:"media_muted",PAUSED:"media_pause",PLAY:"media_play",PLAYING:"media_playing",RESUME:"media_resume",SEEKED:"media_seeked",SEEKING:"media_seeking",START_TIME_CHANGED:"media_startTimeChanged",STOPPED:"media_stopped",THIRDQUARTILE:"media_thirdQuartile",TIME_UPDATE:"media_timeupdate",UNMUTED:"media_unmuted",VOLUME_CHANGED:"media_volumechanged",WAITING:"media_waiting",NOT_FOUND:"media_NotFound",NOT_SUPPORTED:"media_NotSupported"}},ERROR:"error",VALUE_CHANGED:"valueChanged",Mime:{"3GP":"video/3gpp","3GP2":"video/3gpp2",F4M:"application/f4m",FLV:"video/x-flv",MOV:"video/mov",MP4:"video/mp4",MPEG:"video/mpeg",OGG:"video/ogg",WEBM:"video/webm",SWF:"application/x-shockwave-flash",XJS:"application/x-javascript",JS:"application/javascript",M3U8:"application/vnd.apple.mpegurl"},UI:{AD_CUEPOINTS_CONTAINER:"cuepoints-container",AD_TITLE:"ad-title",AGE_GATE_DAY_INPUT:"age-gate-day-input",AGE_GATE_FORM:"age-gate-form",AGE_GATE_FORM_SUBMIT:"age-gate-form-submit",AGE_GATE_LAYER:"age-gate-layer",AGE_GATE_MONTH_INPUT:"age-gate-month-input",AGE_GATE_YEAR_INPUT:"age-gate-year-input",AGE_GATE_FAILED_MESSAGE:"age-gate-failed-message",AGE_GATE_INPUT_ERROR:"age-gate-input-error",BIG_PLAY:"big-play-layer",CONTENT:"content",EMBED_CODE_CONTAINER:"embed-code-container",EMBED_CODE_INPUT:"embed-code-input",ERROR_CONTAINER:"error-container",SHARING_CODE_CONTAINER:"sharing-code-container",SHARING_CODE_INPUT:"sharing-code-input",SOCIAL_SHARE_CONTAINER:"social-share-container",MAIN_VIDEO_CONTAINER:"main-video-container",AD_CONTAINER:"ad-container",BRANDING:"branding",CONTROLBAR:"control-bar",CUEPOINT:"cuepoint",FULLSCREEN_BTN:"fullscreen-btn",LOADING_INDICATOR:"loading-indicator",MUTED_ICON:"muted-icon",PAUSE_ICON:"pause-icon",PLAY_ICON:"play-icon",PLAY_PAUSE_BTN:"play-pause-btn",PLAYLIST:"playlist",PLAYLIST_BTN:"playlist-btn",POSTER:"poster-container",RELATED_VIDEOS:"related-videos",REPLAY_ICON:"replay-icon",REPLAY_BTN:"replay-btn",SCRUBBER:"scrubber",SCRUBBER_TOOLTIP_CONTAINER:"scrubber-tooltip-container",SETTINGS_BTN:"settings-btn",SETTINGS_MENU:"settings-menu",SHARING_BTN:"sharing-btn",SHARING_MENU:"sharing-menu",SKIP_AD_BTN:"skip-ad-btn",SOUND_BTN:"sound-btn",SOUND_ICON:"sound-icon",STATIC_AD_CONTAINER:"static-ad-container",SUBTITLE_TEXT:"subtitle-text",SUBTITLE_BTN:"subtitle-btn",SUBTITLE_MENU:"subtitle-menu",TIME_TEXT:"time-text",TIMERAIL:"timerail",TIMERAIL_BUFFER:"timerail-buffer-bar",TIMERAIL_INTERACTIVE:"timerail-interactive",TIMERAIL_PROGRESS:"timerail-progress-bar",TITLE_TEXT:"title-text",TITLE_BAR:"title-bar",UI_DISABLED_CLASS:"bolt-disabled",UI_ENABLED_CLASS:"bolt-enabled",UI_HIGHLIGHT_CLASS:"bolt-hover-highlight",VIDEO_AD_CONTAINER:"video-ad-container",VIDEO_CONTAINER:"video-container",VIDEO_OVERLAY:"video-overlay",VOLUME_CONTROL:"volume-control",WATERMARK:"watermark",WATERMARK_IMG:"watermark-img",TOOLTIP_DELAY:1e3,Event:{PLAYER_CHANGED:"playerChanged",AGE_GATE_FAILED:"ageGateFailed",AGE_GATE_PASSED:"ageGatePassed",PLAYLIST_ITEM_SELECTED:"playlistItemSelected",PLAYPAUSE:"playpause",REQUEST_QUALITY:"requestQuality",RELATED_VIDEO_SELECTED:"relatedVideoSelected",REPLAY:"replay",SUBTITLE_SELECTED:"subtitleSelected",SEEK:"seek",TOGGLE_MUTE:"toggleMute",MOUSE_OUT:"mouseOut",MOUSE_OVER:"mouseOver",MOUSE_CLICK:"mouseClick",CHANGE_VOLUME:"changeVolume",REQUEST_FULLSCREEN_CHANGE:"requestFullscreenChange",APPEARANCE_SETTINGS_CHANGED:"appearanceChanged",INITIAL_APPEARANCE_SETTINGS_LOADED:"initialAppearanceSettingsLoaded"}}},window.ZeusConstants}),define("playerlogger",[],function(){function e(e){return typeof console===d?!1:void 0!==console[e]?t(console,e):void 0!==console.log?t(console,"log"):s}function t(e,t){var i=e[t];if("function"==typeof i.bind)return i.bind(e);try{return Function.prototype.bind.call(i,e)}catch(n){return function(){return Function.prototype.apply.apply(i,[e,arguments])}}}function i(e,t){return function(){typeof console!==d&&(n(t),o[e].apply(o,arguments))}}function n(e){for(var t=0;t<l.length;t++){var i=l[t];o[i]=e>t?s:o.methodFactory(i,e)}}function a(e){var t=(l[e]||"silent").toUpperCase();try{return void(window.localStorage.loglevel=t)}catch(i){}try{window.document.cookie="loglevel="+t+";"}catch(i){}}function r(){var e;try{e=window.localStorage.loglevel}catch(t){}if(typeof e===d)try{e=/loglevel=([^;]+)/.exec(window.document.cookie)[1]}catch(t){}void 0===o.levels[e]&&(e="WARN"),o.setLevel(o.levels[e])}var o={},s=function(){},d="undefined",l=["trace","debug","info","warn","error"];o.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},o.methodFactory=function(t,n){return e(t)||i(t,n)},o.setLevel=function(e){if("string"==typeof e&&void 0!==o.levels[e.toUpperCase()]&&(e=o.levels[e.toUpperCase()]),!("number"==typeof e&&e>=0&&e<=o.levels.SILENT))throw"log.setLevel() called with invalid level: "+e;return a(e),n(e),typeof console===d&&e<o.levels.SILENT?"No console available for logging":void 0},o.enableAll=function(){o.setLevel(o.levels.TRACE)},o.disableAll=function(){o.setLevel(o.levels.SILENT)};var u=typeof window!==d?window.log:void 0;return o.noConflict=function(){return typeof window!==d&&window.log===o&&(window.log=u),o},r(),window.DebugMode&&DebugMode.on?o.enableAll():o.disableAll(),o}),define("zeus_utils",["playerlogger","zeus_constants"],function(e,t){Array.prototype.find||(Array.prototype.find=function(e){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,i=Object(this),n=i.length>>>0,a=arguments[1],r=0;n>r;r++)if(t=i[r],e.call(a,t,r,i))return t});var i={getScreenPosition:function(e){for(var t=0,i=0;e;)t+=e.offsetLeft-e.scrollLeft+e.clientLeft,i+=e.offsetTop-e.scrollTop+e.clientTop,e=e.offsetParent;return{x:t,y:i}},getValidCuepoints:function(e,t){var i=60;return 0>=t||!e||0==e.length?[]:function n(e){for(var a,r=e.concat(),o=[],s=0;s<r.length;s++){var d=r[s];if(0==s&&i>d){a=s;break}if(s===r.length-1&&i>t-d){a=s;break}if(s>0&&d-r[s-1]<i){a=s;break}o.push(d)}return"number"==typeof a?(r.splice(a,1),n(r)):o}(e)},toHHMMSS:function(e){var t=parseInt(e,10),i=Math.floor(t/3600),n=Math.floor((t-3600*i)/60),a=t-3600*i-60*n;i>0&&10>n&&(n="0"+n),10>a&&(a="0"+a);var r=i+":"+n+":"+a;return 0==parseInt(i)&&(r=n+":"+a),r},fastSeekEnabled:function(e){return window.client.system.iphone?!1:!/.m3u8/.test(e)&&/^https?:\/\/cdn(\..+?)?.(playwire|intergi).com/.test(e)},data:{sortNumericArray:function(e,t){return e.concat().sort(function(e,i){return e>i?t?-1:1:i>e?t?1:-1:0})},getUniqueArray:function(e){var t=[];return e.forEach(function(e){-1===t.indexOf(e)&&t.push(e)}),t}},ad:{filterAdMedia:function(e){var i=window.client,n={};for(var a in e){var r=e[a];a===t.Mime.FLV||a===t.Mime.SWF?i.hasFlash&&"streaming"!=r.delivery&&(n[a]=r):a===t.Mime.MP4&&-1!=i.supportedVideoTypes.indexOf("mp4")?n[a]=r:a===t.Mime.OGG&&-1!=i.supportedVideoTypes.indexOf("ogg")?n[a]=r:a===t.Mime.WEBM&&-1!=i.supportedVideoTypes.indexOf("webm")?n[a]=r:"video/3gpp"===a&&-1!=i.supportedVideoTypes.indexOf("3gpp")?n[a]=r:a===t.Mime.M3U8&&-1!=i.supportedVideoTypes.indexOf("m3u8")?n[a]=r:"VPAID"!==r.apiFramework||"application/javascript"!==a&&"application/x-javascript"!==a||(n[a]=r)}return n},getBestMedia:function(e,t){var n;console.group("Finding best media"),i.log.info("supported media",e),i.log.info("priority",t);for(var a=0;a<t.length;a++){var r=t[a];if(i.log.info("type",r),e.hasOwnProperty(r)){n=e[r];break}}return i.log.info("BEST MEDIA",n),console.groupEnd(),n}},getPlayableMediaWithQuality:function(e,i,n,a){var r=t.Mime.MP4;i.indexOf(".webm")>-1?r=t.Mime.WEBM:i.indexOf(".flv")>-1?r=t.Mime.FLV:i.indexOf(".mov")>-1?r=t.Mime.MOV:i.indexOf(".swf")>-1?r=t.Mime.SWF:i.indexOf(".ogg")>-1?r=t.Mime.OGG:i.indexOf(".m3u8")>-1&&(r=t.Mime.M3U8);var o,s=null!=e[n]?n:"sd",d=e[s];for(var l in d)if(l===r){o=d[l];break}return o?{source:o,quality:s}:(console.warn("cannot find ",s,"source of type ",r,". Trying to find another video type."),(o=this.selectSourceFile(d))?{source:o,quality:s}:(console.error("cannot find ",s,"video."),null))},selectSourceFile:function(e){var i,n,a=this,r=document.body,o=window.client,s=window.client.supportedVideoTypes;LOG.info("available media",e),LOG.info("supported video types",s);for(var d in e){i=e[d],n=d;var l=!1;if(n===t.Mime.M3U8?(l=s.indexOf("m3u8")>-1,l?a.css.removeClass(r,"m3u8_not_supported"):a.css.addClass(r,"m3u8_not_supported")):n===t.Mime.MP4?(l=s.indexOf("mp4")>-1,l?o.isMobile?a.css.removeClass(r,"mp4_not_supported"):a.css.removeClass(r,"flash_required"):o.isMobile?a.css.addClass(r,"mp4_not_supported"):a.css.addClass(r,"flash_required")):n===t.Mime.WEBM?(l=s.indexOf("webm")>-1,l?a.css.removeClass(r,"webm_not_supported"):a.css.addClass(r,"webm_not_supported")):n===t.Mime.OGG?(l=s.indexOf("ogg")>-1,l?a.css.removeClass(r,"ogg_not_supported"):a.css.addClass(r,"ogg_not_supported")):"video/3gpp"===n?(l=s.indexOf("3gpp")>-1,!l&&r?a.css.addClass(r,"threegpp_not_supported"):a.css.removeClass(r,"thregpp_not_supported")):n===t.Mime.FLV&&(l=s.indexOf("flv")>-1,l?a.css.removeClass(r,"flv_not_supported"):o.isMobile?a.css.addClass(r,"flv_not_supported"):a.css.addClass(r,"flash_required")),l)return i}return null},processMediaConfig:function(e,t,n){function a(e){r=i.f4m.createNormalizedMediaDictionary(e,n),t.call(null,r)}var r;if(e.f4m){var o=e.f4m;o=i.normalizeProtocol(o),i.xhr(o,"get",null,a,null,"text")}else{var s=Object.keys(e),d=!isNaN(s[0]);d?(r=i.transformMedia(e),t.call(null,r)):t.call(null,e)}},f4m:{parse:function(e,t){var n=new DOMParser,a=n.parseFromString(e,"application/xml"),r=a.getElementsByTagName("baseURL")[0].textContent.trim();window.site.isSecure&&(r=0===r.indexOf("//")?"https:"+r:r.replace("http:","https:"));var o=(a.getElementsByTagName("id")[0].textContent,parseFloat(a.getElementsByTagName("duration")[0].textContent),a.getElementsByTagName("media"));if(o.length>1)try{for(var s=[],d=0;d<o.length;d++)s.push(o[d]);o=s.sort(function(e,t){var i=parseInt(e.getAttribute("bitrate")),n=parseInt(t.getAttribute("bitrate"));return n>i?-1:i>n?1:0})}catch(l){}var u={};for(t||(t=window.client.supportedVideoTypes),d=0;d<o.length;d++){var c=o[d],h=c.getAttribute("url"),p=/.(mp4|m4v|ogg|webm|m3u8)/i,f=h.match(p);if(f&&(f=f[1],t.indexOf(f)>-1)){var v=i.f4m.attrToObject(r,c,f);"m4v"===f&&(f="mp4",v.fileExtension="mp4"),u[f]||(u[f]={}),"m3u8"===f?h.indexOf("abr-hd")>-1?u[f].hd=v:h.indexOf("abr-non-hd")>-1?u[f].sd=v:u[f].hd?u[f].sd||h.indexOf("video-sd")>-1&&(u[f].sd=v):h.indexOf("video-hd")>-1&&(u[f].hd=v):h.indexOf("video-hd")>-1?u[f].hd=v:h.indexOf("video-sd")>-1?u[f].sd=v:h.indexOf("video-mobile")>-1?u[f].mobile=v:h.indexOf("-hd")>-1?u[f].hd=v:u[f].sd=v}}return u},createNormalizedMediaDictionary:function(e,n){var a,r,o=i.f4m.parse(e,n);o.m3u8?(a=t.Mime.M3U8,r=o.m3u8):o.mp4?(a=t.Mime.MP4,r=o.mp4):o.webm?(a=t.Mime.WEBM,r=o.webm):o.ogg&&(a=t.Mime.OGG,r=o.ogg);var s=window.client;s.isMobile?r.hd&&r.mobile?(r.sd=r.mobile,delete r.mobile):!r.hd&&r.sd&&r.mobile&&(r.hd=r.sd,r.sd=r.mobile,delete r.mobile):r.mobile&&delete r.mobile;var d={};return r.sd&&(d.sd={},d.sd[a]=r.sd.url),r.hd&&(d.hd={},d.hd[a]=r.hd.url),d},attrToObject:function(e,t,i){var n=t.getAttribute("url");return 0!=n.indexOf("http")&&(n=e+"/"+n),{fileExtension:i,url:n,bitrate:parseInt(t.getAttribute("bitrate")),width:parseInt(t.getAttribute("width")),height:parseInt(t.getAttribute("height"))}}},transformMedia:function(e){var t={},n=Object.keys(e);if(n=n.sort(function(e,t){return parseInt(t)-parseInt(e)}),n.length>2?client.isMobile?(t.hd=e[n[0]],t.sd=e[n[n.length-1]]):(t.hd=e[n[0]],t.sd=e[n[1]]):2==n.length?(t.hd=e[n[0]],t.sd=e[n[1]]):t.sd=e[n[0]],t.hd)for(var a in t.hd)t.hd[a]=i.normalizeProtocol(t.hd[a]);if(t.sd)for(var a in t.hd)t.sd[a]=i.normalizeProtocol(t.sd[a]);return t},log:e,timeLog:function(e,t){LOG.info(e,"in",Date.now()-t,"ms")},xhr:function(e,t,n,a,r,o,s,d,l){e=i.normalizeProtocol(e),LOG.info("calling server",t,e,n,o,s);var u=l||/https/.test(e)&&/(playwire|intergi)/i.test(e)&&!/(ad\.doubleclick\.net)/i.test(e)&&!/(ads\.intergi\.com)/i.test(e);if(window.client.hasFlash&&LOG.info("bypass flash",u,"url",e,window.Cors),!u&&window.Cors)LOG.debug("calling via cors shim",e),window.Cors.send(e,t,n,function(e){a&&a(e,s)},function(){LOG.info("Flash Cors failed. Retrying with XHR"),i.xhr(e,t,n,a,r,o,s,d,!0)},o);else{/\/\/ads\.intergi\.com\//.test(e)&&!/;cors=yes/.test(e)&&(i.log.info("Append ;cors=yes parameter to ",e),e+=";cors=yes");var c;if(9===window.client.browser.ie)e=window.site.isSecure?e.replace(/http:/gi,"https:"):e.replace(/https:/gi,"http:"),c=new XDomainRequest,c.onload=function(){var e=c.responseText;a&&a(e,s)},c.onprogress=function(){},c.ontimeout=function(){},c.onerror=function(){},c.open(t,e),setTimeout(function(){c.send(n)},0);else{if(c=new XMLHttpRequest,c.onreadystatechange=function(e){if(4===c.readyState)if(200===c.status||204===c.status){var t=200===c.status?c.responseText:"";a&&a(t,s)}else r&&r(s)},d)for(var h in d)d.hasOwnProperty(h)&&c.setRequestHeader(h,d[h]);c.open(t,e,!0),c.send(n)}}},xmlToJson:function(e){var t={};if(1==e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var n=0;n<e.attributes.length;n++){var a=e.attributes.item(n);t["@attributes"][a.nodeName]=a.nodeValue}}}else 3==e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes())for(var r=0;r<e.childNodes.length;r++){var o=e.childNodes.item(r),s=o.nodeName;if("undefined"==typeof t[s])t[s]=i.xmlToJson(o);else{if("undefined"==typeof t[s].push){var d=t[s];t[s]=[],t[s].push(d)}t[s].push(i.xmlToJson(o))}}return t},substituteMacros:function(e){var t=window.ContentPlayer,i=document.getElementById(t.containerId),n=i.getAttribute("data-default-src"),a=window.CurrentVideoConfig,r=window.uid,o=document.getElementById("ad_"+window.id),s=encodeURIComponent(a.settings.title),d=a.content.videoId,l=t.getSource()?encodeURIComponent(t.getSource()):encodeURIComponent(n),u=client.system.ios||client.system.android||client.system.mac||client.system.win,c=Math.round(Math.random()*Math.pow(10,15)),h=Math.round((new Date).getTime()/1e3),p=window.site.href,f=e.replace("__WEB_URL__",encodeURIComponent(p)).replace("[LR_URL]",encodeURIComponent(p)).replace("[VIDEO_DESCRIPTION]",encodeURIComponent(p)).replace("=VIDEO_DESCRIPTION","="+encodeURIComponent(p)).replace("__TIME__",h).replace("[timestamp]",h).replace("[TIMESTAMP]",h).replace("__CONTENT_URL__",l).replace("[VIDEO_FILE_URL]",l).replace("=VIDEO_URL","="+l).replace("__WIDTH__",o.clientWidth>0?i.clientWidth:window.Skin.clientWidth).replace("__HEIGHT__",o.clientHeight>0?i.clientHeight:window.Skin.clientHeight).replace("_WIDTH_",o.clientWidth>0?i.clientWidth:window.Skin.clientWidth).replace("_HEIGHT_",o.clientHeight>0?i.clientHeight:window.Skin.clientHeight).replace(/__RANDOM__/g,c).replace("__TITLE__",s).replace("[VIDEO_TITLE]",s).replace("=VIDEO_TITLE","="+s).replace("__MEDIA_ID__",d).replace("=VIDEO_ID","="+d).replace("__UA__",encodeURIComponent(client.raw)).replace("_UA_",encodeURIComponent(client.raw)).replace("__OS__",encodeURIComponent(navigator.platform)).replace("__DEVICE__",encodeURIComponent(client.device)).replace("__MODEL__",encodeURIComponent(client.device)).replace("__OSVERSION__",u).replace(/__UNIQUE_ID__/g,r).replace(/__UNIQUEID__/g,r).replace("[cellcarrier]",client.network.carrier||"").replace("[networkconnectiontype]",client.network.connection||"wifi").replace(/\[RANDOM\]/g,c);return f},css:{hasClass:function(e,t){return new RegExp(" "+t+" ").test(" "+e.className+" ")},addClass:function(e,t){i.css.hasClass(e,t)||(e.className+=" "+t)},removeClass:function(e,t){var n=" "+e.className.replace(/[\t\r\n]/g," ")+" ";if(i.css.hasClass(e,t)){for(;n.indexOf(" "+t+" ")>=0;)n=n.replace(" "+t+" "," ");e.className=n.replace(/^\s+|\s+$/g,"")}},toggleClass:function(e,t){var n=" "+e.className.replace(/[\t\r\n]/g," ")+" ";if(i.css.hasClass(e,t)){for(;n.indexOf(" "+t+" ")>=0;)n=n.replace(" "+t+" "," ");e.className=n.replace(/^\s+|\s+$/g,"")}else e.className+=" "+t},inject:function(e){var t=document.createElement("style");t.textContent=e,document.getElementsByTagName("head")[0].appendChild(t)},addLink:function(e,t,n,a){var r=[].slice.call(document.styleSheets);n||r.forEach(function(e,i){if(e.title==t)try{e.ownerNode.parentNode.removeChild(e.ownerNode)}catch(n){}});var o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",i.normalizeProtocol(e)),o.setAttribute("title",t),document.getElementsByTagName("head")[0].appendChild(o),"function"==typeof a&&(o.onload=function(){a.call()})},injectTricolorGradient:function(e,t,n,a,r){var o=e+"{background:-webkit-linear-gradient("+t+","+n+","+a+","+r+") !important;background:   -moz-linear-gradient("+t+","+n+","+a+","+r+") !important;background:    -ms-linear-gradient("+t+","+n+","+a+","+r+") !important;background:     -o-linear-gradient("+t+","+n+","+a+","+r+") !important;background:        linear-gradient("+t+","+n+","+a+","+r+") !important;}";i.css.inject(o)},injectBicolorGradient:function(e,t,n,a){var r=e+"{background:-webkit-linear-gradient("+t+","+n+","+a+" ) !important;background:   -moz-linear-gradient("+t+","+n+","+a+" ) !important;background:    -ms-linear-gradient("+t+","+n+","+a+" ) !important;background:     -o-linear-gradient("+t+","+n+","+a+" ) !important;background:        linear-gradient("+t+","+n+","+a+" ) !important;}";i.css.inject(r)},getStyleSheetOfClass:function(e,t){var i,n=document.querySelector(e);n||(n=document.createElement("div"),n.setAttribute("style","width:1px;height:1px;position:absolute;bottom:0"),document.body.appendChild(n),i=n);var a=getComputedStyle(n)[t];return i&&document.body.removeChild(i),a},setUAClass:function(){var e=window.document.body,t=i.dom,n=i.css,a=window.client;a.isMobile?(n.addClass(e,"bolt-mobile"),t.removeElementsByClass("bolt-not-mobile")):(n.addClass(e,"bolt-desktop"),t.removeElementsByClass("not-desktop")),a.system.android?(n.addClass(e,"bolt-android"),t.removeElementsByClass("not-android"),a.browser.chrome||a.browser.opera||!a.engine.webkit||(n.addClass(e,"bolt-webkit"),n.addClass(e,"bolt-stock"))):a.system.ios&&(n.addClass(e,"bolt-ios"),n.addClass(e,"bolt-ios-"+a.system.ios.replace(/\./g,"_")),t.removeElementsByClass("not-ios"),a.system.iphone?(n.addClass(e,"bolt-iphone"),t.removeElementsByClass("not-iphone")):a.system.ipad&&(n.addClass(e,"bolt-ipad"),t.removeElementsByClass("not-ipad"))),a.system.win?(n.addClass(e,"bolt-windows"),n.addClass(e,"bolt-windows-"+a.system.win)):a.system.mac?(n.addClass(e,"bolt-mac"),n.addClass(e,"bolt-mac-"+a.system.mac.replace(/\./g,"_"))):a.system.x11&&!a.system.android&&n.addClass(e,"bolt-linux"),a.browser.ie&&(n.addClass(e,"bolt-ie"),a.browser.ie>=11?n.addClass(e,"bolt-ie-11"):10==a.browser.ie?n.addClass(e,"bolt-ie-10"):9==a.browser.ie?n.addClass(e,"bolt-ie-9"):a.browser.ie<9&&n.addClass(e,"bolt-ie-unsupported")),a.browser.chrome&&(n.addClass(e,"bolt-chrome"),n.addClass(e,"bolt-chrome-"+a.browser.chrome)),a.browser.firefox&&(n.addClass(e,"bolt-firefox"),n.addClass(e,"bolt-firefox-"+a.browser.firefox)),a.browser.safari&&!a.system.android&&(n.addClass(e,"bolt-safari"),n.addClass(e,"bolt-safari-"+a.browser.safari)),a.browser.opera&&(n.addClass(e,"bolt-opera"),n.addClass(e,"bolt-opera-"+a.browser.opera)),a.browser.konq&&(n.addClass(e,"bolt-konqueror"),n.addClass(e,"bolt-konqueror-"+a.browser.konq)),a.hasTouch&&n.addClass(e,"bolt-touch"),a.hasFlash&&n.addClass(e,"bolt-flash")},setSizeClass:function(e){var t=window.Skin,n=i.css;400>=e?n.addClass(t,"bolt-small"):n.removeClass(t,"bolt-small")},setFeatureClass:function(){for(var e in PlayerSettings){var t="bolt-"+e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()}),n=PlayerSettings[e];n===!1?(i.css.removeClass(Skin,t+"-enabled"),i.css.addClass(Skin,t+"-disabled")):n===!0&&(i.css.removeClass(Skin,t+"-disabled"),i.css.addClass(Skin,t+"-enabled"))}}},normalizeProtocol:function(e){if(!e)return e;if(0===e.indexOf("//")){var t=window.site.isSecure?"https:":"http:";e=t+e,LOG.debug("normalize relative protocol to "+t,e)}else window.site.isSecure&&0===e.indexOf("http:")&&(e=e.replace(/http:/gi,"https:"),LOG.debug("normalize http protocol to https",e));return e},mergeObject:function(e,t,i){function n(e,t,i){var a=Array.isArray(t),r=a&&[]||{};return a?(e=e||[],r=r.concat(e),t.forEach(function(t,a){"undefined"==typeof r[a]?r[a]=t:"object"==typeof t?r[a]=n(e[a],t,i):-1===e.indexOf(t)&&r.push(t)})):(e&&"object"==typeof e&&Object.keys(e).forEach(function(t){r[t]=e[t]}),Object.keys(t).forEach(function(a){"object"==typeof t[a]&&t[a]?e[a]?"object"==typeof t[a]?r[a]=n(e[a],t[a],i):r[a]=e[a]?e[a]:t[a]:r[a]=t[a]:r[a]=i?t[a]:null!=t[a]?t[a]:e[a]})),r}return n(e,t,i)},mergeSettings:function(e,t,n){e.hasOwnProperty("defaultHD")&&(e.defaultHd=e.defaultHD,delete e.defaultHD);var a=i.mergeObject({},e),r=["scriptId","freePlayer","width","container","id","forceAds","onready","width","height","appearance","watermark"];return n||(r=r.concat(["videoId","title","minAge","playlist","playlistPlaythrough"])),Object.keys(t).forEach(function(e){-1===r.indexOf(e)&&(a[e]=t[e],LOG.info("override video setting:",e,"with embed setting :",a[e]))}),t.appearance?a.appearance=i.mergeObject(e.appearance||{},t.appearance):e.appearance&&(a.appearance=e.appearance),t.appearance=a.appearance,t.watermark?a.watermark=i.mergeObject(e.watermark||{},t.watermark):e.watermark&&(a.watermark=e.watermark),t.watermark=a.watermark,LOG.info("new video settings",a,"playersettings",window.PlayerSettings),a},loadVideoConfig:function(e,t,n){i.xhr(e,"get",null,function(e,i){try{var a=JSON.parse(e);"off"===PlayerSettings.advertising&&(a.advertising.on=!1),t(a,i)}catch(r){LOG.error(r),n&&n(i)}},function(e){n&&n(e)})},dom:{isEnabled:function(e){return!i.css.hasClass(e,t.UI.UI_DISABLED_CLASS)},isVisible:function(e){var t=this,i="string"==typeof e?t.getUI(e):e;if(!i)return!1;var n=window.getComputedStyle(i,null).getPropertyValue("display");return!("none"===n)},enableUI:function(e,n){var a=i.dom,r=i.css,o=t.UI,s=a.getUI(e);if(s){LOG.info("enable UI",e,n);var d=s.nextElementSibling;n?(r.addClass(s,o.UI_ENABLED_CLASS),r.removeClass(s,o.UI_DISABLED_CLASS),d&&r.hasClass(d,"bolt-separator")&&r.removeClass(d,o.UI_DISABLED_CLASS)):(r.removeClass(s,o.UI_ENABLED_CLASS),r.addClass(s,o.UI_DISABLED_CLASS),d&&r.hasClass(d,"bolt-separator")&&r.addClass(d,o.UI_DISABLED_CLASS)),client.isMobile||(n?r.addClass(s,o.UI_HIGHLIGHT_CLASS):r.removeClass(s,o.UI_HIGHLIGHT_CLASS)),s.setAttribute("data-bolt-ui-enabled",n)}},getUI:function(e){var t='*[data-bolt-ui="'+e+'"]';try{return window.Skin.querySelector(t)}catch(i){return LOG.warn("cannot find UI ",e),null}},hideElement:function(e,t){var n=i.dom,a="string"==typeof e?n.getUI(e):e;if(a){a.hasAttribute("data-bolt-original-display")||a.setAttribute("data-bolt-original-display",getComputedStyle(a).display);var r=a.getAttribute("data-bolt-original-display");a.style.display=0!=t?"none":r,a.hasAttribute("data-bolt-original-visibility")||a.setAttribute("data-bolt-original-visibility",getComputedStyle(a).visibility),a.style.visibility="hidden";var o=a.nextElementSibling;o&&i.css.hasClass(o,"bolt-separator")&&n.hideElement(o)}},showElement:function(e,t,n){var a=i.dom,r="string"==typeof e?a.getUI(e):e;if(r){var o=r.getAttribute("data-bolt-original-display");o||(o=getComputedStyle(r).display,r.setAttribute("data-bolt-original-display",o)),r.style.display="undefined"==typeof t?"none"!=o?o:"block":t;var s=r.getAttribute("data-bolt-original-visibility");s||(s=getComputedStyle(r).visibility,r.setAttribute("data-bolt-original-visibility",s)),r.style.visibility="undefined"==typeof n?"hidden"!=s?s:"visible":n;var d=r.nextElementSibling;d&&i.css.hasClass(d,"bolt-separator")&&a.showElement(d)}},removeElement:function(e){var t=i.dom,n=i.css,a="string"==typeof e?t.getUI(e):e;if(a){var r=a.nextElementSibling;r&&n.hasClass(r,"bolt-separator")&&t.removeElement(r);try{a.parentNode.removeChild(a)}catch(o){}}},removeElementsByClass:function(e){for(var t=window.Skin.querySelectorAll("*[class*='"+e+"']"),n=0;n<t.length;n++){var a=t[n];i.dom.removeElement(a)}}},animation:{events:{end:"AnimationEnd",start:"AnimationStart"},addListener:function(e,t,i){for(var n=["webkit","moz","MS","o",""],a=e,r=0;r<n.length;r++)n[r]||(a=a.toLowerCase()),t.addEventListener(n[r]+a,i,!1)},removeListener:function(e,t,i){for(var n=["webkit","moz","MS","o",""],a=e,r=0;r<n.length;r++)n[r]||(a=a.toLowerCase()),t.removeEventListener(n[r]+a,i,!1)}}};return window.ZeusUtils=i,window.LOG=window.LOG||i.log,i}),define("comscore",["zeus_utils"],function(){function e(){return"undefined"==typeof window.__deviceType&&(navigator.userAgent.match(/iPad/i)?window.__deviceType="tablet-ipad":navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)?window.__deviceType="mobile-iphone":navigator.userAgent.match(/Android/i)?navigator.userAgent.match(/mobile/i)?window.__deviceType="mobile-android":window.__deviceType="tablet-android":window.__deviceType="desktop"),window.__deviceType}function t(t){t.c1="1",t.c2="6035334",t.c7=window.site.href,t.c14=e();var n=i+"/p?",a=[];for(var r in t)a.push(r+"="+t[r]);n+=a.join("&"),LOG.debug("call comscore: "+n),ZeusUtils.xhr(n,"get")}var i=("https:"===document.location.protocol?"https://sb":"http://b")+".scorecardresearch.com",n=i+"/beacon.js",a=document.getElementsByTagName("head")[0],r=document.createElement("script");return r.setAttribute("src",n),a.appendChild(r),{fireComscoreCall:t}}),function(){"use strict";var e="0.8.1",t=1;if(!Object.create)var i=function(){};var n=Array.prototype.slice,a={attributes:{},eventHandlers:{"-1":{}},guid:-1,addEvent:function(e){a.eventHandlers[e.guid][e.type]||(a.eventHandlers[e.guid][e.type]=[]),a.eventHandlers[e.guid][e.type].push({guid:e.guid,handler:e.handler,scope:e.scope,type:e.type,once:e.once})},addEventHandler:function(e,t,i,n){var r,o={};"string"==typeof e?(r=i||!1,o[e]=t):(r=t||!1,o=e);for(var s in o)for(var d=o[s],l=s.split(" "),u=0,c=l.length;c>u;u++){var h=l[u];a.addEvent.call(this,{guid:this._guid||this._.guid,handler:d,scope:r,type:h,once:n})}},addGuid:function(e,i){e._guid&&!i||(e._guid=t++,a.attributes[e._guid]={},a.eventHandlers[e._guid]={})},attr:function(e){return a.attributes[e]},clone:function(e){var t=a.typeOf(e);return"object"===t?a.extend({},e):"array"===t?e.slice(0):void 0},create:function(e){return Object.create?Object.create(e):(i.prototype=e,new i)},createSubclass:function(e,t){function i(){if(!(this instanceof i))throw new Error("Please use 'new' when initializing Stapes classes");this.on&&a.addGuid(this,!0),o.apply(this,arguments)}e=e||{},t=t||!1;var n=e.superclass.prototype,o=e.hasOwnProperty("constructor")?e.constructor:function(){};t&&a.extend(n,r),i.prototype=a.create(n),i.prototype.constructor=i,a.extend(i,{extend:function(){return a.extendThis.apply(this,arguments)},parent:n,proto:function(){return a.extendThis.apply(this.prototype,arguments)},subclass:function(e){return e=e||{},e.superclass=this,a.createSubclass(e)}});for(var s in e)"constructor"!==s&&"superclass"!==s&&(i.prototype[s]=e[s]);return i},emitEvents:function(e,t,i,r){i=i||!1,r=r||this._guid;for(var o=n.call(a.eventHandlers[r][e]),s=0,d=o.length;d>s;s++){var l=a.extend({},o[s]),u=l.scope?l.scope:this;i&&(l.type=i),l.scope=u,l.handler.call(l.scope,t,l),l.once&&a.removeEventHandler.call(this,l.type,l.handler)}},extend:function(){for(var e=n.call(arguments),t=e.shift(),i=0,a=e.length;a>i;i++){var r=e[i];for(var o in r)t[o]=r[o]}return t},extendThis:function(){var e=n.call(arguments);return e.unshift(this),a.extend.apply(this,e)},makeUuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"==e?t:3&t|8;return i.toString(16)})},removeAttribute:function(e,t){t=t||!1;for(var i=a.trim(e).split(" "),n={},r=0,o=i.length;o>r;r++){var s=a.trim(i[r]);s&&(n.key=s,n.oldValue=a.attr(this._guid)[s],delete a.attr(this._guid)[s],t||(this.emit("change",s),this.emit("change:"+s),this.emit("mutate",n),this.emit("mutate:"+s,n),this.emit("remove",s),this.emit("remove:"+s)),delete n.oldValue)}},removeEventHandler:function(e,t){var i=a.eventHandlers[this._guid];if(e&&t){if(i=i[e],!i)return;for(var n,r=0,o=i.length;o>r;r++)n=i[r].handler,n&&n===t&&(i.splice(r--,1),o--)}else e?delete i[e]:a.eventHandlers[this._guid]={}},setAttribute:function(e,t,i){i=i||!1;var n=this.has(e),r=a.attr(this._guid)[e];if(t!==r&&(a.attr(this._guid)[e]=t,!i)){this.emit("change",e),this.emit("change:"+e,t);var o={key:e,newValue:t,oldValue:r||null};this.emit("mutate",o),this.emit("mutate:"+e,o);var s=n?"update":"create";this.emit(s,e),this.emit(s+":"+e,t)}},trim:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},typeOf:function(e){return null===e||"undefined"==typeof e?String(e):Object.prototype.toString.call(e).replace(/\[object |\]/g,"").toLowerCase()},updateAttribute:function(e,t,i){var n=this.get(e),r=a.typeOf(n);"object"!==r&&"array"!==r||(n=a.clone(n));var o=t.call(this,n,e);a.setAttribute.call(this,e,o,i||!1)}},r={emit:function(e,t){t="undefined"==typeof t?null:t;for(var i=e.split(" "),n=0,r=i.length;r>n;n++){var o=i[n];a.eventHandlers[-1].all&&a.emitEvents.call(this,"all",t,o,-1),a.eventHandlers[-1][o]&&a.emitEvents.call(this,o,t,o,-1),"number"==typeof this._guid&&(a.eventHandlers[this._guid].all&&a.emitEvents.call(this,"all",t,o),a.eventHandlers[this._guid][o]&&a.emitEvents.call(this,o,t))}},off:function(){a.removeEventHandler.apply(this,arguments)},on:function(){
a.addEventHandler.apply(this,arguments)}};a.Module=function(){},a.Module.prototype={each:function(e,t){var i=a.attr(this._guid);for(var n in i){var r=i[n];e.call(t||this,r,n)}},extend:function(){return a.extendThis.apply(this,arguments)},filter:function(e){var t=[],i=a.attr(this._guid);for(var n in i)e.call(this,i[n],n)&&t.push(i[n]);return t},get:function(e){if("string"==typeof e){if(arguments.length>1){for(var t={},i=0,n=arguments.length;n>i;i++){var r=arguments[i];t[r]=this.get(r)}return t}return this.has(e)?a.attr(this._guid)[e]:null}if("function"==typeof e){var o=this.filter(e);return o.length?o[0]:null}},getAll:function(){return a.clone(a.attr(this._guid))},getAllAsArray:function(){var e=[],t=a.attr(this._guid);for(var i in t){var n=t[i];"object"!==a.typeOf(n)||n.id||(n.id=i),e.push(n)}return e},has:function(e){return"undefined"!=typeof a.attr(this._guid)[e]},map:function(e,t){var i=[];return this.each(function(n,a){i.push(e.call(t||this,n,a))},t||this),i},push:function(e,t){if("array"===a.typeOf(e))for(var i=0,n=e.length;n>i;i++)a.setAttribute.call(this,a.makeUuid(),e[i],t||!1);else a.setAttribute.call(this,a.makeUuid(),e,t||!1);return this},remove:function(e,t){return"undefined"==typeof e?(a.attributes[this._guid]={},this.emit("change remove")):"function"==typeof e?this.each(function(i,n){e(i)&&a.removeAttribute.call(this,n,t)}):a.removeAttribute.call(this,e,t||!1),this},set:function(e,t,i){if("object"==typeof e)for(var n in e)a.setAttribute.call(this,n,e[n],t||!1);else a.setAttribute.call(this,e,t,i||!1);return this},size:function(){var e=0,t=a.attr(this._guid);for(var i in t)e++;return e},update:function(e,t,i){return"string"==typeof e?a.updateAttribute.call(this,e,t,i||!1):"function"==typeof e&&this.each(function(t,i){a.updateAttribute.call(this,i,e)}),this}};var o={_:a,extend:function(){return a.extendThis.apply(a.Module.prototype,arguments)},mixinEvents:function(e){return e=e||{},a.addGuid(e),a.extend(e,r)},on:function(){a.addEventHandler.apply(this,arguments)},subclass:function(e,t){return t=t||!1,e=e||{},e.superclass=t?function(){}:a.Module,a.createSubclass(e,!t)},version:e};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=o),exports.Stapes=o):"function"==typeof define&&define.amd?define("stapes",[],function(){return o}):window.Stapes=o}(),define("zeus_eventdispatcher",["stapes"],function(e){var t=e.subclass({_dispatchEvent:function(e,t,i){var n=this;if("string"==typeof e)n.emit(e,{type:e,target:i?i:n,data:t});else if("object"==typeof e&&e.hasOwnProperty("type")){var a=e;n.emit(a.type,{target:a.target,type:a.type,data:a.data})}},addOnceEventListener:function(e,t,i){var n=this;n.on(e,t,i,!0)},addEventListener:function(e,t,i){this.on(e,t,i)},removeEventListener:function(e,t){this.off(e,t)},removeAllListeners:function(e){this.off(e)}});return t.mixin=function(t){e.mixinEvents(t);var i;i="undefined"!=typeof t.prototype?t.prototype:t,i._dispatchEvent=function(e,i,n){if("string"==typeof e)t.emit(e,{type:e,target:n?n:t,data:i});else if("object"==typeof e&&e.hasOwnProperty("type")){var a=e;t.emit(a.type,{type:a.type,target:a.target,data:a.data})}},i.addOnceEventListener=function(e,i,n){t.on(e,i,n,!0)},i.addEventListener=function(e,i,n){t.on(e,i,n)},i.removeEventListener=function(e,i){t.off(e,i)},i.removeAllListeners=function(e){t.off(e)}},t}),define("vastvmap",[],function(){function e(e,t,i,n,a){"undefined"!=typeof a&&(f=a);var r=ZeusUtils.substituteMacros(e);LOG.debug("[bolt3] URL after substitution: "+r),window.postLogMessage("URL after substitution "+r);var o=function(e){var n=new DOMParser,a=n.parseFromString(e,"application/xml");"undefined"!=typeof a.getElementsByTagName("Ad")?i(a,t):(LOG.error("[bolt3] Empty VAST",a),window.postLogMessage("Empty VAST XML","error"),s())},s=function(){n()};ZeusUtils.xhr(r,"get",null,o,s)}function t(t,i,n,a,o){"undefined"!=typeof a&&(p=a),"undefined"!=typeof o&&(f=o),LOG.debug("[bolt3] fetching "+t),window.postLogMessage("Fetching "+t),e(t,null,function(e){new r(e,i,n)},function(e){LOG.error("Failed to load VAST from '"+t+"':",e),window.postLogMessage("Failed to load VAST from '"+t,"error"),i(null)})}function i(e,t,i,n,a){LOG.info("[bolt3] Parse XML",e),window.postLogMessage("Processing VAST XML"),"undefined"!=typeof a&&(f=a),"undefined"!=typeof n&&(p=n),new r(e,t,i)}function n(e,t){if(this.events={},this.ad=t,null!==e){if("TrackingEvents"!==e.tagName&&"vmap:TrackingEvents"!==e.tagName){if(e=e.getElementsByTagName("TrackingEvents"),1!==e.length)return;e=e.item(0)}var i=e.getElementsByTagName("Tracking");0===i.length&&(i=e.getElementsByTagNameNS("*","Tracking"));for(var n=0;n<i.length;n++){var a=i[n].getAttribute("event");if(a){var r=null;"progress"===a&&(r=i[n].getAttribute("offset"),a+="-"+r),this.events[a]=this.events[a]||[];var o={url:i[n].textContent.replace(/\s/g,""),offset:r,event:a};this.events[a].push(o)}}}}function a(i,a,o){this.breaks=[];var s=this;e(i,null,function(e){for(var i=e.getElementsByTagName("AdBreak"),d=[],l=0;l<i.length;l++){var u=i.item(l),c=u.getAttribute("timeOffset");if(0!==c.indexOf("#")){var h={ad:null,breakId:u.getAttribute("breakId"),tracking:new n(u,null),position:c},p=a.bind(s,s.breaks.length,c),f=u.getElementsByTagName("VASTData");if(f)h.ad=new r(f.item(0).getElementByTagName(null,"VAST").item(0),p);else{var v=u.getElementsByTagName("AdTagURI");if(!v){LOG.error("No supported ad target for break #"+l);continue}var g;!function(e){g=function(t){e.ad=t,null!==t&&p(t)}}(h),t(v.item(0).textContent.replace(/\s/g,""),g)}s.breaks.push(h),d.push(h.position)}}"function"==typeof o&&o(d)},function(e){LOG.error("Failed to load VMAP from '"+i+"':",e),o([])})}function r(e,i,n){var a=e.getElementsByTagName("Ad");if("undefined"==typeof a||0==a.length)LOG.error("[bolt3] No Ads found in ",e),i&&i.call(null);else{this.ads=[],this.onAdsAvailable=i,this.id="undefined"!=typeof e.getElementsByTagName("Ad")[0]?e.getElementsByTagName("Ad")[0].getAttribute("id"):null;for(var r=e.getElementsByTagName("Ad"),s=0;s<r.length;s++){var d=new o(this,r.item(s),n||null);if(!d.isEmpty())if(this.ads.push(d),!d.hasData()||d.hasSequence()&&!d.isNumber(1)){var l=this,u=r.item(s).getElementsByTagName("Wrapper").item(0),c=u.getElementsByTagName("VASTAdTagURI");if(0===c.length)continue;c=c.item(0).textContent.replace(/\s/g,"");try{c=ZeusUtils.substituteMacros(c)}catch(h){}var p,f="true"===u.getAttribute("allowMultipleAds");!function(e,t,i){p=function(n){if(e.onLoaded(n,t),i.onAdsAvailable){var a=i.onAdsAvailable;i.onAdsAvailable=null,a.call(i,i)}}}(d,f,l),t(c,i,d)}else if(i){var v=this.onAdsAvailable;this.onAdsAvailable=null;try{v.call(this,this)}catch(h){}}}}}function o(e,t,i,a){this.vast=e,this.pod=e,this.parentAd=i,this.onAdAvailable=a,this.sequence=null,this.hasContent=!0,this.loaded=!0,this.linear=null,this.companions=[],this.companionsRequired="none",this.nonlinears=[],this.nonlinearsTracking=null,this.impressions=[],this.currentPodAd=this,this.sentImpression=!1,this.properties={};var r,o;if(null!==this.parentAd){var s=this.parentAd;if(this.companionsRequired=s.companionsRequired,this.linear=s.linear?s.linear.copy(this):null,s.companions.length)for(r=0;r<s.companions.length;r++)this.companions.push(s.companions[r].copy(this));if(s.nonlinears.length)for(r=0;r<s.nonlinears.length;r++)this.companions.push(s.nonlinears[r].copy(this));null!==s.nonlinearsTracking&&(this.nonlinearsTracking=s.nonlinearsTracking.copy(this));for(o in s.properties)s.properties.hasOwnProperty(o)&&(this.properties[o]=s.properties[o])}null===this.nonlinearsTracking&&(this.nonlinearsTracking=new n(null,this)),t.hasAttribute("sequence")&&(this.sequence=parseInt(t.getAttribute("sequence"),10));var l=t.getElementsByTagName("InLine");if(0===l.length&&(this.loaded=!1,l=t.getElementsByTagName("Wrapper"),0===l.length))return void(this.hasContent=!1);l=l.item(0);for(var u=l.firstChild;null!==u;){if(1===u.nodeType)switch(u.tagName){case"Creatives":case"InLine":case"Wrapper":case"Impression":case"VASTAdTagURI":case"Error":break;default:this.properties[u.tagName]=u.textContent.replace(/^\s*|\s*$/g,"")}u=u.nextSibling}var f=l.getElementsByTagName("Impression");for(r=0;r<f.length;r++){var v=f.item(r).textContent.replace(/\s/g,"");0!==v.length&&-1===this.impressions.indexOf("imp")&&-1===p.vastImpressions.indexOf("imp")&&this.impressions.push(v)}p.vastImpressions=p.vastImpressions.concat(this.impressions),LOG.debug("[bolt3] IMPRESSIONS",p.vastImpressions,"length ",p.vastImpressions.length);var g=l.getElementsByTagName("Creatives");if(0!==g.length)for(g=g.item(0).getElementsByTagName("Creative"),r=0;r<g.length;r++){for(var m=g.item(r).firstChild;null!==m&&3===m.nodeType;)m=m.nextSibling;if(null!==m){var E;switch(m.tagName){case"Linear":E=new d(this,m),this.linear?(this.linear=h(this,E),null!==this.parentAd&&this.linear.tracking.augment(this.parentAd.linear.tracking)):this.linear=E;break;case"NonLinearAds":var y=m.tagName.replace("Ads","");if("NonLinear"===y){var _=new n(m,this);this.nonlinearsTracking.augment(_)}for(var b=m.getElementsByTagName(y),A=0;A<b.length;A++)E=new c(this,b.item(A)),this.nonlinears=h(this,E)}}}}function s(e,t){this.root=t,this.clickThrough=null,"NonLinear"===t.tagName&&(t=t.parentNode),this.tracking=new n(t,e)}function d(e,t){s.call(this,e,t),this.mediaFiles=[],this.clickThrough=null,this.duration=null;var i,n=t.getElementsByTagName("VideoClicks");if(n.length){n=n.item(0);var a=n.getElementsByTagName("ClickThrough");for(a.length&&(this.clickThrough=a.item(0).textContent.replace(/\s/g,"")),a=n.getElementsByTagName("ClickTracking"),i=0;i<a.length;i++)this.tracking.addClickTracking(a.item(i).textContent.replace(/\s/g,""))}var r=t.getElementsByTagName("Duration");r.length&&(this.duration=this.timecodeFromString(r.item(0).textContent.replace(/\s/g,"")));var o=t.getElementsByTagName("MediaFiles");if(o.length){for(o=o.item(0).getElementsByTagName("MediaFile"),i=0;i<o.length;i++){for(var d=o.item(i),l={},u=0;u<d.attributes.length;u++)l[d.attributes[u].name]=d.attributes[u].value;l.src=o.item(i).textContent.replace(/\s/g,""),this.mediaFiles.push(l)}this.parameters=null,t.getElementsByTagName("AdParameters").length>0&&(this.parameters=t.getElementsByTagName("AdParameters")[0].textContent)}}function l(e,t){s.call(this,e,t),this.resources={iframe:null,html:null,images:{}};var i;i=t.getElementsByTagName("IFrameResource"),i.length>0&&(this.resources.iframe=i.item(0).textContent.replace(/\s/g,"")),i=t.getElementsByTagName("HTMLResource"),i.length>0&&(this.resources.html=i.item(0).textContent.replace(/\s/g,"")),i=t.getElementsByTagName("StaticResource");for(var n=0;n<i.length;n++)this.resources.images[i.item(n).getAttribute("creativeType")]=i.item(n).textContent.replace(/\s/g,"")}function u(e,t){l.call(this,e,t),this.altText="",l.prototype.extractClicks.call(this,"Companion");var i=t.getElementsByTagName("AltText");i.length&&(this.altText=i.item(0).textContent.replace(/\s/g,""))}function c(e,t){l.call(this,e,t),this.tracking=e.nonlinearsTracking,l.prototype.extractClicks.call(this,"NonLinear")}function h(e,t){for(var i in t)try{t[i].constructor==Object?e[i]=h(e[i],t[i]):e[i]=t[i]}catch(n){e[i]=t[i]}return e}var r,o,d,c,u,p,f;n.prototype.copy=function(e){var t=Object.create(n.prototype);t.events={};for(var i in this.events)this.events.hasOwnProperty(i)&&(t.events[i]=[].concat(this.events[i]));return t.ad=e,t},n.prototype.finger=function(e,t){var i=ZeusUtils.substituteMacros(e),n=document.getElementById("bolt_trackingpixels");if(!client.hasFlash){var a=ZeusUtils.normalizeProtocol(i);if(!/^https?:\/\/ads.intergi.com/i.test(a)){var r=document.createElement("img");return r.setAttribute("style","position:absolute;bottom:0;left:0;visibility:hidden"),r.src=i,n.appendChild(r),void LOG.info("[Bolt] Image tracking pixel loaded: "+i)}}ZeusUtils.xhr(i,"get",null,function(){i.indexOf("adcount")>-1&&i.indexOf("intergi")>-1?(LOG.info("[bolt3] ADTECH adcount successfully fired. "+i),window.postLogMessage("ADTECH adcount successfully fired. "+i,"success")):(LOG.info("[bolt3] 3rd-party tracker successfully fired "+i),window.postLogMessage("3rd-party tracker successfully fired "+i,"success")),window.AdTracking.status(t,i,!0)},function(){i.indexOf("adcount")>-1&&i.indexOf("intergi")>-1?(LOG.warn("[bolt3] ADTECH adcount failed to fire. "+i),window.postLogMessage("ADTECH adcount failed to fire. "+i,"error")):(LOG.warn("[bolt3] 3rd-party tracker failed to fire. "+i),window.postLogMessage("3rd-party tracker failed to fire. "+i,"error")),window.AdTracking.status(t,i,!1)})},n.prototype.augment=function(e){for(var t in e.events)e.events.hasOwnProperty(t)&&(this.events[t]?this.events[t]=this.events[t].concat(e.events[t]):this.events[t]=e.events[t])},n.prototype.addClickTracking=function(e){var t={url:e,event:"click",offset:null};this.events.click?this.events.click.push(t):this.events.click=[t]},n.prototype.getEventsOfTypes=function(e){var t=[],i=e.indexOf("progress")>-1;for(var n in this.events)this.events.hasOwnProperty(n)&&(e.indexOf(n)>-1||i&&0===n.indexOf("progress-"))&&(t=t.concat(this.events[n]));return t},n.prototype.track=function(e,t){if(this.events[e]&&0!==this.events[e].length){t||(t={});var i,n=[].concat(this.events[e]);for(var a in t)t.hasOwnProperty(a)&&(t["["+a+"]"]=encodeURIComponent(t[a]),delete t[a]);var r=this;for(i=0;i<n.length;i++){for(var o=n[i],s=o.url,d=""+parseInt(99999999*Math.random(),10);8!==d.length;)d="0"+d;t["[CACHEBUSTING]"]=d;for(a in t)t.hasOwnProperty(a)&&(s=s.replace(a,t[a]));""!==s&&"about:blank"!==s&&(LOG.debug("[bolt3] tracking",e,s),r.finger(s,e))}}},n.prototype.trackImpressions=function(e){for(var t=this,i=0;i<e.length;i++){var n=e[i];""!==n&&"about:blank"!==n&&(LOG.debug("[bolt3] track impression",n),t.finger(n,"impression"))}},a.prototype.onBreakStart=function(e){return this.breaks[e].tracking.track("breakStart"),this.breaks[e].ad},a.prototype.onBreakEnd=function(e){this.breaks[e].tracking.track("breakEnd")},r.prototype.getAd=function(e){var t=null;if(e&&(t=this.getAdWithSequence(1),t&&!t.current().isEmpty()))return t.current();for(var i=0;i<this.ads.length;i++)if(!this.ads[i].hasSequence()&&!this.ads[i].current().isEmpty())return this.ads[i].current()},r.prototype.getAdWithSequence=function(e){for(var t=0;t<this.ads.length;t++)if(this.ads[t].isNumber(e))return this.ads[t];return null},o.prototype.getTag=function(e,t){return this.properties.hasOwnProperty(e)?this.properties[e]:t},o.prototype.onLoaded=function(e,t){this.pod=e,this.currentPodAd=e.getAd(t),this.currentPodAd.isEmpty()||(this.loaded=!0,this.onAdAvailable&&this.onAdAvailable.call(this,this))},o.prototype.hasSentImpression=function(){return this.sentImpression},o.prototype.impressionSent=function(){this.sentImpression=!0},o.prototype.current=function(){return this.currentPodAd},o.prototype.isNumber=function(e){return this.sequence===e},o.prototype.hasSequence=function(){return null!==this.sequence},o.prototype.isEmpty=function(){return!this.hasContent},o.prototype.hasData=function(){return this.loaded},o.prototype.getNextAd=function(){return this.vast!==this.pod&&(this.currentPodAd=this.currentPodAd.getNextAd(),null!==this.currentPod)?this.currentPodAd.current():this.hasSequence()?this.vast.getAdWithSequence(this.sequence+1).current():null},o.prototype.getLinear=function(){return this.linear},o.prototype.getCompanions=function(){return this.companions},o.prototype.getCompanion=function(e){for(var t=0;t<this.companions.length;t++)if(this.companions[t].attribute("id")===e)return this.companions[t];return null},o.prototype.companionsRequired=function(){return this.companionsRequired},o.prototype.getNonLinears=function(){return this.nonlinears},s.prototype.track=function(e,t,i){this.tracking.track(e,{CONTENTPLAYHEAD:this.timecodeToString(t),ASSETURI:i})},s.prototype.trackImpressions=function(e){this.tracking.trackImpressions(e)},s.prototype.timecodeToString=function(e){var t="0"+parseInt(e/3600,10),i="0"+parseInt(e%3600/60,10),n="0"+e%60,a=t+":"+i+":"+n;return a.replace(/(^|:|\.)0(\d{2})/g,"$1$2")},s.prototype.timecodeFromString=function(e){return-1===e.indexOf(":")?e:3600*parseInt(e.substr(0,2),10)+60*parseInt(e.substr(3,2),10)+parseInt(e.substr(6,2),10)},s.prototype.getClickThrough=function(){return this.clickThrough},s.prototype.attribute=function(e,t){if(!this.root.hasAttribute(e))return t;var i=this.root.getAttribute(e);switch(e){case"skipoffset":case"duration":case"offset":case"minSuggestedDuration":i=this.timecodeFromString(i)}return i},d.prototype=Object.create(s.prototype),d.prototype.getDuration=function(){return this.duration},d.prototype.copy=function(e){return new d(e,this.root)},d.prototype.augment=function(e){this.tracking.augment(e.tracking),this.clickThrough=e.clickThrough||this.clickThrough},d.prototype.getAllMedias=function(){return this.mediaFiles},d.prototype.getAllMediaAsObject=function(){var e;return this.mediaFiles&&this.mediaFiles.forEach(function(t){e||(e={}),e[t.type]=t}),e},d.prototype.getBestMedia=function(e){for(var t=Number.POSITIVE_INFINITY,i=-1,n=0;n<this.mediaFiles.length;n++){var a=this.mediaFiles[n],r=Math.sqrt(Math.pow(e.width-a.width,2)+Math.pow(e.height-a.height,2));if(t>r)t=r,i=n;else if(r===t){var o=this.mediaFiles[i],s=o.bitrate||o.maxBitrate,d=a.bitrate||a.maxBitrate;d&&!s?i=n:e.bitrate&&s&&d?Math.abs(d-e.bitrate)<Math.abs(s-e.bitrate)&&(i=n):d>s&&(i=n)}}return-1===i?null:this.mediaFiles[i]};var v=["start","firstQuartile","midpoint","thirdQuartile","complete","progress"];return d.prototype.getTrackingPoints=function(){for(var e=this.tracking.getEventsOfTypes(v),t=[],i=0;i<e.length;i++){var n={event:e[i].event,offset:null};switch(e[i].event){case"start":n.offset="start";break;case"firstQuartile":n.offset="25%";break;case"midpoint":n.offset="50%";break;case"thirdQuartile":n.offset="75%";break;case"complete":n.offset="end";break;default:var a=e[i].offset;if(!a)continue;n.offset=s.prototype.timecodeFromString(a)}t.push(n)}return t},l.prototype=Object.create(s.prototype),l.prototype.augment=function(e){this.tracking.augment(e.tracking),this.clickThrough=e.clickThrough||this.clickThrough,this.resources.iframe=e.resources.iframe||this.resources.iframe,this.resources.html=e.resources.html||this.resources.html;for(var t in e.resources.images)e.resources.images.hasOwnProperty(t)&&(this.resources.images[t]=e.resources.images[t])},l.prototype.getAllResources=function(){return this.resources},l.prototype.extractClicks=function(e){var t;t=this.root.getElementsByTagName(e+"ClickThrough"),t.length&&(this.clickThrough=t.item(0).textContent.replace(/\s/g,"")),t=this.root.getElementsByTagName(e+"ClickTracking"),t.length&&this.tracking.addClickTracking(t.item(0).textContent.replace(/\s/g,""))},u.prototype=Object.create(l.prototype),u.prototype.copy=function(e){return new u(e,this.root)},u.prototype.augment=function(e){l.prototype.augment.call(this,e),this.altText=e.altText||this.altText},u.prototype.getAltText=function(){return this.altText},c.prototype=Object.create(l.prototype),c.prototype.augment=function(e){l.prototype.augment.call(this,e)},c.prototype.copy=function(e){return new c(e,this.root)},{fetchXML:e,queryVAST:t,VASTAds:r,parseXML:i,TrackingEvents:n}}),define("vmap_adapter",["zeus_eventdispatcher","vastvmap","zeus_constants","zeus_utils"],function(e,t,i,n){var a=e.subclass({constructor:function(){},init:function(e,t,i){var a=this;a.primaryTag=e,a.xml=null,a.breaks=[],a.successCb=t,a.errorCb=i,a.contentDuration=0,a.cuepoints=[],n.xhr(this.primaryTag,"get",null,function(e){a.parse(e)},function(){i.call(null)})},parse:function(e){var i=this;i.xml=e,i.breaks=[],i.cuepoints=[];for(var n=new DOMParser,a=n.parseFromString(e,"text/xml"),r=a.getElementsByTagNameNS("*","AdBreak"),o=function(e){var t=e.split(":"),i=parseInt(t[2]),n=parseInt(t[1]),a=parseInt(t[0]);return 3600*a+60*n+i},s=0;s<r.length;s++){var d=r.item(s);if("linear"==d.getAttribute("breakType")){console.log("AdBreak",d);var l={position:d.getAttribute("timeOffset"),positionInSeconds:o(d.getAttribute("timeOffset")),breakId:d.getAttribute("breakId"),sourceId:d.getElementsByTagNameNS("*","AdSource")[0].getAttribute("id"),trackingEvents:null,adXML:null,adURI:null};try{var u=d.getElementsByTagNameNS("*","TrackingEvents")[0];u&&(LOG.info("VMAP TrackingEvents",u),l.trackingEvents=new t.TrackingEvents(u,null))}catch(c){}var h=d.getElementsByTagNameNS("*","VASTAdData")[0];if(h){var p=h.getElementsByTagNameNS("*","VAST")[0];p&&(l.adXML=p)}else{var f=d.getElementsByTagNameNS("*","AdTagURI")[0];f&&(l.adURI=f.textContent.trim())}(l.adURI||l.adXML)&&("number"!=typeof l.positionInSeconds||isNaN(l.positionInSeconds)||i.cuepoints.push(l.positionInSeconds),i.breaks.push(l))}}i.breaks.length>0?(i.contentDuration>0&&i.updatePercentagePosition(i.contentDuration),i.successCb.call(null,i.breaks)):(LOG.error("[VMAP] No ad breaks found"),i.errorCb.call(null))},getBreaks:function(e){var t=this,i=[];if(!t.breaks||0===t.breaks.length)return null;for(var n=t.breaks.concat();n.length>0;){var a=n.shift();"preroll"===e?"start"===a.position&&i.push(a):"postroll"===e?"end"===a.position&&i.push(a):a.positionInSeconds===Math.floor(e)&&i.push(a)}return i.length>0?i:null},setContentDuration:function(e,t){this.contentDuration=e,this.breaks&&this.breaks.length>0&&(this.updatePercentagePosition(e),t&&t.call(null,this.cuepoints))},updatePercentagePosition:function(e){var t=this;e&&t.breaks&&t.breaks.length>0&&(t.breaks.forEach(function(t){t.position.indexOf("%")>-1&&(t.positionInSeconds=Math.floor(e*parseFloat(t.position)/100),LOG.info("Updated break position",t.position,"of",e,"=",t.positionInSeconds))}),t.validateBreakTimings(e))},validateBreakTimings:function(e){LOG.info("Validate VMAP break timings");var t=this;e&&t.breaks&&t.breaks.length>0&&(t.breaks=t.breaks.filter(function(t){return"start"===t.position||"end"===t.position?!0:e-t.positionInSeconds>30}),t.updateCuepoints())},updateCuepoints:function(){var e=this;e.breaks&&e.breaks.length>0&&e.breaks.forEach(function(t){"number"!=typeof t.positionInSeconds||isNaN(t.positionInSeconds)||e.cuepoints.push(t.positionInSeconds)}),e.cuepoints=n.data.sortNumericArray(n.data.getUniqueArray(e.cuepoints)),LOG.info("VMAP CUEPOINTS",e.cuepoints)},reset:function(){this.breaks=null,this.successCb=null,this.errorCb=null,this.primaryTag=null,this.xml=null,this.contentDuration=0,this.cuepoints=null}});return a}),define("zeus_ad_manager",["comscore","zeus_eventdispatcher","zeus_utils","zeus_constants","vmap_adapter"],function(e,t,i,n,a){"use strict";function r(e,i){t.mixin(this),this.INTERGI="adtech-intergi",this.GENERIC_VAST="generic-vast",this.GENERIC_GOOGLE="generic-google",this.containerId=i,this.container=document.getElementById(this.containerId),LOG.info("AD container",this.container),this.triedCampaigns=[],this.status="none",this.aborted=!1,this.type=null,this.bestMedia=null,this.ad=null,this._dcTimeout=null,this._dcStartTime=null,this._dcTimeoutReached=!1,s=e&&"number"==typeof e?e:s,this.timeout=s,LOG.info("[bolt3] Ad timeout set to",s/1e3," seconds"),window.postLogMessage("Ad timeout set to "+s/1e3+" seconds","info"),this.max_attempts=l,this._isLinear=!0,this.selectedServer=null,this.selectedSiteTags=null,this.addEventListener(n.Media.Event.ENDED,function(e){this.selectedVMAPBreak&&this.trackVMAPEvent("breakEnd"),this.remove()},this),this._onAdError=this._onAdError.bind(this),this._onAdMediaLoaded=this._onAdMediaLoaded.bind(this),this._onAdMediaPlaying=this._onAdMediaPlaying.bind(this),this.hasBeenTouched=!1,o.isMobile&&(this._createVideoElement(),window.ContentPlayer.show(!1)),this.vastImpressions=[],this._selectedTag=null,this.intergiServer=null,this.genericServer=null,this._backfilling=!1,this.timing=null,this.tagType=null,this.VMAPAdapter=new a,this.VMAPChecked=!1,this.VMAPBreaksForCurrentAdTiming=null,this.selectedVMAPBreak=null,this.processedVMAPSecond=null,this._currentRequestId=null,this.bid=null,this.pixelsContainer=null,View.addEventListener(n.Media.Event.DURATION_CHANGE,function(){var e=this;View.currentPlayer.isAd()||e.VMAPAdapter.setContentDuration(ContentPlayer.duration,function(t){e._dispatchEvent(n.Ad.Event.VMAP_CUEPOINTS_CHANGED,t)})},this)}var o=window.client,s=3e4,d=15e3,l=3,u=0;return r.prototype.init=function(e){LOG.info("Init Ad Manager");var t=this;t.pixelsContainer=document.createElement("div"),t.pixelsContainer.id="bolt_trackingpixels",t.pixelsContainer.setAttribute("class","position:absolute;bottom:0;left:0;visibility:hidden;width:1px;height:1px;"),document.body.appendChild(t.pixelsContainer),t.resetStatus(),t.VMAPChecked=!1,t.processedVMAPSecond=null,t.VMAPBreaksForCurrentAdTiming=null,t.VMAPAdapter.reset(),t.selectedVMAPBreak=null,t.isUsingVMAP=!1,t.config=window.PlayerSettings.embedAds||window.CurrentVideoConfig.advertising,t.config===window.PlayerSettings.embedAds&&LOG.info("Using embed ad settings",t.config),t.selectServer();var i=t._selectTag("vmap");i?t.VMAPAdapter.init(i,function(){LOG.info("Using VMAP"),t.isUsingVMAP=!0,e()},function(){e()}):e()},r.prototype._createVideoElement=function(){this.videoElement=document.createElement("video"),this.videoElement.setAttribute("id",n.Ad.PLAYER_ID_PREFIX+this.containerId),this.videoElement.setAttribute("width","100%"),this.videoElement.setAttribute("height","100%"),this.videoElement.setAttribute("style","position:absolute;top:0;left:0;bottom:0;right:0;visibility:hidden"),this.container.appendChild(this.videoElement)},r.prototype.resetStatus=function(){LOG.debug("[bolt3] reset ad manager"),this.status="none",this.container.style.display="none",this.container.style.visibility="hidden",this.adPlayer=null,this.vastImpressions=[],this.VMAPAdapter.breaks||(this.selectedServer=null,this.selectedSiteTags=null),this.adtechGoogleAdCount=null,this.provider=null,this.triedCampaigns=[],this._backfilling=!1,this.timing=null,this._currentRequestId=null,this.type=null,this.tagType=null,this.bestMedia=null,this._isLinear=null,this._standaloneOverlay=!1,this._dcTimeout&&(clearTimeout(this._dcTimeout),this._dcTimeout=null),this.bid=null,this.VMAPBreaksForCurrentAdTiming&&0===this.VMAPBreaksForCurrentAdTiming.length&&(this.VMAPBreaksForCurrentAdTiming=null),this.selectedVMAPBreak=null,this._selectedTag=null,this.container.style.width="100%",this.container.style.height=this.container.getAttribute("data-zeus-initial-height")+"px",this.container.style.bottom=0,this.container.style.top=0,this.container.style.left=0,this.container.style.right=0,this.container.style.backgroundColor=""},r.prototype.clearTrackingImages=function(){if(this.pixelsContainer&&this.pixelsContainer.firstElementChild)for(;this.pixelsContainer.firstElementChild;)this.pixelsContainer.removeChild(this.pixelsContainer.firstElementChild)},r.prototype.selectServer=function(){var e=this;e.intergiServer=null,e.genericServer=null;try{for(var t=0;t<e.config.servers.length;t++){var i=e.config.servers[t],a=i.type;a===e.INTERGI?e.intergiServer=i:(e.genericServer=i,e.genericServer.type===e.GENERIC_GOOGLE&&(e.type=n.Ad.Type.GOOGLE,e.provider=n.Ad.Provider.GOOGLE))}e.selectedServer=e.genericServer?e.genericServer:e.intergiServer}catch(r){}},r.prototype.hasVMAPBreak=function(e){var t=this;if(Math.floor(e)===t.processedVMAPSecond)return!1;var i=t.VMAPAdapter.getBreaks(e);return i&&LOG.info("Found VMAP ad break at ",e,"s"),!!i},r.prototype.requestAd=function(e,t,i){var n=this;return"overlay"===n.timing&&(window.AdSession.complete(),n.remove()),"none"!==n.status?(LOG.warn("[bolt3] Currently requesting ad, skipping the new request ("+e+", "+t+"s)"),null):(n.clearTrackingImages(),n.cuepoint=t,window.AdSession.reset(),window.AdRequest.reset(),window.AdTracking.reset(),window.SSTracker.reset(),n._backfilling=!1,n.aborted=!1,"function"==typeof i&&i(),n.vastImpressions=[],n.timeout=s,n.container.style.display="block",n.timing=e,n.status="requesting",LOG.info("MAX ATTEMPTS",n.max_attempts),n.selectServer(),void(n.VMAPAdapter.breaks?(n.VMAPBreaksForCurrentAdTiming||(n.VMAPBreaksForCurrentAdTiming="midroll"===e?n.VMAPAdapter.getBreaks(t):n.VMAPAdapter.getBreaks(e)),n._start()):n._start()))},r.prototype.requestOverlay=function(e,t,i){var n=this;return"none"!==n.status?(LOG.warn("[bolt3] Currently requesting ad, skipping the new request"),window.postLogMessage("Currently requesting ad, skipping the new request","warn"),null):(n.clearTrackingImages(),n.cuepoint=e,"function"==typeof t&&t(),window.AdSession.reset(),window.AdRequest.reset(),window.AdTracking.reset(),window.SSTracker.reset(),n.aborted=!1,n.timing="overlay",n.timeout=d,LOG.info("requesting overlay ad "),window.postLogMessage("Requesting overlay ad"),n.status="requesting",n.selectServer(),void n._start(i))},r.prototype.requestInlineAd=function(e,t){var i=this;i.aborted=!1,i.clearTrackingImages();var n=i._selectTag("video300x250");"undefined"==typeof n||""===n?(LOG.error("[bolt3] 350 tag is empty"),window.postLogMessage("350 tag is empty","error"),t&&t.call()):(LOG.debug("[bolt3] 350 tag",n),window.postLogMessage("350 tag "+n),i.threeTwoFifty={},i.threeTwoFifty.src=n,require(["threeTwoFiftyAdsPlayer"],function(i){var n=new i(!1,e);n.playAd(),n.crawl(),n.iframeLoaded===!1&&t.call()}))},r.prototype._start=function(e){var t=this;if(t._selectedTag=null,t.type=null,window.AdRequest.reset(),window.AdTracking.reset(),!t.aborted){if(!t.selectedServer)return"function"==typeof e&&e.call(null),t.resetStatus(),void t._dispatchEvent(n.Ad.Event.FAILED);if(t.selectedServer.type===t.INTERGI?t.max_attempts=3:(t.max_attempts=1,LOG.info("Not using intergi tag, reset DC max attempt to",t.max_attempts)),t.isUsingVMAP&&!t._backfilling&&"overlay"!=t.timing?(LOG.info("Trying to find a VMAP break"),window.postLogMessage("Looking for a VMAP break"),t.VMAPBreaksForCurrentAdTiming&&t.VMAPBreaksForCurrentAdTiming.length>0&&(t.processedVMAPSecond=t.cuepoint,LOG.info("Using VMAP Breaks :",t.VMAPBreaksForCurrentAdTiming),window.postLogMessage("Found a VMAP break @"+t.cuepoint+"s"),t.selectedVMAPBreak=t.VMAPBreaksForCurrentAdTiming.shift(),t._selectedTag=t.selectedVMAPBreak?t.selectedVMAPBreak.adURI:null,t._selectedTag&&/doubleclick.net/i.test(t._selectedTag)&&(t.type=n.Ad.Type.GOOGLE,t.provider=n.Ad.Provider.GOOGLE))):t._selectedTag=t._selectTag(),!t._selectedTag){var a="overlay"===t.timing?"overlay":t.timing;return t.isUsingVMAP&&"overlay"!=t.timing?(LOG.error("[bolt3] No "+a+" VMAP break found"),window.postLogMessage("No "+a+" VMAP break found","error")):(LOG.error("[bolt3] No "+a+" tag in config"),window.postLogMessage("No "+a+" tag in config","error")),void(t._backfilling?("function"==typeof e&&e.call(null),t.resetStatus(),t._dispatchEvent(n.Ad.Event.FAILED)):t._fail())}t._dispatchEvent(n.Ad.Event.REQUESTED);var r=function(e){var i=new Date;LOG.info("[bolt3] Ad request starts at ",i),window.postLogMessage("Ad request starts at "+i),t._dcTimeoutReached=!1,t._dcTimeout&&(clearTimeout(t._dcTimeout),t._dcTimeout=null),t._dcStartTime=i.getTime(),t._dcTimeout=setTimeout(function(){var e=new Date;LOG.warn("[bolt3] Ad request timeout reached ",e),window.postLogMessage("Ad request timeout reached "+e,"error"),t._dcTimeoutReached=!0,t._fail()},e||t.timeout)},o=function(){t.src=i.substituteMacros(t.src),t.attempts=0,t._dcTimeout||r(),window.AdSession.start(t._backfilling),t._backfilling?window.SSTracker.backfill(t._selectedTag):t.selectedServer.type!=t.INTERGI&&window.SSTracker.start({tag:t._selectedTag,timing:t.timing,serverType:t.selectedServer.type,vmap:t.isUsingVMAP?t.VMAPAdapter.primaryTag:null}),t.daisyChain()};if(LOG.debug("[bolt3] Found a "+t.timing+" tag: "+t._selectedTag),window.postLogMessage("Found a "+t.timing+" tag: "+t._selectedTag,"info"),t.src=t._selectedTag.concat(),t.selectedServer.type===t.INTERGI&&(t.src=t.src+";acao=*","preroll"===t.timing)){var s=null,d=CurrentVideoConfig.advertising.headerBids;if(Array.isArray(d)&&d.length>0&&(s=d[0],LOG.info("Found header bid param in the config",s),window.postLogMessage("Found header bid param in the config: "+s)),!s){var l=t.src.match(/headerbids=([^;]*)/i);Array.isArray(l)&&l.length>0&&(s=l[1],LOG.info("Found header bid params in the tag",s),
s=s.split(",")[0],LOG.info("Using ",s),window.postLogMessage("Using headerbid:"+s))}if("string"==typeof s&&(s=s.toLowerCase()),"amazon"===s){window.postLogMessage("Requesting Amazon Header Bidding data");var u=window.AmazonBidObjectAvailable?t.timeout:t.timeout+5;return r(u),void MessageChannel.sendRequest("amazon_bid",function(e){"abort"!==t.status&&(LOG.info("Amazon Header data",e),t.bid={source:"amazon"},e&&e.sub1?(t.src=t.src+";kvamznslots="+e.kvamznslots+";sub1="+e.sub1,t.bid.status=!0,o()):(LOG.warn("No bids from Amazon"),window.postLogMessage("No bids from Amazon","error"),t.bid.status=!1,o()))})}}o()}},r.prototype._selectTag=function(e){var t=this,i=e||t.timing,n=null;try{var a=t._getTagsForDomain(t.selectedServer.tags);LOG.info("[bolt3] search",i,"tag from",a),a&&(o.hasFlash&&a.standard?n="overlay"===i?a.standard.overlay:a.standard[i]:a.html5&&(o.isMobile&&a.html5.mobile?n="overlay"===i?a.html5.mobile.overlay:a.html5.mobile[i]:a.html5.desktop&&(n="overlay"===i?a.html5.desktop.overlay:a.html5.desktop[i])),t.selectedSiteTags=a)}catch(r){}return n},r.prototype._getTagsForDomain=function(e){var t=this;if(!e)return null;var i=window.site.hostname;LOG.info("[bolt3] Hostname",i),window.postLogMessage("Hostname : "+i);var n=null;try{var a=window.site.tld;if(LOG.info("[bolt3] Top level domain",a),window.postLogMessage("Top level domain: "+a),PlayerSettings.forceAds&&(LOG.debug("[bolt3] Forcing Ads for",a),window.postLogMessage("Forcing Ads for: "+a)),"playwire.com"===a&&"support.playwire.com"!==i&&!PlayerSettings.forceAds)return LOG.warn("[bolt3] TLD is "+a+". Ads disabled"),window.postLogMessage("TLD is "+a+". Ads disabled","warn"),null;for(var r in e){if(r===i){n=r;break}if(r===a||r==="*."+a){n=r;break}}}catch(o){}return n?(LOG.debug("[bolt3] Found site-specific tags",e[n]),window.postLogMessage("Found site-specific tags for "+i),t.tagType=n,e[n]):(LOG.debug("[bolt3] There are no site-specific tags for "+i+". Using syndication tags."),window.postLogMessage("There are no site-specific tags for "+i+". Using syndication tags."),t.tagType="syndication",e["default"])},r.prototype.daisyChain=function(){var e=this;if(e.vastImpressions=[],e.adtechGoogleAdCount=null,e.bestMedia=null,e.provider=null,window.AdRequest.reset(),window.AdTracking.reset(),e.removeAllListeners("clicked"),e.removeEventListener(n.Media.Event.LOADED,e._onAdMediaLoaded),e.removeEventListener(n.Media.Event.PLAYING,e._onAdMediaPlaying),e.adPlayer&&e.adPlayer.removeEventListener(n.ERROR,e._onAdError),!e.aborted){if(e._dcTimeoutReached)return LOG.error("[bolt3] cancel daisy-chain, timeout limit has been reached",new Date),void window.postLogMessage("Cancel daisy-chain, timeout limit has been reached","error");if(e.attempts+=1,e.attempts>1&&(e.bid=null),e.attempts>e.max_attempts)return LOG.error("[bolt3] daisy chain max attempts "+e.max_attempts+" reached"),window.postLogMessage("Daisy chain max attempts "+e.max_attempts+" reached","error"),e._fail(),null;LOG.info("[bolt3] daisy chain attempt #",e.attempts),window.postLogMessage("daisy chain attempt #"+e.attempts),e._backfilling||(e.selectedServer.type===e.GENERIC_GOOGLE||e.isUsingVMAP)&&window.AdRequest.start(e._selectedTag,e.attempts),e.selectedServer.type===e.GENERIC_GOOGLE||e.isUsingVMAP&&e.type===n.Ad.Type.GOOGLE?(e._currentRequestId=Date.now(),e.processCustomGoogleAd(e._currentRequestId)):e._loadNewTag()}},r.prototype._loadNewTag=function(){function e(){function e(){t.status="failed",t.daisyChain()}LOG.debug("[bolt3] Requesting tag from ad server "+t.src),window.postLogMessage("Requesting tag from ad server "+t.src),1===t.attempts?window.AdRequest.start(t.src,t.attempts,t.bid):window.AdRequest.start(t.src,t.attempts),i.xhr(t.src,"get",null,function(i,n){if(!i||"string"==typeof i&&0===i.trim().length)LOG.error("[bolt3] empty response from ad server"),window.postLogMessage("Empty response from ad server","error"),window.AdRequest.fail("empty response"),e();else try{var a=new DOMParser,r=a.parseFromString(i,"text/xml");t.handleResponse(r,n)}catch(o){LOG.error(o),window.AdRequest.fail("Bad response"),e()}},function(t){window.AdRequest.fail("Network error"),e()},"text",t._currentRequestId)}var t=this;if(!t.aborted)if(t._currentRequestId=Date.now(),t.selectedServer.type===t.INTERGI){if(t.triedCampaigns.length>0){var n=function(e){return e.reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[])};t.triedCampaigns=n(t.triedCampaigns),t.src=t.src.replace(/\;key=.*$/,""),t.src=t.src+";key="+t.triedCampaigns.join("+")}e(t._currentRequestId)}else t.selectedServer.type===t.GENERIC_VAST&&e(t._currentRequestId)},r.prototype._fail=function(){var e=this;return e.vastImpressions=[],e.adtechGoogleAdCount=null,e.adPlayer&&(e.adPlayer.remove(),e.adPlayer.removeEventListener(n.ERROR,e._onAdError)),e.removeEventListener(n.Media.Event.LOADED,e._onAdMediaLoaded),e.removeEventListener(n.Media.Event.PLAYING,e._onAdMediaPlaying),e.aborted?void 0:e._dcTimeoutReached?(e.resetStatus(),void e._dispatchEvent(n.Ad.Event.FAILED)):void(e.selectedServer.type!=e.INTERGI?(e._selectedTag&&window.SSTracker.fail(),e.intergiServer?(LOG.info("[bolt3] custom tag failed, trying to backfill using adtech tags"),window.postLogMessage("Custom tag failed, trying to backfill using adtech tags","warn"),e._backfilling=!0,e.selectedServer=e.intergiServer,window.AdSession.fail(),e._start()):(e._selectedTag&&e.recordCustomAdImpression(),LOG.warn("[bolt3] No Ad",new Date),window.postLogMessage("No Ad","error"),e.resetStatus(),e._dispatchEvent(n.Ad.Event.FAILED))):"overlay"===e.timing?(e._backfilling&&(e.recordCustomAdImpression(),window.SSTracker.backfillFail(e._selectedTag)),e.resetStatus(),LOG.error("[bolt3] No overlay Ad"),window.postLogMessage("No overlay Ad","error"),e._dispatchEvent(n.Ad.Event.FAILED)):"video300x250"!=e.timing?e.threeTwoFiftyFrame():(e._backfilling&&(e.recordCustomAdImpression(),window.SSTracker.backfillFail(e._selectedTag)),LOG.warn("[bolt3] No Ad",new Date),window.postLogMessage("No Ad","error"),e.resetStatus(),e._dispatchEvent(n.Ad.Event.FAILED)))},r.prototype.handleResponse=function(e,t){var a=this;if(t===a._currentRequestId&&!a.aborted){if(a._dcTimeoutReached)return LOG.error("[bolt3] Received a response from ad server but timeout limit has been reached, exit."),window.postLogMessage("Received a response from ad server but timeout limit has been reached, exit.","error"),void window.AdRequest.fail("Daisy-chain timeout");if(null===e)return window.AdRequest.fail("Bad response"),a.status="failed",void a.daisyChain();window.zeus_ad_xml=e;var r=i.xmlToJson(e);if(null===r?a.type="unknown":"undefined"!=typeof r.VAST?a.type=n.Ad.Type.VAST:"undefined"!=typeof r.BoltAdTemplate&&"google"===r.BoltAdTemplate["@attributes"].source?a.type=n.Ad.Type.GOOGLE:"undefined"!=typeof r["adserver-response"]&&"img"===r["adserver-response"]["@attributes"].rettype?a.type=n.Ad.Type.STATIC_IMAGE:a.type="unknown",LOG.debug("[bolt3] Received a response",e),window.postLogMessage("Received a response","success"),a.type===n.Ad.Type.VAST){a.vastImpressions=[];var s=e.getElementsByTagName("VASTAdTagURI")[0],d=function(e){var t;try{t=e.getElementsByTagName("Ad")[0]}catch(i){}return t}(e),l=!1;if("undefined"!=typeof d){if(l="true"===d.getAttribute("overlay"),"overlay"===a.timing){if(a.selectedServer===a.INTERGI&&!l)return LOG.warn("Requested overlay ads but received non-overlay tag"),window.postLogMessage("Requested overlay ads but received non-overlay tag","error"),window.AdRequest.fail("Overlay tag expected"),void a.daisyChain();a.type=n.Ad.Type.OVERLAY}if(a.campaignId=d.id,a.campaignId&&(a.triedCampaigns.push(a.campaignId),window.AdRequest.campaignId=a.campaignId),s){var c=s.textContent;if(-1!=c.indexOf("adotube.com")&&"preroll"!=a.timing)return LOG.warn("[bolt3] Received Adotube tag not in preroll. Try to daisy-chain."),window.postLogMessage("Received Adotube tag not in preroll. Try to daisy-chain.","warn"),window.AdRequest.fail("Adotube not expected"),a.status="failed",void a.daisyChain();if(-1!=c.indexOf("delivery.vidible.tv")&&"preroll"!=a.timing)return LOG.warn("[bolt3] Received AOL tag not in preroll. Try to daisy-chain."),window.postLogMessage("Received AOL tag not in preroll. Try to daisy-chain.","warn"),window.AdRequest.fail("AOL not expected"),a.status="failed",void a.daisyChain();if(c.indexOf("coull.com")>-1&&c.indexOf("ad_type=ov")>-1&&u>0)return window.postLogMessage("Cannot play COULL overlay ad more than once. Trying to daisy-chain.","warn"),window.AdRequest.fail("Too many requests for Coull overlay"),a.status="failed",void a.daisyChain()}else LOG.info("Received a direct-campaign VAST"),window.postLogMessage("Received a direct-campaign VAST");require(["vastvmap"],function(i){i.parseXML(e,function(e){a.successfulVASTResponse(e,t)},"",a,window.ContentPlayer)})}}else a.type===n.Ad.Type.GOOGLE?(LOG.debug("[bolt3] found google"),window.postLogMessage("Received a Google tag"),o.isMobile&&a.videoElement&&(a.videoElement.style.display="none"),a.successfulGoogleResponse(r,e,t)):a.type===n.Ad.Type.STATIC_IMAGE?(LOG.debug("[bolt3] found static image"),window.postLogMessage("Received a static image ad tag"),o.isMobile&&a.videoElement&&(a.videoElement.style.display="none"),a.successfulStaticImageResponse(r,e,t)):(LOG.debug("[bolt3] bad response from ad server"),window.postLogMessage("Bad response from ad server"),window.AdRequest.fail("Bad response"),a.status="failed",a.daisyChain())}},r.prototype.successfulVASTResponse=function(e,t){window.postLogMessage("VAST XML has been processed"),LOG.info("VAST XML has been processed");var a=this;if(t===a._currentRequestId&&!a.aborted){if(a._dcTimeoutReached)return LOG.error("[bolt3] Received a VAST ad but timeout limit has been reached, exit."),window.postLogMessage("Received a VAST ad but timeout limit has been reached, exit.","error"),window.AdRequest.fail("Timeout"),void(a.vastImpressions=[]);if("undefined"==typeof e||null===e)LOG.error("[bolt3] empty vast document"),window.postLogMessage("Empty vast document","error"),window.AdRequest.fail("Empty response"),a.status="failed",a.daisyChain();else if(window.postLogMessage("Trying to find a playable ad media"),LOG.info("Finding playable ad media"),a.ad=e.getAd(!1),a.type===n.Ad.Type.OVERLAY){if(a.ad.properties.hasOwnProperty("AdSystem")&&"string"==typeof a.ad.properties.AdSystem&&"coull"===a.ad.properties.AdSystem.toLowerCase()){window.postLogMessage("Found Coull Non-linear Ad");var r=a.ad.getNonLinears().resources.images;LOG.info("Coull : ",r);var o;r[n.Mime.JS]?(o=r[n.Mime.JS],window.postLogMessage("Coull Non-linear [javascript] : "+o),a.bestMedia={src:o,type:n.Mime.JS},a.status="media_located",a.provider=n.Ad.Provider.COULL,a._dispatchEvent(n.Ad.Event.READY),a.playAd()):r[n.Mime.SWF]&&(window.AdRequest.fail("Unsupported Coull flash overlay"),a.status="failed",a.daisyChain())}}else{var s=a.ad.getLinear(),d=s.getAllMediaAsObject(),l=[n.Mime.SWF,n.Mime.JS,n.Mime.XJS,n.Mime.MP4,n.Mime.WEBM,n.Mime.OGG,n.Mime.FLV];a.bestMedia=i.ad.getBestMedia(i.ad.filterAdMedia(d),l),null!==a.bestMedia?(LOG.info("[bolt3] Found a playable ad media file",a.bestMedia.src,a.bestMedia.apiFramework),window.postLogMessage("Found a playable ad media file :"+a.bestMedia.src),a.status="media_located",a.bestMedia.type===n.Mime.JS||a.bestMedia.type===n.Mime.XJS?(a.type=n.Ad.Type.JS_VPAID,a.bestMedia.src.indexOf("LiveRail.AdManager")>-1?a.provider=n.Ad.Provider.LIVERAIL:a.bestMedia.src.indexOf("yume_vpaid.js")>-1?a.provider=n.Ad.Provider.YUME:a.bestMedia.src.indexOf("vidible.tv")>-1?a.provider=n.Ad.Provider.AOL:/spotxcdn.com/.test(a.bestMedia.src)?a.provider=n.Ad.Provider.SPOTX:/redir.adap.tv/.test(a.bestMedia.src)?a.provider=n.Ad.Provider.ADAP:a.provider="generic"):a.bestMedia.type===n.Mime.SWF&&(LOG.info("Found flash swf"),a.type=n.Ad.Type.FLASH_VPAID,a.provider="generic",a.bestMedia.src.indexOf("liverail.com")>-1?a.provider=n.Ad.Provider.LIVERAIL:a.bestMedia.src.indexOf("adotube.com")>-1&&(a.provider=n.Ad.Provider.ADOTUBE)),a._dispatchEvent(n.Ad.Event.READY),a.playAd()):(LOG.error("[bolt3] No playable ad media"),window.postLogMessage("No playable ad media","error"),window.AdRequest.fail("No playable ad media"),a.status="failed",a.daisyChain())}}},r.prototype.processCustomGoogleAd=function(e){var t=this;if((t.isUsingVMAP||e===t._currentRequestId)&&!t.aborted){if(t._dcTimeoutReached)return LOG.error("[bolt3] About to process custom google ad but timeout limit has been reached."),void window.postLogMessage("About to process custom google ad but timeout limit has been reached","error");t.videoElement&&(t.videoElement.style.display="none"),t.type=n.Ad.Type.GOOGLE,t.playAd()}},r.prototype.successfulGoogleResponse=function(e,t,i){var a=this;if(i===a._currentRequestId&&!a.aborted){if(a._dcTimeoutReached)return LOG.error("[bolt3] Received google ad template from AdTech but timeout limit has been reached"),void window.postLogMessage("Received google ad template from AdTech but timeout limit has been reached","error");a.googleChannel=e.BoltAdTemplate["@attributes"].channel,a.googlePublisherId=e.BoltAdTemplate["@attributes"].publisherId,a.googleAdId=e.BoltAdTemplate["@attributes"].adid,a.googleSlotname=e.BoltAdTemplate["@attributes"].slotname||1758784393,window.postLogMessage("Google Ad Channel : "+a.googleChannel),window.postLogMessage("Google Ad Publisher Id : "+a.googlePublisherId),window.postLogMessage("Google Ad Id : "+a.googleAdId),window.postLogMessage("Google Ad Slotname : "+a.googleSlotname),a.campaignId=a.googleAdId,a.campaignId&&(a.triedCampaigns.push(a.campaignId),window.AdRequest.campaignId=a.campaignId),a.videoElement&&(a.videoElement.style.visibility="hidden"),a.adtechGoogleAdCount=t.firstChild.childNodes[1].childNodes[0].nodeValue,a.provider=n.Ad.Provider.GOOGLE,a.playAd()}},r.prototype.successfulStaticImageResponse=function(e,t,a){var r=this;if(a===r._currentRequestId&&!r.aborted){if(r._dcTimeoutReached)return LOG.error("[bolt3] Received a static image ad but timeout limit has been reached","error"),void window.postLogMessage("Received a static image ad but timeout limit has been reached","error");window.postLogMessage("Received a static image ad"),r._dispatchEvent(n.Ad.Event.READY),r.staticImage={};try{r.staticImage.src=e["adserver-response"]["banner-info"].creative["@attributes"].url,r.staticImage.clickthrough=i.substituteMacros(e["adserver-response"]["banner-info"].link["@attributes"].url),r.staticImage.width=e["adserver-response"]["banner-info"].creative["@attributes"].width,r.staticImage.height=e["adserver-response"]["banner-info"].creative["@attributes"].height,r.playAd()}catch(o){window.postLogMessage("Static image ad failed to load. "+o.message,"error"),window.AdRequest.fail("Static image ad failed to load"),r.status="failed",r.daisyChain()}var s;try{s=t.firstChild.childNodes[3].childNodes[5].firstChild.nodeValue}catch(o){LOG.error("Impression URL is missing ",t),window.postLogMessage("Impression URL is not found in the static image ad XML","warn")}s&&i.xhr(s,"get",null,function(){LOG.info("[bolt3] ADTECH adcount for static image ad has been fired",s),window.postLogMessage("ADTECH adcount for static image ad has been fired "+s,"success")},function(){LOG.error("[bolt3] Failed to fire ADTECH adcount for static image ad",s),window.postLogMessage("Failed to fire ADTECH adcount for static image ad"+s,"error")})}},r.prototype.threeTwoFiftyFrame=function(){var e=this;if(!e.aborted){if(e.timing="video300x250",e._dcTimeoutReached)return LOG.error("[bolt3] Got a 300 x 250 ad but timeout limit has been reached, exit."),window.postLogMessage("Received a 300 x 250 ad but timeout limit has been reached","error"),window.AdRequest.fail("Timeout"),void e._fail();e._selectedTag=e._selectTag(),e.container.clientHeight<280||e.container.clientWidth<350?(LOG.warn("[bolt3] player too small for 300x250 playback"),window.postLogMessage("Player too small for 300x250 ad playback","error"),e._fail()):e._selectedTag&&""!==e._selectedTag?(LOG.debug("[bolt3] 350 tag",e._selectedTag),window.postLogMessage("350 tag "+e._selectedTag),e._dispatchEvent(n.Ad.Event.READY),e.threeTwoFifty={},e.threeTwoFifty.src=e._selectedTag,e.type="video300x250",e.bestMedia={src:e._selectedTag,type:"video300x250"},e.playAd()):(LOG.error("[bolt3] 350 tag is empty"),window.postLogMessage("350 tag is empty","error"),window.AdRequest.fail("Empty tag"),e._fail())}},r.prototype._onAdMediaLoaded=function(){var e=this;e.type!==n.Ad.Type.JS_VPAID&&e.type!==n.Ad.Type.FLASH_VPAID&&e.type!==n.Ad.Type.GOOGLE&&e.type!==n.Ad.Type.OVERLAY||e._killDCTimeout(),e.adPlayer&&(e._isLinear=e.adPlayer.isLinear(),e._isLinear?e.container.style.backgroundColor="#000":(e.container.style.display="block",e.container.style.backgroundColor="rgba(0,0,0,0)"),LOG.info("[bolt3] ",e._isLinear?"Linear":"Non-Linear Ad media fully loaded, "+(Date.now()-e._dcStartTime)/1e3+" secs after daisy-chain began"),window.postLogMessage("Ad media fully loaded, "+(Date.now()-e._dcStartTime)/1e3+" secs after daisy-chain began"),e.type===n.Ad.Type.GOOGLE&&window.AdRequest.setMedia(e.adPlayer.getSource()),window.AdRequest.success(),e.selectedServer.type!=e.INTERGI?(e.recordCustomAdImpression(),window.SSTracker.success()):e._backfilling&&window.SSTracker.backfillSuccess(e._selectedTag))},r.prototype.trackVMAPEvent=function(e){this.selectedVMAPBreak.trackingEvents&&(LOG.info("tracking vmap event",e),window.postLogMessage("Tracking vmap "+e),this.selectedVMAPBreak.trackingEvents.track(e))},r.prototype._onAdMediaPlaying=function(){var t,i=this;t="preroll"===i.timing?"09":"postroll"===i.timing?"10":"11",e.fireComscoreCall({c5:t})},r.prototype._onAdError=function(e){var t=this;LOG.error("[bolt3]",t.type+" Ad error"),window.postLogMessage("Ad error","error"),window.AdRequest.fail("Ad error: "+e.data),t.status="failed",t.daisyChain()},r.prototype._killDCTimeout=function(){var e=this;e._dcTimeout&&(LOG.debug("[bolt3] kill dc timeout"),clearTimeout(e._dcTimeout),e._dcTimeout=null)},r.prototype.playAd=function(){function e(){t.aborted||(LOG.debug("[bolt3] Trying to play the ad in "+(Date.now()-t._dcStartTime)/1e3+" secs after daisy-chain began"),window.postLogMessage("Trying to play the ad in "+(Date.now()-t._dcStartTime)/1e3+" secs after daisy-chain began"),(t.selectedServer.type===t.GENERIC_GOOGLE||t.isUsingVMAP&&t.type===n.Ad.Type.GOOGLE)&&(t.adPlayer.customTag=t.src),t.adPlayer.addOnceEventListener(n.ERROR,t._onAdError),t.addOnceEventListener(n.Media.Event.LOADED,t._onAdMediaLoaded),t.addOnceEventListener(n.Media.Event.PLAYING,t._onAdMediaPlaying),t.adPlayer.playAd(t))}var t=this;t.duration=null,t.currentTime=0,t.percentPlayed=0,t.aborted||(window.AdRequest.adType=t.type,window.AdRequest.network=t.provider,t.type!=n.Ad.Type.GOOGLE&&window.AdRequest.setMedia(t.bestMedia.src,t.bestMedia.type),t.container.style.visibility="visible",t.type!=n.Ad.Type.JS_VPAID&&t.type!=n.Ad.Type.FLASH_VPAID&&t.type!=n.Ad.Type.GOOGLE&&t.type!=n.Ad.Type.OVERLAY?t._killDCTimeout():LOG.info("Loading",t.type,"DC clock keeps running until we really get an ad"),t.type===n.Ad.Type.VAST||t.type===n.Ad.Type.FLASH_VPAID?require(["vastAdsPlayer"],function(i){t.adPlayer=new i,e()}):t.type===n.Ad.Type.JS_VPAID?(LOG.info("Playing JS VPAID ",t.provider),t.provider===n.Ad.Provider.LIVERAIL?require(["zeus_liverail_jsvpaid"],function(i){t.adPlayer=new i(t.bestMedia),e()}):t.provider===n.Ad.Provider.YUME?require(["yume_jsvpaid"],function(i){t.adPlayer=new i(t.bestMedia),e()}):t.provider===n.Ad.Provider.AOL?require(["aol_jsvpaid"],function(i){t.adPlayer=new i(t.bestMedia),e()}):t.provider===n.Ad.Provider.SPOTX?require(["spotx_jsvpaid"],function(i){t.adPlayer=new i(t.bestMedia,t.ad.linear.parameters),e()}):t.provider===n.Ad.Provider.ADAP?require(["adap_jsvpaid"],function(i){t.adPlayer=new i(t.bestMedia,t.ad.linear.parameters),e()}):require(["linear_jsvpaid"],function(i){t.adPlayer=new i(t.bestMedia,t.ad.linear.parameters),e()})):t.type===n.Ad.Type.GOOGLE?"overlay"===t.timing?require(["google_html_overlay"],function(i){t.adPlayer=new i,e()}):o.hasFlash?require(["zeus_googleFlashPlayer"],function(i){t.adPlayer=new i,e()}):o.isMobile?(t.adPlayer=window.MobileIMAPlayer,e()):require(["googleAdsPlayer"],function(i){t.adPlayer=new i,e()}):t.type===n.Ad.Type.STATIC_IMAGE?require(["staticImageAdsPlayer"],function(i){t.adPlayer=new i,e()}):t.type===n.Ad.Type.THREE_TWO_FIFTY?require(["threeTwoFiftyAdsPlayer"],function(i){t.adPlayer=new i,e(),t.adPlayer.crawl(),t.adPlayer.iframeLoaded===!1&&t._fail()}):t.type===n.Ad.Type.OVERLAY&&t.provider===n.Ad.Provider.COULL&&require(["coull_html_overlay"],function(i){u++,t.adPlayer=new i,e()}))},r.prototype.getDuration=function(){return this.adPlayer.getDuration()},r.prototype.getCurrentTime=function(){var e=this.adPlayer.getCurrentTime();return"undefined"==typeof e&&(e=0),e},r.prototype.getPercentPlayed=function(){var e=this;return null!==e.getCurrentTime()&&null!==e.getDuration()?100*(e.getCurrentTime()/e.getDuration()):null},r.prototype.getVolume=function(){return this.adPlayer.getVolume()},r.prototype.pause=function(){this.adPlayer.pause()},r.prototype.resume=function(){this.adPlayer.resume()},r.prototype.setVolume=function(e){LOG.debug("[bolt3] setting volume to "+e),this.adPlayer.setVolume(e),this.currentVolume=e},r.prototype.mute=function(){this.currentVolume=this.getVolume(),this.adPlayer.setVolume(0),this._dispatchEvent(n.Media.Event.MUTED)},r.prototype.unmute=function(){this.adPlayer.setVolume(this.currentVolume),this._dispatchEvent(n.Media.Event.UNMUTED)},r.prototype.remove=function(){this.adPlayer&&(LOG.debug("[bolt3] Ad player removed"),window.postLogMessage("Ad player removed"),this.adPlayer.remove()),this.resetStatus()},r.prototype.abort=function(){"none"===this.status||this.aborted||(this.aborted=!0,LOG.warn("Ad aborted"),window.AdRequest.abort(),this._dispatchEvent(n.Ad.Event.ABORTED),this.remove())},r.prototype.isLinear=function(){return this._isLinear},r.prototype.recordCustomAdImpression=function(){var e="https://load-dot-just-strength-116914.appspot.com/impression/:publisher_id/:video_id",t=PlayerSettings.freePlayer?PlayerSettings.fpTrackingId:CurrentVideoConfig.content.videoId,n=CurrentVideoConfig.publisherId;e=e.replace(":publisher_id",n).replace(":video_id",t),LOG.info("record custom ad impression for pub:",n,"video:",t),i.xhr(e,"get")},r}),define("overlay_ad_cue_finder",["zeus_utils"],function(e){var t=function(){this.nextVideoAdCuepoint=0,this.lastVideoAdCuepoint=0,this.skip=!1,this._lastAttempt=0,this._videoDuration=0};return t.prototype={get lastAttempt(){return this._lastAttempt},set lastAttempt(e){this._lastAttempt=Math.floor(e)},get videoDuration(){return this._videoDuration},get MIN_WIDTH(){return 327},get MIN_HEIGHT(){return 340},get AD_INTERVAL(){return 420},get MIN_DURATION(){return 45}},t.prototype.hasCueForTime=function(e,t,i){var n=this,a=n.videoDuration>this.MIN_DURATION&&t>=this.MIN_WIDTH&&i>=this.MIN_HEIGHT,r=Math.floor(e);return a&&(a=n.videoDuration-r>this.MIN_DURATION,a&&(a=r-n.lastVideoAdCuepoint>=15,a&&n.lastAttempt>0&&(a=r-n.lastAttempt>=n.AD_INTERVAL))),a&&n.nextVideoAdCuepoint>0&&(a=n.nextVideoAdCuepoint-r>=this.MIN_DURATION),a&&(n._lastAttempt=r,LOG.info("last attempt",n.lastAttempt,"current time",r,"next ad cue",n.nextVideoAdCuepoint,"result",a)),a},t.prototype.reset=function(e,t){if(!t)throw new Error("Null video duration");this._videoDuration=t,this.lastVideoAdCuepoint=0,this.nextVideoAdCuepoint=0,e&&(this.skip=!1,this.lastAttempt=0)},t}),define("zeus_controller",["comscore","overlay_ad_cue_finder","zeus_utils"],function(e,t,i){var n,a,r,o,s,d,l,u=window,c=u.ZeusConstants,h=u.client,p=i.dom,f=(c.UI,!0),v=new t,g=null,m=function(){LOG.debug("START UP",h.isMobile?"MOBILE":"DESKTOP"),n=u.View,a=u.ContentPlayer,r=u.BoltAdManager,o=u.PlayerState,s=u.PlayerSettings,l=u.pageViews;var e=s.skips||0;if(f=l>e,f||u.postLogMessage("Preroll is disabled because the video has been viewed more than "+e+" times","warn"),LOG.info("pageviews",l,"to skip",e),s.pageviewForAds){for(var t=s.pageviewForAds.split(","),i=0;i<t.length;i++)t[i]=parseInt(t[i]);LOG.info("viewsForAds",t),f=t.indexOf(l)>-1}return LOG.debug("preroll enabled",f),f?(n.addEventListener(c.Player.Event.VIEW_READY,function(e){u.CurrentVideoConfig.settings.minAge>0?(o.state=o.AGE_GATE,n.addOnceEventListener(c.UI.Event.AGE_GATE_PASSED,function(){LOG.debug("Controller::age gate passed"),E()})):(LOG.debug("Controller::no age gate"),E())}),void n.init(u.CurrentVideoConfig.settings.minAge>0)):void U()},E=function(){function e(){s.autoplay===!0?R():o.state=o.START}LOG.debug("DO START UP"),r&&r.addEventListener(c.Ad.Event.VMAP_CUEPOINTS_CHANGED,function(e){CurrentVideoConfig.advertising.cuepoints||(CurrentVideoConfig.advertising.cuepoints=[]),CurrentVideoConfig.advertising.cuepoints=CurrentVideoConfig.advertising.cuepoints.concat(e.data),CurrentVideoConfig.advertising.cuepoints=i.data.sortNumericArray(i.data.getUniqueArray(CurrentVideoConfig.advertising.cuepoints)),LOG.info("VMAP CUEPOINTS CHANGED, new cps",e.data,CurrentVideoConfig.advertising.cuepoints),a&&(a.adsCuepoints=CurrentVideoConfig.advertising.cuepoints.concat())}),a.pseudoAdsCuepoints=[],y(),a.videoAdRatio="undefined"!=typeof u.CurrentVideoConfig.advertising.videoAdRatio?u.CurrentVideoConfig.advertising.videoAdRatio:1,a.videoPlayCount=1,u.readyCallback.call(null,a.containerId),h.isMobile?o.state=o.START:h.hasFlash?require(["zeus_cors_shim"],function(t){window.Cors=new t(e)}):e()},y=function(){n.addEventListener(c.Media.Event.PLAY,_),n.addEventListener(c.Media.Event.PLAYING,_),n.addEventListener(c.Media.Event.PAUSED,_),n.addEventListener(c.Media.Event.RESUME,_),n.addEventListener(c.Media.Event.DURATION_CHANGE,_),n.addEventListener(c.Media.Event.ENDED,_),n.addEventListener(c.Media.Event.TIME_UPDATE,_),n.addEventListener(c.Media.Event.LOADED,_),n.addEventListener(c.Media.Event.MUTED,_),n.addEventListener(c.Media.Event.UNMUTED,_),n.addEventListener(c.Media.Event.VOLUME_CHANGED,_),n.addEventListener(c.Media.Event.WAITING,_),n.addEventListener(c.UI.Event.REPLAY,b),n.addEventListener(c.UI.Event.PLAYPAUSE,b),n.addEventListener(c.UI.Event.PLAYLIST_ITEM_SELECTED,b),n.addEventListener(c.UI.Event.TOGGLE_MUTE,b),n.addEventListener(c.UI.Event.CHANGE_VOLUME,b),n.addEventListener(c.UI.Event.SUBTITLE_SELECTED,b),n.addEventListener(c.UI.Event.SEEK,b),n.addEventListener(c.UI.Event.RELATED_VIDEO_SELECTED,b),n.addEventListener(c.UI.Event.REQUEST_QUALITY,b),n.addEventListener(c.UI.Event.AGE_GATE_FAILED,b)},_=function(e){var t=e.target;switch(e.type){case c.Media.Event.PLAY:LOG.debug("View media events",e.type,t.containerId),t.isAd()||(o.state=o.WAITING);break;case c.Media.Event.PLAYING:o.state=o.PLAYING;break;case c.Media.Event.PAUSED:o.state=o.PAUSED;break;case c.Media.Event.RESUME:LOG.debug("View media events",e.type,t.containerId);break;case c.Media.Event.ENDED:LOG.debug("View media events",e.type,t.containerId),o.state=o.ENDED,t.isAd()||N();break;case c.Media.Event.DURATION_CHANGE:LOG.debug("View media events",e.type,t.containerId),!t.isAd()&&u.CurrentVideoConfig.advertising.on?(v.reset(!0,a.duration),A()):window.AdBlockDetected&&(v.reset(!0,a.duration),A());break;case c.Media.Event.TIME_UPDATE:t.playing&&!t.paused&&(o.state=o.PLAYING,L());break;case c.Media.Event.LOADED:LOG.debug("View media events",e.type,t.containerId);break;case c.Media.Event.WAITING:o.state=o.WAITING;break;case c.Media.Event.MUTED:s.automute=!0;break;case c.Media.Event.UNMUTED:s.automute=!1;break;case c.Media.Event.VOLUME_CHANGED:s.volume=e.data}},b=function(e){var t=n.currentPlayer;switch(e.type){case c.UI.Event.REPLAY:H();break;case c.UI.Event.PLAYPAUSE:H();break;case c.UI.Event.PLAYLIST_ITEM_SELECTED:M(e.data,!0);break;case c.UI.Event.TOGGLE_MUTE:LOG.info(e.type,"volume",t.volume);var i=!t.muted;LOG.info("mute flag?",i),t.mute(i),i===!1&&0===t.volume&&t.setVolume(1);break;case c.UI.Event.CHANGE_VOLUME:LOG.info(e.type,e.data),t.setVolume(e.data),t.mute(0===e.data);break;case c.UI.Event.SEEK:I(e.data);break;case c.UI.Event.RELATED_VIDEO_SELECTED:t.autoplay=!0,O(e.data);break;case c.UI.Event.REQUEST_QUALITY:var a=""===t.getSource();S(e.data,u.CurrentVideoConfig.content.media,a,!a);break;case c.UI.Event.AGE_GATE_FAILED:LOG.warn("age gate failed"),o.state=o.AGE_GATE;break;case c.UI.Event.AGE_GATE_PASSED:LOG.info("age gate passed"),o.state=o.START}},A=function(){if(LOG.info("Create ads cuepoints",u.CurrentVideoConfig.advertising.cuepoints,a.adsCuepoints),"undefined"==typeof a.adsCuepoints||0===a.adsCuepoints.length){if(a.pseudoAdsCuepoints=null,"number"==typeof u.CurrentVideoConfig.advertising.secondsBetweenAds&&u.CurrentVideoConfig.advertising.secondsBetweenAds>0){LOG.info("Create pseudo cuepoints");for(var e=u.CurrentVideoConfig.advertising.secondsBetweenAds,t=e;t<a.duration;t+=e)a.pseudoAdsCuepoints||(a.pseudoAdsCuepoints=[]),a.pseudoAdsCuepoints.push(t)}}else window.AdBlockDetected||n.drawCuepoints()},T=function(){var e=n.currentPlayer;e.isAd()||(LOG.debug("ZeusController::replay",u.CurrentVideoConfig.settings.title),e.replay(),e.videoPlayCount++,v.reset(!1,e.duration))},w=function(e){function t(){r.removeEventListener(c.Media.Event.LOADED,i),r.removeEventListener(c.Media.Event.ENDED,o),r.removeEventListener(c.Ad.Event.FAILED,n),r.removeEventListener(c.Ad.Event.ABORTED,a)}function i(){window.AdSession.adLoaded()}function n(){window.AdSession.fail()}function a(){window.AdSession.abort()}function o(){window.AdSession.complete()}t(),r.requestOverlay(v.lastVideoAdCuepoint,function(){r.addEventListener(c.Media.Event.LOADED,i),r.addEventListener(c.Media.Event.ENDED,o),r.addEventListener(c.Ad.Event.FAILED,n),r.addEventListener(c.Ad.Event.ABORTED,a)},function(){v.skip=!0})},L=function(){var e=n.currentPlayer;if(o.state=o.PLAYING,!e.isAd()){var t=e.currentTime,i=null,a=null,s=!1;if(r&&r.hasVMAPBreak(t))return LOG.info("AdManager has a VMAP break at "+t),void G(parseInt(t));if(e.adsCuepoints&&e.adsCuepoints.length>0?(a=e.adsCuepoints,s=!1):e.pseudoAdsCuepoints&&e.pseudoAdsCuepoints.length>0&&(a=e.pseudoAdsCuepoints,s=!0),!h.system.iphone&&(a&&(v.nextVideoAdCuepoint=a[0]),t>=15&&e.duration>45)){var d=u.Skin,l=!v.skip&&v.hasCueForTime(t,d.clientWidth,d.clientHeight);if(l)return void(u.CurrentVideoConfig.advertising.on&&!DebugMode.noOverlay?(LOG.info("Requesting an overlay ad @",t),w()):AdBlockDetected&&window.AdBlocked.track("overlay"))}if(!DebugMode.noMidroll&&a){for(var c=0;c<a.length;c++){var p=a[c];if(p<e.currentTime){i=a.shift(),s||e.hitAdCuepoint(i);break}}i&&(g=i,s||n.drawCuepoints(),v.lastVideoAdCuepoint=i,v.nextVideoAdCuepoint=a[0],LOG.debug("Controller:ontimeupdate playmidroll",i,"currentTime",e.currentTime),G())}}},S=function(e,t,r,d){if(e===a.currentQuality&&!r)return void LOG.debug("seleting the same video");LOG.debug(this,"Load video quality",e,t);var l=a.getSource(),u=i.getPlayableMediaWithQuality(t,l,e,s.freePlayer);if(u){var c=u.quality,h=u.source;a.fastSeekEnabled=i.fastSeekEnabled(h),LOG.debug("old src= ",l," new=",h," quality=",c,"autoplay",d,"fast seek enabled",a.fastSeekEnabled),a.autoplay=d,r===!0?(LOG.debug("loadVideoQuality","new video",c),a.currentQuality=c,a.setSource(h),d&&"flash"!==a.type&&(a.preload(),o.state=o.WAITING)):(LOG.debug("loadVideoQuality","same video",c),a.setQuality(c,h),o.state=o.WAITING),s.defaultHd="hd"===e,n.isHD("hd"===e),n.enableControls(!0)}},I=function(e){var t=n.currentPlayer;if(!t.isAd()){var i=e;if(o.state=o.WAITING,!DebugMode.noMidroll&&u.CurrentVideoConfig.advertising.on){var a=t.adsCuepoints;if(a.length>0)for(var r=0;r<a.length;r++){var s=a[r];if(e>s){i=s;break}}}t.seek(i)}},C=function(){if(LOG.debug("ZeusController:: show related videos"),s.freePlayer)if(Array.isArray(s.related)){u.RelatedVideos=s.related;for(var e=0;e<u.RelatedVideos.length;e++){var t=u.RelatedVideos[e];t.content.videoId||(t.content.videoId=e);for(var a in u.CurrentVideoConfig.settings)"minAge"!=a&&"title"!=a&&(t.settings[a]=u.CurrentVideoConfig.settings[a]);t.advertising=u.CurrentVideoConfig.advertising}LOG.info(u.RelatedVideos),n.setRelatedVideos(u.RelatedVideos);
}else n.setRelatedVideos(null);else{if(!u.CurrentVideoConfig.related)return n.setRelatedVideos(null),void(o.state=o.ENDED);o.state=o.WAITING,i.xhr(u.CurrentVideoConfig.related,"get",null,function(e){if(e){var t="string"==typeof e?JSON.parse(e):e;if(s.freePlayer){t=t.related;for(var i=0;i<t.length;i++){var a=t[i];a.content.videoId||(a.content.videoId=i);for(var r in u.CurrentVideoConfig.settings)"minAge"!=r&&"title"!=r&&(a.settings[r]=u.CurrentVideoConfig.settings[r]);a.advertising=u.CurrentVideoConfig.advertising}}LOG.debug("related videos",t),t.length>6&&(t=t.splice(0,6)),u.RelatedVideos=t,n.setRelatedVideos(u.RelatedVideos),o.state=o.RELATED_VIDEOS}},function(){LOG.debug("ZeusController:: failed to load related videos"),n.setRelatedVideos(null),o.state=o.ENDED},"json")}},M=function(e,t){o.state=o.WAITING,LOG.debug("load playlist video",e,"autoplay",t),n.enableControls(!1),r.abort(),a.unload(),s.freePlayer?k(e,t):P(e.config,t)},O=function(e){o.state=o.WAITING;for(var t,i=0;i<u.RelatedVideos.length;i++){var n=u.RelatedVideos[i];if(s.freePlayer){if(n.content.videoId==e){t=n;break}}else if(n.videoId==e){t=n;break}}LOG.debug("related video to load",n),r.abort(),s.freePlayer?k(n,!0):P(n.config,!0)},P=function(e,t){LOG.debug("loading config",e),i.loadVideoConfig(e,function(e){k(e,t)},function(){LOG.error("Failed to load video config",e)})},k=function(e,t){function d(){if(u.CurrentVideoConfig.settings=i.mergeSettings(u.CurrentVideoConfig.settings,s,s.freePlayer),i.css.setFeatureClass(),u.CurrentVideoConfig.advertising.on&&u.CurrentVideoConfig.advertising.cuepoints&&(u.CurrentVideoConfig.advertising.cuepoints=i.data.sortNumericArray(u.CurrentVideoConfig.advertising.cuepoints)),u.Playlist)for(var r=0;r<u.Playlist.length;r++){var d=u.Playlist[r];if(d.videoId===e.content.videoId){u.CurrentPlaylistIndex=r,LOG.debug("current playlist index",u.CurrentPlaylistIndex);break}}LOG.info("load new video",e),i.processMediaConfig(e.content.media,function(i){"undefined"!=typeof e.content.media.f4m?(LOG.debug("processed media",i),i&&(e.content.media=i)):(e.content.media=i,LOG.debug("Transformed media ",e.content.media)),LOG.debug("media data",e.content.media);var r=u.CurrentVideoConfig.settings.minAge>0;r?(p.hideElement(c.UI.POSTER),n.addOnceEventListener(c.UI.Event.AGE_GATE_PASSED,function(){t?(LOG.debug("Controller::age gate passed"),R(function(){S(a.currentQuality,e.content.media,!0,t)})):(o.state=o.START,LOG.debug("Controller::age gate passed"),S(a.currentQuality,e.content.media,!0,t))}),n.addOnceEventListener(c.UI.Event.AGE_GATE_FAILED,function(){o.state=o.AGE_GATE})):t?(LOG.info("no age-gate","auto play preroll"),R(function(){S(a.currentQuality,e.content.media,!0,t)})):(o.state=o.START,S(a.currentQuality,e.content.media,!0,t)),a.onVideoConfigChanged()})}u.CurrentVideoConfig=e,r?r.init(d):d()},D=function(e,t,l,f){function v(){r.removeEventListener(c.Media.Event.LOADED,m),r.removeEventListener(c.Media.Event.ENDED,E),r.removeEventListener(c.Ad.Event.FAILED,y),r.removeEventListener(c.Ad.Event.ABORTED,_)}function m(){window.AdSession.adLoaded(),r.removeEventListener(c.Media.Event.LOADED,m),LOG.debug("ZeusController::requestAd hit the ad loaded listener for a "+e),i.css.addClass(Skin,"bolt-ad-type-"+r.type);var o=null;r.type===c.Ad.Type.VAST||r.type===c.Ad.Type.FLASH_VPAID?o=r.adPlayer.adPlayer:r.type===c.Ad.Type.GOOGLE?(LOG.debug(this,"GOOGLE AD LOADED"),o=r.adPlayer):o=r.adPlayer,LOG.debug("zeuscontroller :: got a linear ad",e),"midroll"===e?(h.system.iphone&&a.addOnceEventListener(c.Media.Event.PAUSED,function(){LOG.debug("exiting fullscreen"),a.video.webkitExitFullScreen()}),LOG.debug("about to pause the player"),a.pause()):"postroll"===e?h.system.iphone&&(LOG.debug("exiting fullscreen"),a.video.webkitExitFullScreen()):"preroll"===e&&h.system.iphone&&a.video.webkitExitFullScreen(),n.setCurrentPlayer(o),r.type!==c.Ad.Type.GOOGLE&&o.type!==c.Ad.Type.FLASH_VPAID&&o.type!==c.Ad.Type.JS_VPAID&&o.play(),p.hideElement(c.UI.LOADING_INDICATOR),t()}function E(){window.AdSession.complete(),v(),LOG.debug("hit the ad completed listener for a "+e),clearInterval(d),u.postLogMessage(e+" Ad complete"),i.css.removeClass(Skin,"bolt-ad-type-"+r.type),r.remove(),p.hideElement(c.UI.LOADING_INDICATOR),r.VMAPBreaksForCurrentAdTiming&&r.VMAPBreaksForCurrentAdTiming.length>0?D(e,t,l,f):s.postAdContainer?U(a):(n.setCurrentPlayer(a),l())}function y(){window.AdSession.fail(),LOG.debug("hit the ad failed listener for a "+e),u.postLogMessage(e+" Ad request failed","error"),v(),r.remove(),clearInterval(d),n._dispatchEvent(c.Ad.Event.FAILED,{timing:e}),s.postAdContainer?U(a):(n.setCurrentPlayer(a),p.hideElement(c.UI.LOADING_INDICATOR),l())}function _(){window.AdSession.abort(),i.log.warn("Ad aborted"),i.css.removeClass(Skin,"bolt-ad-type-"+r.type),v(),n.setCurrentPlayer(a)}"midroll"!=e&&(o.state=o.WAITING);var b=g?g:"preroll"===e?-1:99999999999;"midroll"===e&&f&&(b=f),r.requestAd(e,b,function(){p.showElement(c.UI.AD_CONTAINER,"block","hidden"),r.addEventListener(c.Media.Event.LOADED,m),r.addEventListener(c.Media.Event.ENDED,E),r.addEventListener(c.Ad.Event.FAILED,y),r.addEventListener(c.Ad.Event.ABORTED,_)})},R=function(e){function t(){}function i(){LOG.info("Preroll finished callback"),h.isMobile?setTimeout(function(){"function"==typeof e?e():V()},500):"function"==typeof e?e():V()}AdBlockDetected&&window.AdBlocked.track("preroll"),o.state=o.PLAYING,u.CurrentVideoConfig.advertising.on||u.postLogMessage("Advertising is disabled for the current video","warn"),!DebugMode.noPreroll&&r&&f&&u.CurrentVideoConfig.advertising.on&&(a.videoPlayCount-1)%a.videoAdRatio===0?(LOG.debug(this,"playPrerollAd"),D("preroll",t,i)):h.isMobile?setTimeout(function(){"function"==typeof e?e():V()},500):"function"==typeof e?e():V()},G=function(e){function t(){}function i(){LOG.info("Midroll finished callback");var e=u.CurrentVideoConfig.advertising.cuepoints||[];if(e.length>0){var t=e.length+1;10>t&&(t="0"+t);var i=a.previousCuepointIndex+2;10>i&&(i="0"+i),a.adsCuepoints.length>=0&&B({c10:"["+i+"-"+t+"]"})}q()}AdBlockDetected&&window.AdBlocked.track("midroll"),!DebugMode.noMidroll&&r&&u.CurrentVideoConfig.advertising.on&&(a.videoPlayCount-1)%a.videoAdRatio===0&&D("midroll",t,i,e)},N=function(){function e(){var e=u.Playlist;if(u.CurrentPlaylistIndex<e.length-1){var t=e[u.CurrentPlaylistIndex+1],i=!!s.playlistPlaythrough;LOG.debug("process playlist",s,u.CurrentVideoConfig.settings),M(t,i)}else o.state=o.ENDED}function t(){}function i(){LOG.info("Postroll finished callback");var t=!1;if(u.Playlist)return void e();if(a.loop?t=!0:h.system.iphone?(a.video.webkitEnterFullScreen(),a.addOnceEventListener("webkitendfullscreen",function(){LOG.info("IOS END Fullscreen"),a.show(!1)})):a.show(!1),LOG.debug("replay after postroll",t),t)var i=setTimeout(function(){clearTimeout(i),LOG.debug("postroll finished, auto replay"),R()},100);else u.CurrentVideoConfig.related?(o.state=o.WAITING,C()):o.state=o.START}AdBlockDetected&&window.AdBlocked.track("postroll"),LOG.debug("postroll","video play count",a.videoPlayCount,"videoAdRatio",a.videoAdRatio),o.state=o.WAITING,!DebugMode.noPostroll&&r&&u.CurrentVideoConfig.advertising.on&&(a.videoPlayCount-1)%a.videoAdRatio===0?u.Playlist&&u.CurrentPlaylistIndex!==u.Playlist.length-1?e():(o.state=o.WAITING,D("postroll",t,i)):u.Playlist?e():a.loop?V():u.CurrentVideoConfig.related?(o.state=o.WAITING,C()):o.state=o.START},U=function(){var e=s.postAdContainer;e&&(LOG.info("showing post ad container",s.postAdContainer),Zeus.dispatchEvent("showPostAdContainer",{pacId:s.postAdContainer}))},x=function(e,t,i){n.size(t,i)},B=function(t){t.c5="02",LOG.info("comscore",t),e.fireComscoreCall(t)},V=function(){var e=n.currentPlayer;if(e)if(e.hasStarted)e.paused&&q();else if(e.ended)T(e);else{if(LOG.debug("ZeusController::_play"),o.state=o.WAITING,"native"!==e.type&&"hls_xt"!==e.type||e.preload(),e.play(),1===e.videoPlayCount){var t=u.CurrentVideoConfig.advertising.cuepoints||[];if(t.length>0){var i=t.length+1;10>i&&(i="0"+i),B({c10:"[01-"+i+"]"})}else B({})}e.videoPlayCount++}},F=function(){var e=n.currentPlayer;e&&!e.isAd()&&(LOG.debug("pause"),o.state=o.PAUSED,e.pause())},H=function(){h.isMobile&&!r.hasBeenTouched&&(LOG.debug("touching ad video element"),r.videoElement.src="",r.videoElement.load(),r.hasBeenTouched=!0,window.MobileIMAPlayer&&window.MobileIMAPlayer.setUpIMAContainer());var e=n.currentPlayer;if(e){if(LOG.debug("togglePlayPause",e,"hasStarted",e.hasStarted,"ended",e.ended,"paused",e.paused),h.isMobile&&!e.hasBeenTouched)try{e.touch()}catch(t){}e.hasStarted?e.paused?q():F():e.isAd()?V():R()}},q=function(){n.currentPlayer&&(o.state=o.PLAYING,n.currentPlayer.resume())},z=function(){n.currentPlayer&&!n.currentPlayer.isAd()&&n.currentPlayer.stop()},j=function(e){n.currentPlayer&&n.currentPlayer.setVolume(e)},W=function(e){n.currentPlayer&&n.currentPlayer.mute(e)},Y=function(){n.toggleFullscreen()},Q=function(e){n.setFullscreen(e)};return{startUp:m,setSize:x,togglePlayPause:H,setFullscreen:Q,toggleFullscreen:Y,play:R,pause:F,stop:z,resume:q,setVolume:j,mute:W,seek:I,replay:H}}),define("module_factory",["zeus_constants"],function(e){var t=function(e){var t;return window.themeConfig&&(t=window.themeConfig.modules[e],t||window.themeConfig.addons&&window.themeConfig.addons[e]),t||e};return{buildTooltipManager:function(e){var i=t("tooltip_manager");require([i],function(t){var i=new t(window.ContentPlayer);i.init(),e.call(null,i)})},buildLoadingIndicator:function(e){var i=t("loading_indicator");require([i],function(t){var i=new t(window.ContentPlayer);i.init(),e.call(null,i)})},buildWatermark:function(e){var i=t("watermark");require([i],function(t){var i=new t(window.ContentPlayer);i.init(),e.call(null,i)})},buildContent:function(e){var i=t("content");require([i],function(t){var i=new t(window.ContentPlayer);i.init(),i.invalidate(),e.call(null,i)})},buildVolume:function(e){var i=t("volume");require([i],function(t){var i=new t(window.ContentPlayer);i.init(),i.invalidate(),e.call(null,i)})},buildControlBar:function(e){var i=t("controlbar");require([i],function(t){var i=new t(window.ContentPlayer);i.init(),e.call(null,i)})},buildTitleBar:function(e){var i=t("titlebar");require([i],function(t){var i=new t(window.ContentPlayer);i.init(),e.call(null,i)})},buildPrerollScreen:function(e){var i=t("preroll_screen");require([i],function(t){var i=new t(window.ContentPlayer);i.init(),e.call(null,i)})},buildScrubber:function(e){var i=t("scrubber");require([i],function(t){var i=new t(window.ContentPlayer);i.init(),e.call(null,i)})},buildPlaylist:function(e,i){var n=t("playlist");require([n],function(t){var n=new t(window.ContentPlayer);n.init(i),e.call(null,n)})},buildRelatedVideos:function(e,i){var n=t("related_videos");require([n],function(t){var n=new t(window.ContentPlayer);n.init(i),e.call(null,n)})},buildSubtitles:function(e,i){var n=t("subtitles");require([n],function(t){var n=new t(window.ContentPlayer);n.init(i),e.call(null,n)})},buildSharingMenu:function(e){var i=t("sharing");require([i],function(t){var i=new t(window.ContentPlayer);i.init(),e.call(null,i)})},buildAgeGate:function(e){var i=t("agegate");require([i],function(t){var i=new t(window.ContentPlayer);i.init(),e.call(null,i)})},buildAppearanceManager:function(e){var i=t("appearance_manager");require([i],function(t){var i=new t;i.init(),e.call(null,i)})}}}),define("zeus_view",["zeus_eventdispatcher","module_factory","zeus_utils"],function(e,t){"use strict";function i(t){var i=this;e.mixin(i),this.cssClass=t,this._isReady=!1,this.mouseInput=null,this._playlistMenu=null,this._volumeControl=null,this._subtitleMenu=null,this._sharingMenu=null,this._relatedVideoMenu=null,this._content=null,this._prerollScreen=null,this._uiModules=[],this._ageGateHandler=null,this._watermark=null,this._coreModules=["_content","_controlbar","_scrubber","_watermark"],s.isMobile||(this._coreModules.push("_volumeControl"),this._coreModules.push("mouseInput")),this._adOnly="undefined"!=typeof window.PlayerSettings.postAdContainer,this._defaultBoxModel=null,this.fullscreen=!1,this.currentPlayer=null,this._enableAgeGate=!1,window.addEventListener("resize",function(){var e=setTimeout(function(){clearTimeout(e),i.invalidate()},400)}),this.fixedControlbar=!1,this.fixedTitlebar=!1,this.fixedScrubber=!1,window.View=this}var n,a=ZeusUtils.dom,r=ZeusUtils.css,o=window.ZeusConstants,s=window.client;return i.prototype={},i.prototype.enableAgeGate=function(e){var i=this;PlayerSettings.preview&&(e?i.currentPlayer&&i.currentPlayer.playing&&i.currentPlayer.pause():PlayerState.state=PlayerState.START),e?(LOG.info("Enable age-gate"),i._ageGateHandler?(i._ageGateHandler.invalidate(),i._ageGateHandler.invalidateCookie()):t.buildAgeGate(function(e){i._ageGateHandler=e,i._ageGateHandler.addEventListener(o.UI.Event.AGE_GATE_PASSED,function(e){LOG.debug("AGE GATE PASSED"),i._dispatchEvent(e.type,e.data)}),i._ageGateHandler.addEventListener(o.UI.Event.AGE_GATE_FAILED,function(e){LOG.debug("AGE GATE FAILED"),i._dispatchEvent(e.type)}),i._ageGateHandler.invalidate(),i._ageGateHandler.invalidateCookie(),i._uiModules.push(i._ageGateHandler)})):(LOG.info("Disable age-gate"),i._ageGateHandler?i._ageGateHandler.close():a.hideElement(o.UI.AGE_GATE_LAYER),i._dispatchEvent(o.UI.Event.AGE_GATE_PASSED))},i.prototype.buildCaptionMenu=function(e){var i=this,n=i._subtitleMenu;LOG.info("build caption menu"),a.getUI(o.UI.SUBTITLE_MENU)&&!s.system.iphone&&e&&e.length>0?(r.removeClass(Skin,"bolt-subtitle-disabled"),r.addClass(Skin,"bolt-subtitle-enabled"),n?n.init(e):(LOG.info("build caption menu"),t.buildSubtitles(function(e){n=e,i._uiModules.push(n),i._subtitleMenu=n,n.init()},e))):(r.removeClass(Skin,"bolt-subtitle-enabled"),r.addClass(Skin,"bolt-subtitle-disabled"))},i.prototype.buildPlaylistMenu=function(e){var i=this,n=o.UI;e&&e.length>0&&a.getUI(n.PLAYLIST)&&(i._playlistMenu?i._playlistMenu.init(e):t.buildPlaylist(function(e){i._playlistMenu=e,i._playlistMenu.addEventListener(o.UI.Event.PLAYLIST_ITEM_SELECTED,function(e){LOG.debug(e),i._dispatchEvent(e.type,e.data)}),i._uiModules.push(i._playlistMenu)},e))},i.prototype.setRelatedVideos=function(e){var i=this;e?i._relatedVideoMenu?(i._relatedVideoMenu.init(e),i._relatedVideoMenu.open()):t.buildRelatedVideos(function(e){i._relatedVideoMenu=e,i._relatedVideoMenu.addEventListener(o.UI.Event.RELATED_VIDEO_SELECTED,function(e){i._dispatchEvent(e.type,e.data)}),i._relatedVideoMenu.open(),i._uiModules.push(i._relatedVideoMenu)},e):i._relatedVideoMenu&&i._relatedVideoMenu.close()},i.prototype.enableControls=function(e){},i.prototype.toggleFullscreen=function(){LOG.debug("toggle fullscreen",this.fullscreen),this.setFullscreen(!this.fullscreen)},i.prototype.setFullscreen=function(e){LOG.debug("set fullscreen",e);var t=this;return PlayerSettings.fullscreen===!1?void LOG.debug("ZeusView:: Fullscreen is not allowed by the publisher"):void t._dispatchEvent(o.UI.Event.REQUEST_FULLSCREEN_CHANGE,!t.fullscreen)},i.prototype.isHD=function(e){e?(r.removeClass(Skin,"bolt-sd-on"),r.addClass(Skin,"bolt-hd-on")):(r.removeClass(Skin,"bolt-hd-on"),r.addClass(Skin,"bolt-sd-on"))},i.prototype.drawCuepoints=function(){var e=ContentPlayer.adsCuepoints,t=o.UI,i=a.getUI(t.AD_CUEPOINTS_CONTAINER);if(i){for(;a.getUI(t.CUEPOINT);)i.removeChild(a.getUI(t.CUEPOINT));if(ContentPlayer.duration<=0)return void LOG.debug("player duration <0, cannot draw cuepoints",e);PlayerSettings.freePlayer&&ContentPlayer.adsCuepoints&&(e=ZeusUtils.getValidCuepoints(ContentPlayer.adsCuepoints,ContentPlayer.duration)),LOG.debug("draw valid cuepoints",e);for(var n=0;n<e.length;n++){var r=e[n],s=100*r/ContentPlayer.duration+"%";LOG.debug("drawCuepoints",ContentPlayer.duration,r,s);var d='<svg data-bolt-ui="cuepoint" class="bolt-foreground bolt-cuepoint  cp_'+r+'" style="left:'+s+'" width="512px" height="512px" viewbox="0 0 512 512" xml:space="preserve"><circle cx="256" cy="256" r="256" /></svg>';i.insertAdjacentHTML("beforeend",d)}}},i.prototype.setCurrentPlayer=function(e){var t=o.UI,i=this;return e===i.currentPlayer?void LOG.debug("setCurrentPlayer:: not a new player. return"):(LOG.debug("setCurrentPlayer ",e),i.currentPlayer&&(i.currentPlayer.removeEventListener(o.Player.Event.CANPLAY,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Player.Event.CONTENT_CHANGED,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Player.Event.QUALITY_CHANGED,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Player.Event.CONFIG_CHANGED,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.PLAY,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.PLAYING,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.DURATION_CHANGE,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.ENDED,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.PAUSED,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.RESUME,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.STOPPED,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.TIME_UPDATE,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.LOAD_PROGRESS,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.WAITING,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.LOAD_START,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.LOADED,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.START_TIME_CHANGED,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.NOT_FOUND,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.FIRSTQUARTILE,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.MIDPOINT,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.THIRDQUARTILE,i._handlePlayerEvents),i.currentPlayer.removeEventListener(o.Media.Event.MUTED,i._onMuted),i.currentPlayer.removeEventListener(o.Media.Event.UNMUTED,i._onUnmuted),i.currentPlayer.removeEventListener(o.Media.Event.VOLUME_CHANGED,i._onVolumeChanged),i.currentPlayer.removeEventListener(o.Ad.Event.CUEPOINT,i._handlePlayerEvents)),i._handlePlayerEvents=i._handlePlayerEvents.bind(this),e.addEventListener(o.Player.Event.CANPLAY,i._handlePlayerEvents),e.addEventListener(o.Player.Event.CONTENT_CHANGED,i._handlePlayerEvents),e.addEventListener(o.Media.Event.PLAY,i._handlePlayerEvents),e.addEventListener(o.Media.Event.PLAYING,i._handlePlayerEvents),e.addEventListener(o.Media.Event.DURATION_CHANGE,i._handlePlayerEvents),e.addEventListener(o.Media.Event.ENDED,i._handlePlayerEvents),e.addEventListener(o.Media.Event.PAUSED,i._handlePlayerEvents),e.addEventListener(o.Media.Event.RESUME,i._handlePlayerEvents),e.addEventListener(o.Media.Event.STOPPED,i._handlePlayerEvents),e.addEventListener(o.Media.Event.TIME_UPDATE,i._handlePlayerEvents),e.addEventListener(o.Media.Event.LOAD_PROGRESS,i._handlePlayerEvents),e.addEventListener(o.Media.Event.WAITING,i._handlePlayerEvents),e.addEventListener(o.Media.Event.LOAD_START,i._handlePlayerEvents),e.addEventListener(o.Media.Event.LOADED,i._handlePlayerEvents),i._onMuted=i._onMuted.bind(this),e.addEventListener(o.Media.Event.MUTED,i._onMuted),i._onUnmuted=i._onUnmuted.bind(this),e.addEventListener(o.Media.Event.UNMUTED,i._onUnmuted),i._onVolumeChanged=i._onVolumeChanged.bind(this),e.addEventListener(o.Media.Event.VOLUME_CHANGED,i._onVolumeChanged),e.isAd()?(r.addClass(Skin,"bolt-linear-ad-on"),r.removeClass(Skin,"bolt-content-on"),e.addEventListener(o.Media.Event.FIRSTQUARTILE,i._handlePlayerEvents),e.addEventListener(o.Media.Event.MIDPOINT,i._handlePlayerEvents),e.addEventListener(o.Media.Event.THIRDQUARTILE,i._handlePlayerEvents),a.hideElement(t.TITLE_BAR),a.hideElement(t.SUBTITLE_TEXT),BoltAdManager.type==o.Ad.Type.STATIC_IMAGE&&BoltAdManager.type==o.Ad.Type.THREE_TWO_FIFTY||s.isMobile||i._volumeControl&&i._volumeControl.setPlayer(e),BoltAdManager.type===o.Ad.Type.FLASH_VPAID||BoltAdManager.type===o.Ad.Type.STATIC_IMAGE||BoltAdManager.type===o.Ad.Type.THREE_TWO_FIFTY?i.fixedControlbar=!0:i.fixedControlbar=!1):i._adOnly||(r.addClass(Skin,"bolt-content-on"),r.removeClass(Skin,"bolt-linear-ad-on"),e.addEventListener(o.Ad.Event.CUEPOINT,i._handlePlayerEvents),e.addEventListener(o.Player.Event.QUALITY_CHANGED,i._handlePlayerEvents),e.addEventListener(o.Player.Event.CONFIG_CHANGED,i._handlePlayerEvents),e.addEventListener(o.Media.Event.NOT_FOUND,i._handlePlayerEvents),e.addEventListener(o.Media.Event.START_TIME_CHANGED,i._handlePlayerEvents),a.hideElement(t.AD_CONTAINER),i.buildCaptionMenu(window.CurrentVideoConfig.content.captions),s.isMobile||i._volumeControl&&i._volumeControl.setPlayer(e),i.drawCuepoints(),i.fixedControlbar=PlayerSettings.appearance.controlbar.autohide===!1),i._showWatermark(!e.isAd()),s.isMobile||(e.setVolume(PlayerSettings.volume),e.mute(PlayerSettings.automute)),i.currentPlayer=e,void(i._isReady?(i._dispatchEvent(o.UI.Event.PLAYER_CHANGED),i.invalidate()):i._waitForCoreModules()))},i.prototype._waitForCoreModules=function(){var e=this;LOG.debug("CORE MODULES",e._coreModules),n||(n=setInterval(function(){if(e._coreModules.every(function(t){return LOG.debug("WAITING FOR MODULE",t),!!e[t]})){clearInterval(n),e._isReady=!0,LOG.info("view is ready"),window.Skin.style.visibility="visible",LOG.info("update appearance manager"),e.appearanceManager.updateColors(),e.appearanceManager.updateTextColors(),LOG.info("update modules appearance");for(var t=0;t<e._uiModules.length;t++){var i=e._uiModules[t];i.updateAppearance()}e._dispatchEvent(o.UI.Event.PLAYER_CHANGED),e.invalidate(),e._dispatchEvent(o.Player.Event.VIEW_READY),e.enableAgeGate(e._enableAgeGate)}},100))},i.prototype._handlePlayerEvents=function(e){var t=this,i=e.target,n=o.UI;switch(e.type){case o.Player.Event.CONFIG_CHANGED:var d=window.CurrentVideoConfig;LOG.debug("View::Player config changed",d,i.config),d.settings.minAge>0?(LOG.debug("AGE GATED!",d),t.enableAgeGate(!0)):t.enableAgeGate(!1),t.buildCaptionMenu(d.content.captions),t._setTooltipText(a.getUI(n.PLAY_PAUSE_BTN),"Play"),Object.keys(d.content.media).length>1?(r.removeClass(Skin,"bolt-hd-disabled"),r.addClass(Skin,"bolt-hd-enabled")):(LOG.debug("showOrHideHDButton hide settings button"),r.removeClass(Skin,"bolt-hd-enabled"),r.addClass(Skin,"bolt-hd-disabled")),a.hideElement(n.ERROR_CONTAINER);break;case o.Media.Event.PLAY:LOG.debug("View::handlePlayerEvent",e.type,i.getSource());break;case o.Media.Event.PLAYING:LOG.debug("View::handlePlayerEvent",e.type,i.getSource()),i.isAd()||t._setTooltipText(a.getUI(n.PLAY_PAUSE_BTN),"Pause");break;case o.Media.Event.PAUSED:LOG.debug("View::PAUSED",i.getSource()),t._setTooltipText(a.getUI(n.PLAY_PAUSE_BTN),"Play");break;case o.Media.Event.RESUME:LOG.debug("View::RESUME",i.getSource()),i.isAd()||s.isMobile&&ContentPlayer.show(!0);break;case o.Media.Event.STOPPED:LOG.debug("View::STOPPED",i.getSource()),t._setTooltipText(a.getUI(n.PLAY_PAUSE_BTN),"Play");break;case o.Media.Event.DURATION_CHANGE:LOG.debug("View::duration change",i.duration,i.getSource());break;case o.Media.Event.WAITING:LOG.debug("View::WAITING",i.getSource());break;case o.Media.Event.LOAD_PROGRESS:break;case o.Media.Event.TIME_UPDATE:break;case o.Media.Event.ENDED:i.isAd()?LOG.info("VIEW::ENDED Ad"):LOG.info("VIEW::ENDED",i.getSource()),t._setTooltipText(a.getUI(n.PLAY_PAUSE_BTN),"Replay");break;case o.Media.Event.START_TIME_CHANGED:LOG.debug("View::START_TIME_CHANGED",i.getSource());break;case o.Player.Event.CONTENT_CHANGED:break;case o.Media.Event.NOT_FOUND:break;case o.Media.Event.NOT_SUPPORTED:i.isAd()||t.showError("Flash Player 11+ is required to view this content.")}t._dispatchEvent(e)},i.prototype.showError=function(e){a.showElement(o.UI.ERROR_CONTAINER);var t=a.getUI(o.UI.ERROR_CONTAINER);if(t){var i=t.firstElementChild;i.textContent=e}a.hideElement(o.UI.LOADING_INDICATOR)},i.prototype.init=function(e){var i=o.UI,n=this;LOG.debug("VIEW::init",window.ContentPlayer,"ageGateEnabled",e);var d=window.Skin;if(d.style.width="100%",d.style.height="100%",n.cssClass&&r.addClass(window.Skin,n.cssClass),r.setUAClass(),r.setFeatureClass(),n._coreModules.push("appearanceManager"),t.buildAppearanceManager(function(e){n.appearanceManager=e}),PlayerSettings.branding===!1&&a.removeElement(i.BRANDING),PlayerSettings.bigButton===!1?a.removeElement(o.UI.BIG_PLAY):a.getUI(i.BIG_PLAY)&&(n._coreModules.push("_prerollScreen"),n._buildPrerollScreen()),PlayerSettings.fullscreen===!1&&(LOG.info("Fullscreen disabled"),a.removeElement(i.FULLSCREEN_BTN)),n._adOnly)a.removeElement(i.SHARING_BTN),a.removeElement(i.PLAYLIST_BTN),a.removeElement(i.SETTINGS_BTN),a.removeElement(i.SUBTITLE_BTN),a.removeElement(i.TITLE_BAR),n.fixedControlbar=!0,r.addClass(window.Skin,"bolt-linear-ad-on");else{var l=a.getUI(i.TITLE_TEXT);PlayerSettings.title===!1?l&&l.parentNode.removeChild(l):a.getUI(i.TITLE_BAR)&&(n._coreModules.push("_titleBar"),n._buildTitleBar()),PlayerSettings.share===!1?(LOG.info("Sharing disabled"),a.removeElement(i.SHARING_BTN)):n._buildSharingMenu(),1===Object.keys(window.CurrentVideoConfig.content.media).length&&(PlayerSettings.defaultHd&&LOG.warn("The video has only SD media, defaultHd setting is omitted"),a.hideElement(i.SETTINGS_BTN)),window.Playlist?n.buildPlaylistMenu(window.Playlist):a.removeElement(o.UI.PLAYLIST_BTN),LOG.debug("agegate",e),n._enableAgeGate=e,n.isHD(window.CurrentVideoConfig.settings.defaultHd===!0),n.fixedControlbar=PlayerSettings.appearance.controlbar.autohide===!1,LOG.info("Fixed controlbar",n.fixedControlbar)}n._coreModules.push("_loadingIndicator"),t.buildLoadingIndicator(function(e){n._loadingIndicator=e,n._uiModules.push(e)}),s.isMobile?r.addClass(document.body,"bolt-touch-input"):(n._buildVolumeControl(),require(["zeus_mouseinput"],function(e){LOG.debug("LOAD MOUSE INPUT"),n.mouseInput=new e,n.mouseInput.on(o.UI.Event.MOUSE_OUT,function(){n.onMouseOut(window.Skin)}),n.mouseInput.on(o.UI.Event.MOUSE_OVER,function(){n.onMouseOver(window.Skin)}),LOG.info("mouse input ready")})),n._defaultBoxModel={width:d.style.width,height:d.style.height,marginTop:d.style.marginTop,marginLeft:d.style.marginLeft,marginBottom:d.style.marginBottom,marginRight:d.style.marginRight,paddingTop:d.style.paddingTop,paddingLeft:d.style.paddingLeft,paddingBottom:d.style.paddingBottom,paddingRight:d.style.paddingRight,zIndex:d.style.zIndex,position:d.style.position,top:d.style.top,right:d.style.right,bottom:d.style.bottom,left:d.style.left},s.isMobile||n._initTooltips(),n._setTooltipText(a.getUI(i.PLAY_PAUSE_BTN),"Play"),n._buildContent(),n._buildControlBar(),n._buildScrubber(),n._buildWatermark(),n.setCurrentPlayer(ContentPlayer)},i.prototype._buildContent=function(){var e=this;t.buildContent(function(t){e._uiModules.push(t),e._content=t,LOG.info("content ready",e._content)})},i.prototype._buildVolumeControl=function(){var e=this;!e._volumeControl&&a.getUI(o.UI.VOLUME_CONTROL)&&t.buildVolume(function(t){e._uiModules.push(t),e._volumeControl=t,e._volumeControl.addEventListener(o.VALUE_CHANGED,function(t){e._dispatchEvent(o.UI.Event.CHANGE_VOLUME,t.data)}),LOG.info("Volume ready")})},i.prototype._buildScrubber=function(){var e=this;e._scrubber||t.buildScrubber(function(t){e._uiModules.push(t),e._scrubber=t,e._scrubber.on(o.UI.Event.SEEK,function(t){e._dispatchEvent(t)}),LOG.info("scrubber ready")})},i.prototype._buildControlBar=function(){var e=this;e._controlbar||t.buildControlBar(function(t){e._uiModules.push(t),e._controlbar=t,LOG.info("Controlbar ready")})},i.prototype._buildTitleBar=function(){var e=this;e._titleBar||t.buildTitleBar(function(t){e._uiModules.push(t),e._titleBar=t,LOG.info("Titlebar ready")})},i.prototype._buildPrerollScreen=function(){var e=this;e._prerollScreen||t.buildPrerollScreen(function(t){e._uiModules.push(t),e._prerollScreen=t,LOG.info("Preroll screen ready")})},i.prototype._buildSharingMenu=function(){var e=this;e._sharingMenu||t.buildSharingMenu(function(t){e._uiModules.push(t),e._sharingMenu=t,LOG.info("Sharing menu ready")})},i.prototype.hideTooltip=function(){this._tooltipManager&&this._tooltipManager.close()},i.prototype._setTooltipText=function(e,t){this._tooltipManager&&this._tooltipManager.setLabel(e,t)},i.prototype._isEnabled=function(e){return!r.hasClass(e,o.UI.UI_DISABLED_CLASS)},i.prototype._buildWatermark=function(){var e=this;t.buildWatermark(function(t){e._watermark=t,e._uiModules.push(e._watermark)})},i.prototype._showWatermark=function(e){this._watermark&&(e?this._watermark.open():this._watermark.close())},i.prototype._getModuleForElement=function(e){for(var t=this,i=0;i<t._uiModules.length;i++){var n=t._uiModules[i];if(n.UI===e)return n}return null},i.prototype.size=function(e,t){var i=this,n=e,a=t;-1==e.indexOf("%")&&-1==e.indexOf("px")&&(n=e+"px"),-1==t.indexOf("%")&&-1==t.indexOf("px")&&(a=t+"px"),i._defaultBoxModel.width=n,i._defaultBoxModel.height=a,i.invalidate()},i.prototype.onMouseOver=function(e){r.removeClass(Skin,"bolt-mouse-out"),r.addClass(Skin,"bolt-mouse-over"),this._dispatchEvent(o.UI.Event.MOUSE_OVER,null,e)},i.prototype.onMouseOut=function(e){r.removeClass(Skin,"bolt-mouse-over"),r.addClass(Skin,"bolt-mouse-out"),this._dispatchEvent(o.UI.Event.MOUSE_OUT,null,e)},i.prototype._initTooltips=function(){var e=this;t.buildTooltipManager(function(t){e._uiModules.push(t),e._tooltipManager=t})},i.prototype.invalidate=function(e){var t=this,i=(o.UI,t._uiModules);e&&(e.fullscreen!=t.fullscreen&&(t.fullscreen=e.fullscreen,t.mouseInput&&t.mouseInput.setFullscreen(t.fullscreen),LOG.debug("invalidate, fullscreen changed to ",t.fullscreen),t._controlbar.open()),e.customizer&&t.appearanceManager.update(e.customizer)),t.fixedScrubber?r.addClass(Skin,"bolt-static-scrubber"):r.removeClass(Skin,"bolt-static-scrubber"),t._scrubber.fixedValues(t.fixedScrubber),t._controlbar.allowAutoHide(!t.fixedControlbar),t._titleBar&&(t._titleBar.allowAutoHide(!t.fixedTitlebar),t.fixedTitlebar?(t._titleBar.open(),r.addClass(Skin,"bolt-static-title-bar")):r.removeClass(Skin,"bolt-static-title-bar")),t.fixedControlbar?(t._controlbar.open(),r.addClass(Skin,"bolt-static-control-bar")):r.removeClass(Skin,"bolt-static-control-bar"),t.currentPlayer.setFullscreen(t.fullscreen);for(var n=0;n<i.length;n++){var a=i[n];a.invalidate()}t._isReady===!0&&(s.browser.ie>0?(t._controlbar.open(),t._titleBar&&t._titleBar.open()):window.Skin.style.visibility="visible"),r.setSizeClass(window.Skin.clientWidth)},i.prototype._onVolumeChanged=function(e){var t=this;LOG.info("volume changed",e),"undefined"!=typeof e.data?t._dispatchEvent(e.type,e.data):LOG.warn("No volume data")},i.prototype._onMuted=function(e){var t=this;r.removeClass(Skin,"bolt-automute-disabled"),r.addClass(Skin,"bolt-automute-enabled"),t._dispatchEvent(e.type)},i.prototype._onUnmuted=function(e){var t=this;r.removeClass(Skin,"bolt-automute-enabled"),r.addClass(Skin,"bolt-automute-disabled"),t._dispatchEvent(e.type)},i.prototype.getAppearanceSettings=function(){this.appearanceManager.getInitialSettings()},i}),define("playerstate",["stapes","zeus_utils"],function(e,t){function i(){this._state=null,this._previousState=null,e.mixinEvents(this)}return i.prototype={STATE_CHANGED:"stateChanged",AGE_GATE:"age-gate",START:"start",WAITING:"waiting",PLAYING:"playing",PAUSED:"paused",ENDED:"ended",ERROR:"error",RELATED_VIDEOS:"related-videos",get previousState(){return this._previousState},get state(){return this._state},set state(e){var i="bolt-state-";e!=this._state&&(e===this.WAITING&&this._state===this.PLAYING||t.css.removeClass(window.Skin,i+this._state),this._previousState=this._state,this._state=e,LOG.info("Player state:",this._state),t.css.addClass(window.Skin,i+e),this.emit(this.STATE_CHANGED))}},i}),define("ad_session",["zeus_eventdispatcher","zeus_constants"],function(e,t){var i=function(){e.mixin(this),this._startData=null,this._started=!1,this._completed=!1,this._failed=!1,this._aborted=!1,this._adloaded=!1};return i.prototype={reset:function(){
LOG.info("AdSession reset"),this._startData=null,this._started=!1,this._completed=!1,this._failed=!1,this._aborted=!1,this._adloaded=!1},getElapsedSecondsSinceStart:function(e){try{var t=(e.getTime()-this._startData.start_ts.getTime())/1e3;return parseFloat(t.toFixed(1))}catch(i){return-1}},start:function(e){var i=this;i.reset(),i._started=!0;var n=window.BoltAdManager;i._startData={timing:n.timing,publisher_id:CurrentVideoConfig.publisherId||-1,video_id:CurrentVideoConfig.content.videoId||-1,player_width:parseFloat(Skin.clientWidth.toFixed(2)),player_height:parseFloat(Skin.clientHeight.toFixed(2)),fullscreen:View.fullscreen,start_ts:new Date,cuepoint:n.cuepoint,server_type:n.selectedServer.type,tag_type:n.tagType,backfilling:e},this._dispatchEvent(t.Ad.Event.SESSION_START,this._startData)},adLoaded:function(){var e=this;if(this._started&&!this._adloaded){this._adloaded=!0;var i=new Date,n={timestamp:i,et_session_start:e.getElapsedSecondsSinceStart(i)};this._dispatchEvent(t.Ad.Event.SESSION_AD_LOADED,n)}},abort:function(){var e=this;if(this._started&&!this._aborted){this._aborted=!0;var i=new Date,n={timestamp:i,et_session_start:e.getElapsedSecondsSinceStart(i)};this._dispatchEvent(t.Ad.Event.SESSION_ABORT,n)}},fail:function(){var e=this;if(this._started&&!this._failed){this._failed=!0;var i=new Date,n={timestamp:i,et_session_start:e.getElapsedSecondsSinceStart(i)};this._dispatchEvent(t.Ad.Event.SESSION_FAIL,n)}},complete:function(){var e=this;if(this._started&&!this._completed){this._completed=!0;var i=new Date,n={timestamp:i,et_session_start:e.getElapsedSecondsSinceStart(i)};this._dispatchEvent(t.Ad.Event.SESSION_END,n)}}},i}),define("ad_request",["zeus_eventdispatcher","zeus_constants"],function(e,t){var i=function(){e.mixin(this),this.failed=!1,this.data={}};return i.prototype={setMedia:function(e,t){this.data.media_src=e,this.data.mime_type=t},start:function(e,i,n){this.reset(),this.data={tag:e,daisy_chain_count:i,start_ts:new Date,amazon_bid:n&&"amazon"===n.source?n.status:null},this._dispatchEvent(t.Ad.Event.REQUEST_START,this.data)},getElapsedSecondsSinceStart:function(e){try{var t=(e.getTime()-this.data.start_ts.getTime())/1e3;return parseFloat(t.toFixed(1))}catch(i){return-1}},success:function(){var e=this,i=new Date,n={timestamp:i,media_src:e.data.media_src,mime_type:e.data.mime_type,ad_type:e.data.ad_type,network:e.data.network,campaign_id:e.data.campaign_id,amazon_bid:e.data.amazon_bid,et_request_start:e.getElapsedSecondsSinceStart(i),et_session_start:window.AdSession.getElapsedSecondsSinceStart(i)};this._dispatchEvent(t.Ad.Event.REQUEST_SUCCESS,n)},fail:function(e){var i=this,n=new Date;if(!i.failed){i.failed=!0;var a={timestamp:n,media_src:i.data.media_src,mime_type:i.data.mime_type,ad_type:i.data.ad_type,info:e,network:i.data.network,campaign_id:i.data.campaign_id,amazon_bid:i.data.amazon_bid,et_request_start:i.getElapsedSecondsSinceStart(n),et_session_start:window.AdSession.getElapsedSecondsSinceStart(n)};i._dispatchEvent(t.Ad.Event.REQUEST_FAIL,a)}},abort:function(){var e=this,i=new Date,n={timestamp:i,media_src:e.data.media_src,mime_type:e.data.mime_type,ad_type:e.data.ad_type,network:e.data.network,campaign_id:e.data.campaign_id,amazon_bid:e.data.amazon_bid,et_request_start:e.getElapsedSecondsSinceStart(i),et_session_start:window.AdSession.getElapsedSecondsSinceStart(i)};e._dispatchEvent(t.Ad.Event.REQUEST_ABORT,n)},reset:function(){this.failed=!1,this.data={}},get adType(){return this.data.ad_type},set adType(e){this.data.ad_type=e},get network(){return this.data.network},set network(e){this.data.network=e},get campaignId(){return this.data.campaign_id},set campaignId(e){try{this.data.campaign_id=parseInt(e)}catch(t){}LOG.info("CAMPAIGN ID",this.data.campaign_id)}},i}),define("ad_tracking",["zeus_eventdispatcher","zeus_constants"],function(e,t){var i=function(){e.mixin(this),this.data={}};return i.prototype={status:function(e,i,n){"breakEnd"===e?this.data.event="complete":"breakStart"===e?this.data.event="start":this.data.event=e,this.data.timestamp=new Date,this.data.status=n?"success":"fail",this.data.url=i,this._dispatchEvent(t.Ad.Event.TRACKING,this.data)},reset:function(){LOG.info("AdTracking reset"),this.data={}}},i}),define("ad_blocked",["zeus_eventdispatcher","zeus_constants"],function(e,t){var i=function(){e.mixin(this)};return i.prototype={track:function(e){var i=this._getTag(e);if(i){var n={publisher_id:CurrentVideoConfig.publisherId,video_id:CurrentVideoConfig.content.videoId,timing:e,tag:i.url,server_type:i.type,domain:window.site.hostname,page_url:window.site.href};LOG.warn("Missed ad opportunity because of ad blocker",n),this._dispatchEvent(t.Ad.Event.SESSION_BLOCKED,n)}},_getTag:function(e){for(var t,i,n,a,r,o=window.site,s=window.client,d=CurrentVideoConfig.advertising,l=0;l<d.servers.length;l++){var u=d.servers[l];if("adtech-intergi"!==u.type){i=u;break}i=u}try{for(var c in i.tags){if(c===o.hostname){t=c;break}if(c===o.tld||c==="*."+o.tld){t=c;break}}t||(t="default"),n=i.tags[t],s.hasFlash&&n.standard?a="overlay"===e?n.standard.overlay:n.standard[e]:n.html5&&(s.isMobile&&n.html5.mobile?a="overlay"===e?n.html5.mobile.overlay:n.html5.mobile[e]:n.html5.desktop&&(a="overlay"===e?n.html5.desktop.overlay:n.html5.desktop[e])),LOG.info("Blocked tag",a,n),r={url:a,type:i.type}}catch(h){}return r}},i}),define("ss_tracker",["zeus_eventdispatcher","zeus_constants"],function(e,t){var i=function(){e.mixin(this),this.videoId=null,this.publisherId=null,this.tag=null,this.timing=null,this.started=!1,this.aborted=!1,this.loaded=!1,this.failed=!1,this.data={}};return i.prototype={start:function(e){return e.timing&&e.tag&&e.serverType?this.started?void LOG.warn("SSTRacker has already been started"):(this.started=!0,this.tag=e.tag,this.data={timing:e.timing,tag:e.tag,vmap:e.vmap,publisher_id:CurrentVideoConfig.publisherId||-1,video_id:CurrentVideoConfig.content.videoId||-1,start_ts:new Date,server_type:e.serverType},void this._dispatchEvent(t.Ad.Event.SS_REQUESTED,this.data)):void LOG.error("Invalid SS tracker data")},fail:function(){return this.tag?this.started?(this.failed=!0,LOG.info("Self-service Tracker event: failed"),void this._dispatchEvent(t.Ad.Event.SS_FAILED,this.data)):void LOG.error("Self-service Tracker has not started"):void LOG.warn("No self-service tag")},success:function(){return this.tag?this.started?(this.loaded=!0,LOG.info("Self-service Tracker event: success"),void this._dispatchEvent(t.Ad.Event.SS_LOADED,this.data)):void LOG.error("Self-service Tracker has not started"):void LOG.warn("No self-service tag")},backfill:function(e){return this.tag?this.started?this.failed?(this.data.backfiller_tag=e,void this._dispatchEvent(t.Ad.Event.SS_BACKFILL_REQUESTED,this.data)):void LOG.error("Self-service Tracker did not fail"):void LOG.error("Self-service Tracker has not started"):void LOG.warn("No self-service tag")},backfillSuccess:function(e){return this.tag?this.started?this.failed?(this.data.backfiller_tag=e,void this._dispatchEvent(t.Ad.Event.SS_BACKFILL_SUCCESS,this.data)):void LOG.error("Self-service Tracker did not fail"):void LOG.error("Self-service Tracker has not started"):void LOG.warn("No self-service tag")},backfillFail:function(e){return this.tag?this.started?this.failed?(this.data.backfiller_tag=e,void this._dispatchEvent(t.Ad.Event.SS_BACKFILL_FAILED,this.data)):void LOG.error("Self-service Tracker did not fail"):void LOG.error("Self-service Tracker has not started"):void LOG.warn("No self-service tag")},reset:function(){LOG.debug("Self-service Tracker reset"),this.tag=null,this.timing=null,this.started=!1,this.aborted=!1,this.loaded=!1,this.failed=!1,this.data={}}},i});var zeusBaseUrl=window.zeusBaseUrl,client=window.client;require.config({waitSeconds:600,paths:{swfobject:"iframe/libs/swfobject",dragdealer:"iframe/libs/dragdealer",webvttparser:"iframe/libs/webvttparser",vastvmap:"iframe/libs/vastvmap",hammer:"iframe/libs/hammer",stapes:"iframe/libs/stapes",hls_lib:"iframe/libs/hls",ad_blocked:"iframe/tracker/ad_blocked",ad_session:"iframe/tracker/ad_session",ad_request:"iframe/tracker/ad_request",ad_tracking:"iframe/tracker/ad_tracking",ss_tracker:"iframe/tracker/ss_tracker",zeus_ad_manager:"iframe/ad/zeus_ad_manager",zeus_ima_shim:"iframe/ad/zeus_ima_shim",zeus_googleFlashPlayer:"iframe/ad/zeus_googleFlashPlayer",googleAdsPlayer:"iframe/ad/googleAdsPlayer",zeus_vpaidshim:"iframe/ad/zeus_vpaidshim",staticImageAdsPlayer:"iframe/ad/staticImageAdsPlayer",vastAdsPlayer:"iframe/ad/vastAdsPlayer",base_ad_player:"iframe/ad/base_ad_player",coull_html_overlay:"iframe/ad/coull_html_overlay",overlay_ad_cue_finder:"iframe/ad/overlay_ad_cue_finder",zeus_liverail_jsvpaid:"iframe/ad/zeus_liverail_jsvpaid",yume_jsvpaid:"iframe/ad/yume_jsvpaid",linear_jsvpaid:"iframe/ad/linear_jsvpaid",threeTwoFiftyAdsPlayer:"iframe/ad/threeTwoFiftyAdsPlayer",google_html_overlay:"iframe/ad/google_html_overlay",aol_jsvpaid:"iframe/ad/aol_jsvpaid",spotx_jsvpaid:"iframe/ad/spotx_jsvpaid",adap_jsvpaid:"iframe/ad/adap_jsvpaid",vmap_adapter:"iframe/ad/vmap_adapter",zeus_controller:"iframe/zeus_controller",zeus_view:"iframe/zeus_view",zeus_mouseinput:"iframe/zeus_mouseinput",zeus_cors_shim:"iframe/zeus_cors_shim",comscore:"iframe/comscore",zeus_utils:"iframe/zeus_utils",playerlogger:"iframe/playerlogger",zeus_constants:"iframe/zeus_constants",playerstate:"iframe/zeus_player_state",zeus_eventdispatcher:"iframe/zeus_eventdispatcher",module_factory:"iframe/module_factory",base_ui_module:"iframe/ui/base_ui_module",base_controlbar:"iframe/ui/base_controlbar",base_playlist:"iframe/ui/base_playlist",base_appearance_manager:"iframe/ui/base_appearance_manager",base_scrubber:"iframe/ui/base_scrubber",zeus_flashshim:"iframe/player/zeus_flashshim",zeus_video:"iframe/player/zeus_video",zeus_mobile_video:"iframe/player/zeus_mobile_video",zeus_video_base:"iframe/player/zeus_video_base",zeus_android_webkit_video:"iframe/player/zeus_android_webkit_video",ios_video:"iframe/player/ios_video",controlbar:"iframe/ui/zeus_controlbar",preroll_screen:"iframe/ui/zeus_preroll_screen",titlebar:"iframe/ui/zeus_titlebar",scrubber:"iframe/ui/zeus_scrubber",content:"iframe/ui/zeus_content",loading_indicator:"iframe/ui/zeus_loading_indicator",playlist:"iframe/ui/zeus_playlist_ui",sharing:"iframe/ui/zeus_sharing_ui",subtitles:"iframe/ui/zeus_subtitle_ui",volume:"iframe/ui/zeus_volume_ui",agegate:"iframe/ui/zeus_agegate_ui",tooltip_manager:"iframe/ui/zeus_tooltip_ui",related_videos:"iframe/ui/zeus_related_videos_ui",watermark:"iframe/ui/zeus_watermark_ui",appearance_manager:"iframe/ui/zeus_appearance_manager",flash_detector:"iframe/flash_detector"},map:{"*":{css:"iframe/libs/css"}}}),require(["zeus_constants","zeus_utils","zeus_ad_manager","zeus_controller","zeus_view","playerstate","stapes","ad_session","ad_request","ad_tracking","ad_blocked","ss_tracker"],function(e,t,i,n,a,r,o,s,d,l,u,c){window.PlayerState=new r,window.Stapes=o,LOG.debug("CLIENT IS MOBILE ",client.isMobile);var h=n,p=!1,f=!1,v=zeusBaseUrl,g=v+"/swf/zeusplayer-9298ef2f7b.swf",m=zeusBaseUrl+"/skins/default-f8fdbe93a4.html",E=zeusBaseUrl+"/skins/default-470346a621.css",y=function(t){v=t,e.Player.SWFROOT=v+"/swf",g=v+"/swf/zeusplayer-9298ef2f7b.swf",m=v+"/skins/default-f8fdbe93a4.html",E=v+"/skins/default-470346a621.css"},_=function(){return v},b=function(){function e(e){if("undefined"==typeof e.disabled)A();else{var t=document.body;if("undefined"!=typeof e.disabled.image&&(t.style.backgroundImage="url('"+e.disabled.image+"')"),"undefined"!=typeof e.disabled.message){var i=document.createElement("div");i.innerHTML=e.disabled.message,i.style.fontSize="24px",i.style.backgroundColor="#ffffff",i.style.border="1px solid #000000",i.style.padding="5px",i.style.position="relative",i.style.top="40%",i.style.marginLeft="auto",i.style.marginRight="auto",i.style.textAlign="center",t.appendChild(i)}}}f||(f=!0,PlayerSettings.postAdContainer&&(PlayerSettings.autoplay=!0),CurrentVideoConfig.settings=t.mergeSettings(CurrentVideoConfig.settings,PlayerSettings,PlayerSettings.freePlayer),LOG.info("Player settings",PlayerSettings),client.isMobile?e(window.CurrentVideoConfig):null===client.hasFlash?require(["flash_detector"],function(t){t.detectFlash(function(t){DebugMode.noFlash&&(t=null),client.hasFlash=!!t,z("flashdetection",{version:t}),e(window.CurrentVideoConfig)})}):e(window.CurrentVideoConfig))},A=function(){var i=window.PlayerSettings,n=i.skin||m,a=i.css||E,r=i.cssClass;!client.isMobile&&client.hasFlash&&i.forceFlash&&client.supportedVideoTypes.indexOf("m3u8")>-1&&client.supportedVideoTypes.splice(client.supportedVideoTypes.indexOf("m3u8"),1);var o=e.Player.ID_PREFIX+window.id;t.processMediaConfig(window.CurrentVideoConfig.content.media,function(e){"undefined"!=typeof window.CurrentVideoConfig.content.media.f4m?(LOG.debug("processed media",e),e&&(window.CurrentVideoConfig.content.media=e)):window.CurrentVideoConfig.content.media=e,LOG.debug("media data",window.CurrentVideoConfig.content.media),T(o,n,a,r)},client.supportedVideoTypes)},T=function(e,i,n,a){LOG.info("renderVideo",arguments);var r,o=CurrentVideoConfig.settings.defaultHd,s=document.body;if(o===!0?(window.CurrentVideoConfig.content.media.hd&&(r=t.selectSourceFile(window.CurrentVideoConfig.content.media.hd)),r||(delete window.CurrentVideoConfig.content.media.hd,o=!1,r=t.selectSourceFile(window.CurrentVideoConfig.content.media.sd))):(window.CurrentVideoConfig.content.media.sd&&(r=t.selectSourceFile(window.CurrentVideoConfig.content.media.sd)),r||(delete window.CurrentVideoConfig.content.media.sd,o=!0,r=t.selectSourceFile(window.CurrentVideoConfig.content.media.hd))),PlayerSettings.defaultHd=o,LOG.debug("DEFAULT HD",PlayerSettings.defaultHd,"default src",r),r){var d=PlayerSettings.forceFlash||r.indexOf(".mp4")>-1&&client.browser.firefoxWithoutMp4;if(d&&!client.hasFlash)return void w();s.setAttribute("data-default-src",r),require(["css!"+n],function(){LOG.info("CSS Loaded",n),P(e,i,n,a)})}else{var l=document.createElement("p");l.style.color="red",l.style.position="absolute",t.css.hasClass(s,"flash_required")?l.textContent='Flash Player 11 or newer is required. Get it <a href="http://get.adobe.com/flashplayer/" title="Adobe" style="color:inherit">here</a>.':l.textContent="Media not supported",s.appendChild(l)}},w=function(){LOG.error("Flash is required but not detected");for(var e=document.body;e.firstChild;)e.removeChild(e.firstChild);z(ZeusConstants.Player.Event.FATAL_ERROR,"Flash is required")},L=function(e){var t=window.PlayerSettings.freePlayer?window.PlayerSettings.fpTrackingId:window.CurrentVideoConfig.content.videoId,i="[videoId="+t+"]";M("boltRequestAdSpot "+BoltAdManager.timing,"ad",i),z("boltAdRequestStart",e.data)},S=function(n){function a(e){return/g.doubleclick/.test(e)?"generic-google":"generic-vast"}var r="ad_"+window.id,o=t.dom.getUI(e.UI.AD_CONTAINER);if(o&&o.setAttribute("id",r),window.BoltAdManager=new i(DebugMode.dcOverride,r),window.BoltAdManager.addEventListener(e.Ad.Event.REQUESTED,L),window.BoltAdManager.addEventListener(e.Ad.Event.CLICKED,I),window.AdSession=new s,window.AdSession.on(e.Ad.Event.SESSION_START,I),window.AdSession.on(e.Ad.Event.SESSION_ABORT,I),window.AdSession.on(e.Ad.Event.SESSION_END,I),window.AdSession.on(e.Ad.Event.SESSION_FAIL,I),window.AdSession.on(e.Ad.Event.SESSION_AD_LOADED,I),window.AdRequest=new d,window.AdRequest.on(e.Ad.Event.REQUEST_START,I),window.AdRequest.on(e.Ad.Event.REQUEST_ABORT,I),window.AdRequest.on(e.Ad.Event.REQUEST_SUCCESS,I),window.AdRequest.on(e.Ad.Event.REQUEST_FAIL,I),window.AdTracking=new l,window.AdTracking.on(e.Ad.Event.TRACKING,I),window.SSTracker=new c,window.SSTracker.on(e.Ad.Event.SS_REQUESTED,I),window.SSTracker.on(e.Ad.Event.SS_FAILED,I),window.SSTracker.on(e.Ad.Event.SS_LOADED,I),window.SSTracker.on(e.Ad.Event.SS_BACKFILL_REQUESTED,I),window.SSTracker.on(e.Ad.Event.SS_BACKFILL_FAILED,I),window.SSTracker.on(e.Ad.Event.SS_BACKFILL_SUCCESS,I),client.isMobile&&(!window.google||!window.google.ima)){var u=("https:"===document.location.protocol?"https:":"http:")+"//s0.2mdn.net/instream/html5/ima3_debug.js",h=document.createElement("script");h.onload=function(){LOG.debug("ima script attached"),e.Ad.IMA_ENABLED=!0,require(["googleAdsPlayer"],function(e){window.MobileIMAPlayer=new e(BoltAdManager),LOG.debug("MobileIMAPlayer",window.MobileIMAPlayer)})},h.src=u,LOG.debug(document.getElementsByTagName("head")[0]),LOG.debug(h),document.getElementsByTagName("head")[0].appendChild(h)}if(PlayerSettings.adTag||PlayerSettings.desktopAdTag||PlayerSettings.html5AdTag||PlayerSettings.mobileAdTag||PlayerSettings.vmapAdTag){PlayerSettings.embedAds={servers:[{type:null,tags:{"default":{standard:{},html5:{}}}}]};var p=PlayerSettings.embedAds.servers[0];client.isMobile?(PlayerSettings.adTag=PlayerSettings.vmapAdTag||PlayerSettings.mobileAdTag||PlayerSettings.adTag,p.tags["default"].html5.mobile=PlayerSettings.vmapAdTag?{vmap:PlayerSettings.adTag}:{preroll:PlayerSettings.adTag,midroll:PlayerSettings.adTag},DebugMode.on&&LOG.info("embed mobile ad tag",PlayerSettings.adTag)):client.hasFlash?(PlayerSettings.adTag=PlayerSettings.vmapAdTag||PlayerSettings.desktopAdTag||PlayerSettings.adTag,p.tags["default"].standard=PlayerSettings.vmapAdTag?{vmap:PlayerSettings.adTag}:{preroll:PlayerSettings.adTag,midroll:PlayerSettings.adTag},DebugMode.on&&LOG.info("embed desktop ad tag",PlayerSettings.adTag)):(PlayerSettings.adTag=PlayerSettings.vmapAdTag||PlayerSettings.html5AdTag||PlayerSettings.adTag,p.tags["default"].html5.desktop=PlayerSettings.vmapAdTag?{vmap:PlayerSettings.adTag}:{preroll:PlayerSettings.adTag,midroll:PlayerSettings.adTag},DebugMode.on&&LOG.info("embed desktop html5 tag",PlayerSettings.adTag)),p.type=a(PlayerSettings.adTag),LOG.info("Embed ad settings",PlayerSettings.embedAds)}window.BoltAdManager.init(n)},I=function(e){z(e.type,e.data)},C=function(t){function i(){window.View.addEventListener(e.Media.Event.TIME_UPDATE,O),window.View.addEventListener(e.Media.Event.METADATA,O),window.View.addEventListener(e.Media.Event.PLAY,O),window.View.addEventListener(e.Media.Event.PLAYING,O),window.View.addEventListener(e.Media.Event.STOPPED,O),window.View.addEventListener(e.Media.Event.PAUSED,O),window.View.addEventListener(e.Media.Event.RESUME,O),window.View.addEventListener(e.Media.Event.ENDED,O),window.View.addEventListener(e.Media.Event.FIRSTQUARTILE,O),window.View.addEventListener(e.Media.Event.MIDPOINT,O),window.View.addEventListener(e.Media.Event.THIRDQUARTILE,O),window.View.addEventListener(e.Media.Event.VOLUME_CHANGED,O),window.View.addEventListener(e.Ad.Event.CUEPOINT,O),window.View.addEventListener(e.Ad.Event.FAILED,O),window.View.addEventListener(e.Media.Event.NOT_FOUND,O),window.View.addEventListener(e.Player.Event.CONFIG_NOT_FOUND,O),window.View.addEventListener(e.UI.Event.REQUEST_FULLSCREEN_CHANGE,O),window.View.addEventListener(e.UI.Event.AGE_GATE_PASSED,O),window.View.addEventListener(e.UI.Event.AGE_GATE_FAILED,O),window.View.addEventListener(e.UI.Event.APPEARANCE_SETTINGS_CHANGED,O),window.View.addEventListener(e.UI.Event.INITIAL_APPEARANCE_SETTINGS_LOADED,O),!window.fullscreenEnabled&&client.hasTouch&&window.addEventListener("touchmove",function(e){p&&(e.preventDefault(),LOG.debug(window.id,"touchmove prevented"))});var t=window.CurrentVideoConfig.settings.googleAnalytics;LOG.debug("Publisher GA Tracking Id",t),z("start_google_analytics",{pubTrackingId:t,universal:window.CurrentVideoConfig.settings.googleUniversal}),h.startUp()}if(void 0===window.ContentPlayer)return LOG.debug("Unable to create player "+t),null;var n=window.ContentPlayer;return n.show(!1),AdBlockDetected&&(window.AdBlocked=new u,window.AdBlocked.on(e.Ad.Event.SESSION_BLOCKED,I)),"off"===PlayerSettings.advertising?(LOG.debug("Advertising is disabled via embed setting"),window.postLogMessage("Advertising is disabled via embed setting","warn"),i()):S(i),window.id},M=function(e,t,i,n){i&&z("analyticsEvent",{action:e,category:t,label:i,value:n})},O=function(i){var n,a=(window.View,i.target),r=zeus_ga.category,o=zeus_ga.label,s=PlayerSettings.freePlayer?PlayerSettings.fpTrackingId:window.CurrentVideoConfig.content.videoId,d=window.CurrentVideoConfig.publisherId,l="[videoId="+s+"]";switch(a&&"function"==typeof a.isAd&&(n=a.isAd()?o.ad+" "+l:o.content+" "+l),i.type!=e.Media.Event.TIME_UPDATE&&LOG.info("Zeus::handleViewEvents",i.type,"current player",a?a.containerId:null),i.type){case e.Media.Event.METADATA:z(Zeus.BOLT_CONTENT_STATE_CHANGED,{state:"ready"});break;case e.Media.Event.PLAY:if(a.isAd()){LOG.info("AD STARTED",window.id),window.postLogMessage("Ad starts");var u,c,h;try{h=BoltAdManager.ad.getLinear(),c=h.tracking.events.click,u=t.substituteMacros(h.clickThrough)}catch(p){}z(Zeus.BOLT_AD_STARTED,{videoId:s,publisherId:d,linear:BoltAdManager.isLinear(),click_url:u,click_trackers:c}),M(Zeus.BOLT_AD_STARTED,r.state,n),BoltAdManager.selectedVMAPBreak&&setTimeout(function(){BoltAdManager.trackVMAPEvent("breakStart")},100)}else z(Zeus.BOLT_CONTENT_STARTED,{videoId:s,publisherId:d}),M(Zeus.BOLT_CONTENT_STARTED,r.state,n);break;case e.Media.Event.PLAYING:a.isAd()||z(Zeus.BOLT_CONTENT_STATE_CHANGED,{state:"playing"}),M("playing",r.state,n);break;case e.Media.Event.STOPPED:a.isAd()||(z(Zeus.BOLT_CONTENT_STATE_CHANGED,{state:"stopped"}),M("stopped",r.state,n));break;case e.Media.Event.PAUSED:a.isAd()||(z(Zeus.BOLT_CONTENT_STATE_CHANGED,{state:"paused"}),M("paused",r.state,n));break;case e.Media.Event.RESUME:LOG.debug("Zeus::RESUME"),a.isAd()||(z(Zeus.BOLT_CONTENT_STATE_CHANGED,{state:"resume"}),M("resume",r.state,n));break;case e.Media.Event.ENDED:a.isAd()?(window.postLogMessage("Ad Complete"),z(Zeus.BOLT_AD_COMPLETE,{videoId:s,publisherId:d}),M(Zeus.BOLT_AD_COMPLETE,r.state,n)):(z(Zeus.BOLT_CONTENT_COMPLETE,{videoId:s,publisherId:d}),M(Zeus.BOLT_CONTENT_COMPLETE,r.state,n));break;case e.Ad.Event.CUEPOINT:window.postLogMessage("Cuepoint at "+i.data+" seconds is hit"),z(Zeus.BOLT_AD_CUEPOINT,{cuepoint:i.data}),M(Zeus.BOLT_AD_CUEPOINT,r.state,n,i.data);break;case e.Ad.Event.FAILED:window.postLogMessage(i.data.timing+" Ad error","error"),z(Zeus.BOLT_AD_ERROR,{videoId:s,publisherId:d}),M("boltAdRequestFailed",zeus_ga.category.state,"zeus "+i.data.timing);break;case e.Media.Event.FIRSTQUARTILE:window.postLogMessage("Ad reached first quartile"),z(Zeus.BOLT_FIRST_QUARTILE),M(Zeus.BOLT_FIRST_QUARTILE,r.state,n);break;case e.Media.Event.MIDPOINT:window.postLogMessage("Ad reached midpoint"),z(Zeus.BOLT_MIDPOINT),M(Zeus.BOLT_MIDPOINT,r.state,n);break;case e.Media.Event.THIRDQUARTILE:z(Zeus.BOLT_THIRD_QUARTILE),window.postLogMessage("Ad reached third quartile"),M(Zeus.BOLT_THIRD_QUARTILE,r.state,n);break;case e.Media.Event.NOT_FOUND:z(Zeus.BOLT_CONTENT_ERROR),M("boltContentNotFound",r.state,n);break;case e.Player.Event.CONFIG_NOT_FOUND:z(Zeus.BOLT_CONTENT_ERROR),M("boltConfigNotFound",r.state,n);break;case e.UI.Event.REQUEST_FULLSCREEN_CHANGE:window.fullscreenEnabled?i.data===!1?window.exitFullscreen():window.enterFullscreen():z(i.type,i.data);break;case e.UI.Event.AGE_GATE_PASSED:LOG.info("age gate",i),CurrentVideoConfig.settings.minAge>0&&(LOG.info("age gate",i),z(Zeus.BOLT_AGE_GATE_PASSED,i.data));break;case e.UI.Event.AGE_GATE_FAILED:LOG.info("age gate failed",i),z(Zeus.BOLT_AGE_GATE_FAILED);break;case e.UI.Event.APPEARANCE_SETTINGS_CHANGED:z(i.type,i.data);break;case e.UI.Event.INITIAL_APPEARANCE_SETTINGS_LOADED:z(i.type,i.data);break;case e.Media.Event.VOLUME_CHANGED:LOG.info("volume changed",i),z(Zeus.BOLT_VOLUME_CHANGED,i.data);break;case e.Media.Event.TIME_UPDATE:z(Zeus.BOLT_TIME_CHANGED,i.data)}},P=function(i,n,r,o){function s(n){if(n){LOG.info("SKIN LOADED"),l.insertAdjacentHTML("beforeend",n);var r=document.body.getElementsByClassName("bolt-poster")[0];if(r){var s=window.CurrentVideoConfig.content.posterLow||window.CurrentVideoConfig.content.thumb||window.CurrentVideoConfig.content.poster;s&&(s=t.normalizeProtocol(s),r.style.backgroundImage="url("+s+")",r.style.backgroundPosition="center center",r.style.backgroundSize="contain",r.style.backgroundRepeat="no-repeat")}var c=document.body.getElementsByClassName("bolt-container")[0];window.Skin=c,client.browser.ie>0?(t.dom.getUI(e.UI.CONTROLBAR).style.visibility="hidden",t.dom.getUI(e.UI.TITLE_BAR).style.visibility="hidden"):c.style.visibility="hidden";var h=t.dom.getUI(e.UI.MAIN_VIDEO_CONTAINER),p=h.firstElementChild;if(p.setAttribute("id",i),u.indexOf(".mp4")>-1&&client.browser.firefoxWithoutMp4&&!client.isMobile&&(d.forceFlash=!0),d.forceFlash){if(!client.hasFlash)return void w();LOG.info("Using Flash for playing video"),require(["zeus_flashshim"],function(e){Zeus.FlashShim=e,window.ContentPlayer=new e(window.id,i,"window.ContentPlayer"),window.ContentPlayer.muted=d.automute===!0,window.ContentPlayer.volume=d.volume,0===window.ContentPlayer.volume&&(window.ContentPlayer.muted=!0),window.ContentPlayer.currentQuality=d.defaultHd?"hd":"sd",window.View=new a(o);var t=setInterval(function(){return window.ContentPlayer.playerReady?(LOG.info(window.ContentPlayer.containerId,"is ready"),clearInterval(t),C(i)):void 0},100)})}else client.isMobile?client.system.ios?require(["ios_video"],function(e){return Zeus.Video=e,window.ContentPlayer=new e(window.id,i),window.ContentPlayer.muted=!1,window.ContentPlayer.currentQuality=d.defaultHd?"hd":"sd",window.View=new a(o),C(i)}):require(["zeus_mobile_video"],function(e){return Zeus.Video=e,window.ContentPlayer=new e(window.id,i),window.ContentPlayer.muted=!1,window.ContentPlayer.currentQuality=d.defaultHd?"hd":"sd",window.View=new a(o),C(i)}):require(["zeus_video"],function(e){return Zeus.Video=e,window.ContentPlayer=new e(window.id,i),window.ContentPlayer.muted=d.automute===!0,window.ContentPlayer.volume=d.volume,0===window.ContentPlayer.volume&&(window.ContentPlayer.muted=!0),window.ContentPlayer.currentQuality=d.defaultHd?"hd":"sd",window.View=new a(o),C(i)})}}var d=window.PlayerSettings,l=document.body,u=l.getAttribute("data-default-src");t.xhr(n,"get",null,function(e){s(e)},null,"text",Date.now())},k=function(){h.play()},D=function(){h.stop()},R=function(){h.replay()},G=function(){h.pause()},N=function(){h.mute(!0)},U=function(){h.mute(!1)},x=function(){h.togglePlayPause()},B=function(e){h.seek(e)},V=function(e){e>1?e=1:0>e&&(e=0),h.setVolume(e)},F=function(){return View.currentPlayer?View.currentPlayer.volume:void 0},H=function(){return E},q=function(){return g},z=function(e,t){var i=!1;try{i=View.currentPlayer.isAd()}catch(n){}var a={type:"zeus_event",name:e,id:window.id,isAd:i,data:t};a.name!=window.Zeus.BOLT_TIME_CHANGED&&LOG.info("posting message",a),window.parent.postMessage(JSON.stringify(a),"*")};return window.Zeus={embeds:{},FlashShim:null,Video:null,dispatchEvent:z,setBaseUrl:y,getBaseUrl:_,getCSSUrl:H,getSWFUrl:q,renderPlayer:b,playMedia:k,replayMedia:R,pauseMedia:G,togglePlay:x,stopMedia:D,setVolume:V,getVolume:F,muteMedia:N,unmuteMedia:U,seek:B,dispatchAnalyticsEvent:M,BOLT_CONTENT_STARTED:"boltContentStarted",BOLT_CONTENT_COMPLETE:"boltContentComplete",BOLT_CONTENT_ERROR:"boltContentError",BOLT_CONTENT_STATE_CHANGED:"boltContentStateChanged",BOLT_TOGGLE_FULLSCREEN:"boltToggleFullscreen",BOLT_FIRST_QUARTILE:"boltFirstQuartile",BOLT_MIDPOINT:"boltMidPoint",BOLT_THIRD_QUARTILE:"boltThirdQuartile",BOLT_AD_STARTED:"boltAdStarted",BOLT_AD_COMPLETE:"boltAdComplete",BOLT_AD_ERROR:"boltAdError",BOLT_ADLMCODESESSION:"boltAdlmcodesession",BOLD_AD_DURATION_CHANGED:"boltAdDurationChanged",BOLT_AD_TIME_CHANGED:"boltAdTimeChanged",BOLT_AGE_GATE_PASSED:"boltAgeGatePassed",BOLT_AGE_GATE_FAILED:"boltAgeGateFailed",BOLT_VOLUME_CHANGED:"boltVolumeChanged",BOLT_AD_CUEPOINT:"boltAdCuepoint",BOLT_TIME_CHANGED:"boltTimeChanged"},window.Bolt=window.Zeus,window.Zeus},function(e){var t=e.requireModules&&e.requireModules[0];console.error("error loading module",t)}),define("zeus_iframe",function(){}),define("iframe/libs/text",["module"],function(e){"use strict";var t,i,n,a,r,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,d=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,u=l&&location.protocol&&location.protocol.replace(/\:/,""),c=l&&location.hostname,h=l&&(location.port||void 0),p={},f=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(d);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){i=o[t];try{e=new ActiveXObject(i)}catch(n){}if(e){o=[i];break}}return e},parseName:function(e){var t,i,n,a=!1,r=e.indexOf("."),o=0===e.indexOf("./")||0===e.indexOf("../");return-1!==r&&(!o||r>1)?(t=e.substring(0,r),i=e.substring(r+1,e.length)):t=e,n=i||t,r=n.indexOf("!"),-1!==r&&(a="strip"===n.substring(r+1),n=n.substring(0,r),i?i=n:t=n),{moduleName:t,ext:i,strip:a}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,i,n,a){var r,o,s,d=t.xdRegExp.exec(e);return d?(r=d[2],o=d[3],o=o.split(":"),s=o[1],o=o[0],!(r&&r!==i||o&&o.toLowerCase()!==n.toLowerCase()||(s||o)&&s!==a)):!0},finishLoad:function(e,i,n,a){n=i?t.strip(n):n,f.isBuild&&(p[e]=n),a(n)},load:function(e,i,n,a){if(a.isBuild&&!a.inlineText)return void n();f.isBuild=a.isBuild;var r=t.parseName(e),o=r.moduleName+(r.ext?"."+r.ext:""),s=i.toUrl(o),d=f.useXhr||t.useXhr;return 0===s.indexOf("empty:")?void n():void(!l||d(s,u,c,h)?t.get(s,function(i){t.finishLoad(e,r.strip,i,n)},function(e){n.error&&n.error(e)}):i([o],function(e){t.finishLoad(r.moduleName+"."+r.ext,r.strip,e,n)}))},write:function(e,i,n,a){if(p.hasOwnProperty(i)){var r=t.jsEscape(p[i]);n.asModule(e+"!"+i,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,i,n,a,r){var o=t.parseName(i),s=o.ext?"."+o.ext:"",d=o.moduleName+s,l=n.toUrl(o.moduleName+s)+".js";t.load(d,n,function(i){var n=function(e){return a(l,e)};n.asModule=function(e,t){return a.asModule(e,l,t)},t.write(e,d,n,r)},r)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(i=require.nodeRequire("fs"),t.get=function(e,t,n){try{var a=i.readFileSync(e,"utf8");0===a.indexOf("\ufeff")&&(a=a.substring(1)),t(a)}catch(r){n(r)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,i,n,a){var r,o=t.createXhr();if(o.open("GET",e,!0),a)for(r in a)a.hasOwnProperty(r)&&o.setRequestHeader(r.toLowerCase(),a[r]);f.onXhr&&f.onXhr(o,e),o.onreadystatechange=function(t){var a,r;4===o.readyState&&(a=o.status,a>399&&600>a?(r=new Error(e+" HTTP status: "+a),r.xhr=o,n(r)):i(o.responseText),f.onXhrComplete&&f.onXhrComplete(o,e))},o.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var i,n,a="utf-8",r=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),a)),d="";try{for(i=new java.lang.StringBuffer,n=s.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=s.readLine());)i.append(o),i.append(n);d=String(i.toString())}finally{s.close()}t(d)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,a=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),r="@mozilla.org/windows-registry-key;1"in n,t.get=function(e,t){var i,o,s,d={};r&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(a.nsIFileInputStream),i.init(s,1,0,!1),o=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(a.nsIConverterInputStream),o.init(i,"utf-8",i.available(),a.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),
o.readString(i.available(),d),o.close(),i.close(),t(d.value)}catch(l){throw new Error((s&&s.path||"")+": "+l)}}),t}),define("iframe/libs/css",[],function(){if("undefined"==typeof window)return{load:function(e,t,i){i()}};var e=document.getElementsByTagName("head")[0],t=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)/)||0,i=!1,n=!0;t[1]||t[7]?i=parseInt(t[1])<6||parseInt(t[7])<=9:t[2]?n=!1:t[4]&&(i=parseInt(t[4])<18);var a={};a.pluginBuilder="./css-builder";var r,o,s,d=function(){r=document.createElement("style"),e.appendChild(r),o=r.styleSheet||r.sheet},l=0,u=[],c=function(e){l++,32==l&&(d(),l=0),o.addImport(e),r.onload=h},h=function(){s();var e=u.shift();return e?(s=e[1],void c(e[0])):void(s=null)},p=function(e,t){if(o&&o.addImport||d(),o&&o.addImport)s?u.push([e,t]):(c(e),s=t);else{r.textContent='@import "'+e+'";';var i=setInterval(function(){try{r.sheet.cssRules,clearInterval(i),t()}catch(e){}},10)}},f=function(t,i){var a=document.createElement("link");if(a.type="text/css",a.rel="stylesheet",n)a.onload=function(){a.onload=function(){},setTimeout(i,7)};else var r=setInterval(function(){for(var e=0;e<document.styleSheets.length;e++){var t=document.styleSheets[e];if(t.href==a.href)return clearInterval(r),i()}},10);a.href=t,e.appendChild(a)};return a.normalize=function(e,t){return".css"==e.substr(e.length-4,4)&&(e=e.substr(0,e.length-4)),t(e)},a.load=function(e,t,n,a){(i?p:f)(t.toUrl(e+".css"),n)},a}),define("swfobject",[],function(){var e=function(){function t(){if(!z){try{var e=U.getElementsByTagName("body")[0].appendChild(m("span"));e.parentNode.removeChild(e)}catch(t){return}z=!0;for(var i=V.length,n=0;i>n;n++)V[n]()}}function i(e){z?e():V[V.length]=e}function n(e){if(typeof N.addEventListener!=M)N.addEventListener("load",e,!1);else if(typeof U.addEventListener!=M)U.addEventListener("load",e,!1);else if(typeof N.attachEvent!=M)E(N,"onload",e);else if("function"==typeof N.onload){var t=N.onload;N.onload=function(){t(),e()}}else N.onload=e}function a(){B?r():o()}function r(){var e=U.getElementsByTagName("body")[0],t=m(O);t.setAttribute("type",D);var i=e.appendChild(t);if(i){var n=0;!function(){if(typeof i.GetVariable!=M){var a=i.GetVariable("$version");a&&(a=a.split(" ")[1].split(","),Y.pv=[parseInt(a[0],10),parseInt(a[1],10),parseInt(a[2],10)])}else if(10>n)return n++,void setTimeout(arguments.callee,10);e.removeChild(t),i=null,o()}()}else o()}function o(){var e=F.length;if(e>0)for(var t=0;e>t;t++){var i=F[t].id,n=F[t].callbackFn,a={success:!1,id:i};if(Y.pv[0]>0){var r=g(i);if(r)if(!y(F[t].swfVersion)||Y.wk&&Y.wk<312)if(F[t].expressInstall&&d()){var o={};o.data=F[t].expressInstall,o.width=r.getAttribute("width")||"0",o.height=r.getAttribute("height")||"0",r.getAttribute("class")&&(o.styleclass=r.getAttribute("class")),r.getAttribute("align")&&(o.align=r.getAttribute("align"));for(var c={},h=r.getElementsByTagName("param"),p=h.length,f=0;p>f;f++)"movie"!=h[f].getAttribute("name").toLowerCase()&&(c[h[f].getAttribute("name")]=h[f].getAttribute("value"));l(o,c,i,n)}else u(r),n&&n(a);else b(i,!0),n&&(a.success=!0,a.ref=s(i),n(a))}else if(b(i,!0),n){var v=s(i);v&&typeof v.SetVariable!=M&&(a.success=!0,a.ref=v),n(a)}}}function s(e){var t=null,i=g(e);if(i&&"OBJECT"==i.nodeName)if(typeof i.SetVariable!=M)t=i;else{var n=i.getElementsByTagName(O)[0];n&&(t=n)}return t}function d(){return!j&&y("6.0.65")&&(Y.win||Y.mac)&&!(Y.wk&&Y.wk<312)}function l(e,t,i,n){j=!0,L=n||null,S={success:!1,id:i};var a=g(i);if(a){"OBJECT"==a.nodeName?(T=c(a),w=null):(T=a,w=i),e.id=R,(typeof e.width==M||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==M||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),U.title=U.title.slice(0,47)+" - Flash Player Installation";var r=Y.ie&&Y.win?"ActiveX":"PlugIn",o="MMredirectURL="+N.location.toString().replace(/&/g,"%26")+"&MMplayerType="+r+"&MMdoctitle="+U.title;if(typeof t.flashvars!=M?t.flashvars+="&"+o:t.flashvars=o,Y.ie&&Y.win&&4!=a.readyState){var s=m("div");i+="SWFObjectNew",s.setAttribute("id",i),a.parentNode.insertBefore(s,a),a.style.display="none",function(){4==a.readyState?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}h(e,t,i)}}function u(e){if(Y.ie&&Y.win&&4!=e.readyState){var t=m("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(c(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(c(e),e)}function c(e){var t=m("div");if(Y.win&&Y.ie)t.innerHTML=e.innerHTML;else{var i=e.getElementsByTagName(O)[0];if(i){var n=i.childNodes;if(n)for(var a=n.length,r=0;a>r;r++)1==n[r].nodeType&&"PARAM"==n[r].nodeName||8==n[r].nodeType||t.appendChild(n[r].cloneNode(!0))}}return t}function h(e,t,i){var n,a=g(i);if(Y.wk&&Y.wk<312)return n;if(a)if(typeof e.id==M&&(e.id=i),Y.ie&&Y.win){var r="";for(var o in e)e[o]!=Object.prototype[o]&&("data"==o.toLowerCase()?t.movie=e[o]:"styleclass"==o.toLowerCase()?r+=' class="'+e[o]+'"':"classid"!=o.toLowerCase()&&(r+=" "+o+'="'+e[o]+'"'));var s="";for(var d in t)t[d]!=Object.prototype[d]&&(s+='<param name="'+d+'" value="'+t[d]+'" />');a.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+r+">"+s+"</object>",H[H.length]=e.id,n=g(e.id)}else{var l=m(O);l.setAttribute("type",D);for(var u in e)e[u]!=Object.prototype[u]&&("styleclass"==u.toLowerCase()?l.setAttribute("class",e[u]):"classid"!=u.toLowerCase()&&l.setAttribute(u,e[u]));for(var c in t)t[c]!=Object.prototype[c]&&"movie"!=c.toLowerCase()&&p(l,c,t[c]);a.parentNode.replaceChild(l,a),n=l}return n}function p(e,t,i){var n=m("param");n.setAttribute("name",t),n.setAttribute("value",i),e.appendChild(n)}function f(e){var t=g(e);t&&"OBJECT"==t.nodeName&&(Y.ie&&Y.win?(t.style.display="none",function(){4==t.readyState?v(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function v(e){var t=g(e);if(t){for(var i in t)"function"==typeof t[i]&&(t[i]=null);t.parentNode.removeChild(t)}}function g(e){var t=null;try{t=U.getElementById(e)}catch(i){}return t}function m(e){return U.createElement(e)}function E(e,t,i){e.attachEvent(t,i),q[q.length]=[e,t,i]}function y(e){var t=Y.pv,i=e.split(".");return i[0]=parseInt(i[0],10),i[1]=parseInt(i[1],10)||0,i[2]=parseInt(i[2],10)||0,t[0]>i[0]||t[0]==i[0]&&t[1]>i[1]||t[0]==i[0]&&t[1]==i[1]&&t[2]>=i[2]}function _(e,t,i,n){if(!Y.ie||!Y.mac){var a=U.getElementsByTagName("head")[0];if(a){var r=i&&"string"==typeof i?i:"screen";if(n&&(I=null,C=null),!I||C!=r){var o=m("style");o.setAttribute("type","text/css"),o.setAttribute("media",r),I=a.appendChild(o),Y.ie&&Y.win&&typeof U.styleSheets!=M&&U.styleSheets.length>0&&(I=U.styleSheets[U.styleSheets.length-1]),C=r}Y.ie&&Y.win?I&&typeof I.addRule==O&&I.addRule(e,t):I&&typeof U.createTextNode!=M&&I.appendChild(U.createTextNode(e+" {"+t+"}"))}}}function b(e,t){if(W){var i=t?"visible":"hidden";z&&g(e)?g(e).style.visibility=i:_("#"+e,"visibility:"+i)}}function A(e){var t=/[\\\"<>\.;]/,i=null!=t.exec(e);return i&&typeof encodeURIComponent!=M?encodeURIComponent(e):e}var T,w,L,S,I,C,M="undefined",O="object",P="Shockwave Flash",k="ShockwaveFlash.ShockwaveFlash",D="application/x-shockwave-flash",R="SWFObjectExprInst",G="onreadystatechange",N=window,U=document,x=navigator,B=!1,V=[a],F=[],H=[],q=[],z=!1,j=!1,W=!0,Y=function(){var e=typeof U.getElementById!=M&&typeof U.getElementsByTagName!=M&&typeof U.createElement!=M,t=x.userAgent.toLowerCase(),i=x.platform.toLowerCase(),n=i?/win/.test(i):/win/.test(t),a=i?/mac/.test(i):/mac/.test(t),r=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,o=!1,s=[0,0,0],d=null;if(typeof x.plugins!=M&&typeof x.plugins[P]==O)d=x.plugins[P].description,!d||typeof x.mimeTypes!=M&&x.mimeTypes[D]&&!x.mimeTypes[D].enabledPlugin||(B=!0,o=!1,d=d.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),s[0]=parseInt(d.replace(/^(.*)\..*$/,"$1"),10),s[1]=parseInt(d.replace(/^.*\.(.*)\s.*$/,"$1"),10),s[2]=/[a-zA-Z]/.test(d)?parseInt(d.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof N.ActiveXObject!=M)try{var l=new ActiveXObject(k);l&&(d=l.GetVariable("$version"),d&&(o=!0,d=d.split(" ")[1].split(","),s=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)]))}catch(u){}return{w3:e,pv:s,wk:r,ie:o,win:n,mac:a}}();(function(){Y.w3&&((typeof U.readyState!=M&&"complete"==U.readyState||typeof U.readyState==M&&(U.getElementsByTagName("body")[0]||U.body))&&t(),z||(typeof U.addEventListener!=M&&U.addEventListener("DOMContentLoaded",t,!1),Y.ie&&Y.win&&(U.attachEvent(G,function(){"complete"==U.readyState&&(U.detachEvent(G,arguments.callee),t())}),N==top&&!function(){if(!z){try{U.documentElement.doScroll("left")}catch(e){return void setTimeout(arguments.callee,0)}t()}}()),Y.wk&&!function(){return z?void 0:/loaded|complete/.test(U.readyState)?void t():void setTimeout(arguments.callee,0)}(),n(t)))})(),function(){Y.ie&&Y.win&&window.attachEvent("onunload",function(){for(var t=q.length,i=0;t>i;i++)q[i][0].detachEvent(q[i][1],q[i][2]);for(var n=H.length,a=0;n>a;a++)f(H[a]);for(var r in Y)Y[r]=null;Y=null;for(var o in e)e[o]=null;e=null})}();return{registerObject:function(e,t,i,n){if(Y.w3&&e&&t){var a={};a.id=e,a.swfVersion=t,a.expressInstall=i,a.callbackFn=n,F[F.length]=a,b(e,!1)}else n&&n({success:!1,id:e})},getObjectById:function(e){return Y.w3?s(e):void 0},embedSWF:function(e,t,n,a,r,o,s,u,c,p){var f={success:!1,id:t};Y.w3&&!(Y.wk&&Y.wk<312)&&e&&t&&n&&a&&r?(b(t,!1),i(function(){n+="",a+="";var i={};if(c&&typeof c===O)for(var v in c)i[v]=c[v];i.data=e,i.width=n,i.height=a;var g={};if(u&&typeof u===O)for(var m in u)g[m]=u[m];if(s&&typeof s===O)for(var E in s)typeof g.flashvars!=M?g.flashvars+="&"+E+"="+s[E]:g.flashvars=E+"="+s[E];if(y(r)){var _=h(i,g,t);i.id==t&&b(t,!0),f.success=!0,f.ref=_}else{if(o&&d())return i.data=o,void l(i,g,t,p);b(t,!0)}p&&p(f)})):p&&p(f)},switchOffAutoHideShow:function(){W=!1},ua:Y,getFlashPlayerVersion:function(){return{major:Y.pv[0],minor:Y.pv[1],release:Y.pv[2]}},hasFlashPlayerVersion:y,createSWF:function(e,t,i){return Y.w3?h(e,t,i):void 0},showExpressInstall:function(e,t,i,n){Y.w3&&d()&&l(e,t,i,n)},removeSWF:function(e){Y.w3&&f(e)},createCSS:function(e,t,i,n){Y.w3&&_(e,t,i,n)},addDomLoadEvent:i,addLoadEvent:n,getQueryParamValue:function(e){var t=U.location.search||U.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return A(t);for(var i=t.split("&"),n=0;n<i.length;n++)if(i[n].substring(0,i[n].indexOf("="))==e)return A(i[n].substring(i[n].indexOf("=")+1))}return""},expressInstallCallback:function(){if(j){var e=g(R);e&&T&&(e.parentNode.replaceChild(T,e),w&&(b(w,!0),Y.ie&&Y.win&&(T.style.display="block")),L&&L(S)),j=!1}}}}();return window.swfobject=e,e}),function(e,t){"function"==typeof define&&define.amd?define("dragdealer",t):e.Dragdealer=t()}(this,function(){function e(e){var t="Webkit Moz ms O".split(" "),i=document.documentElement.style;if(void 0!==i[e])return e;e=e.charAt(0).toUpperCase()+e.substr(1);for(var n=0;n<t.length;n++)if(void 0!==i[t[n]+e])return t[n]+e}function t(e){u.backfaceVisibility&&u.perspective&&(e.style[u.perspective]="1000px",e.style[u.backfaceVisibility]="hidden")}var i=function(e,t){this.options=this.applyDefaults(t||{}),this.bindMethods(),this.wrapper=this.getWrapperElement(e),this.wrapper&&(this.handle=this.getHandleElement(this.wrapper,this.options.handleClass),this.handle&&(this.init(),this.bindEventListeners()))};i.prototype={defaults:{disabled:!1,horizontal:!0,vertical:!1,slide:!0,steps:0,snap:!1,loose:!1,speed:.1,xPrecision:0,yPrecision:0,handleClass:"handle",css3:!0,activeClass:"active",tapping:!0},init:function(){this.options.css3&&t(this.handle),this.value={prev:[-1,-1],current:[this.options.x||0,this.options.y||0],target:[this.options.x||0,this.options.y||0]},this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]},this.dragStartPosition={x:0,y:0},this.change=[0,0],this.stepRatios=this.calculateStepRatios(),this.activity=!1,this.dragging=!1,this.tapping=!1,this.reflow(),this.options.disabled&&this.disable()},applyDefaults:function(e){for(var t in this.defaults)e.hasOwnProperty(t)||(e[t]=this.defaults[t]);return e},getWrapperElement:function(e){return"string"==typeof e?document.getElementById(e):e},getHandleElement:function(e,t){var i,n,a;if(e.getElementsByClassName){if(i=e.getElementsByClassName(t),i.length>0)return i[0]}else for(n=new RegExp("(^|\\s)"+t+"(\\s|$)"),i=e.getElementsByTagName("*"),a=0;a<i.length;a++)if(n.test(i[a].className))return i[a]},calculateStepRatios:function(){var e=[];if(this.options.steps>=1)for(var t=0;t<=this.options.steps-1;t++)this.options.steps>1?e[t]=t/(this.options.steps-1):e[t]=0;return e},setWrapperOffset:function(){this.offset.wrapper=l.get(this.wrapper)},calculateBounds:function(){var e={top:this.options.top||0,bottom:-(this.options.bottom||0)+this.wrapper.offsetHeight,left:this.options.left||0,right:-(this.options.right||0)+this.wrapper.offsetWidth};return e.availWidth=e.right-e.left-this.handle.offsetWidth,e.availHeight=e.bottom-e.top-this.handle.offsetHeight,e},calculateValuePrecision:function(){var e=this.options.xPrecision||Math.abs(this.bounds.availWidth),t=this.options.yPrecision||Math.abs(this.bounds.availHeight);return[e?1/e:0,t?1/t:0]},bindMethods:function(){"function"==typeof this.options.customRequestAnimationFrame?this.requestAnimationFrame=n(this.options.customRequestAnimationFrame,window):this.requestAnimationFrame=n(h,window),"function"==typeof this.options.customCancelAnimationFrame?this.cancelAnimationFrame=n(this.options.customCancelAnimationFrame,window):this.cancelAnimationFrame=n(p,window),this.animateWithRequestAnimationFrame=n(this.animateWithRequestAnimationFrame,this),this.animate=n(this.animate,this),this.onHandleMouseDown=n(this.onHandleMouseDown,this),this.onHandleTouchStart=n(this.onHandleTouchStart,this),this.onDocumentMouseMove=n(this.onDocumentMouseMove,this),this.onWrapperTouchMove=n(this.onWrapperTouchMove,this),this.onWrapperMouseDown=n(this.onWrapperMouseDown,this),this.onWrapperTouchStart=n(this.onWrapperTouchStart,this),this.onDocumentMouseUp=n(this.onDocumentMouseUp,this),this.onDocumentTouchEnd=n(this.onDocumentTouchEnd,this),this.onHandleClick=n(this.onHandleClick,this),this.onWindowResize=n(this.onWindowResize,this)},bindEventListeners:function(){a(this.handle,"mousedown",this.onHandleMouseDown),a(this.handle,"touchstart",this.onHandleTouchStart),a(document,"mousemove",this.onDocumentMouseMove),a(this.wrapper,"touchmove",this.onWrapperTouchMove),a(this.wrapper,"mousedown",this.onWrapperMouseDown),a(this.wrapper,"touchstart",this.onWrapperTouchStart),a(document,"mouseup",this.onDocumentMouseUp),a(document,"touchend",this.onDocumentTouchEnd),a(this.handle,"click",this.onHandleClick),a(window,"resize",this.onWindowResize),this.animate(!1,!0),this.interval=this.requestAnimationFrame(this.animateWithRequestAnimationFrame)},unbindEventListeners:function(){r(this.handle,"mousedown",this.onHandleMouseDown),r(this.handle,"touchstart",this.onHandleTouchStart),r(document,"mousemove",this.onDocumentMouseMove),r(this.wrapper,"touchmove",this.onWrapperTouchMove),r(this.wrapper,"mousedown",this.onWrapperMouseDown),r(this.wrapper,"touchstart",this.onWrapperTouchStart),r(document,"mouseup",this.onDocumentMouseUp),r(document,"touchend",this.onDocumentTouchEnd),r(this.handle,"click",this.onHandleClick),r(window,"resize",this.onWindowResize),this.cancelAnimationFrame(this.interval)},onHandleMouseDown:function(e){d.refresh(e),o(e),s(e),this.activity=!1,this.startDrag()},onHandleTouchStart:function(e){d.refresh(e),s(e),this.activity=!1,this.startDrag()},onDocumentMouseMove:function(e){e.clientX-this.dragStartPosition.x===0&&e.clientY-this.dragStartPosition.y===0||(d.refresh(e),this.dragging&&(this.activity=!0,o(e)))},onWrapperTouchMove:function(e){return d.refresh(e),!this.activity&&this.draggingOnDisabledAxis()?void(this.dragging&&this.stopDrag()):(o(e),void(this.activity=!0))},onWrapperMouseDown:function(e){d.refresh(e),o(e),this.startTap()},onWrapperTouchStart:function(e){d.refresh(e),o(e),this.startTap()},onDocumentMouseUp:function(e){this.stopDrag(),this.stopTap()},onDocumentTouchEnd:function(e){this.stopDrag(),this.stopTap()},onHandleClick:function(e){this.activity&&(o(e),s(e))},onWindowResize:function(e){this.reflow()},enable:function(){this.disabled=!1,this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=!0,/\s?disabled/.test(this.handle.className)||(this.handle.className+=" disabled")},reflow:function(){this.setWrapperOffset(),this.bounds=this.calculateBounds(),this.valuePrecision=this.calculateValuePrecision(),this.updateOffsetFromValue()},getStep:function(){return[this.getStepNumber(this.value.target[0]),this.getStepNumber(this.value.target[1])]},getStepWidth:function(){return Math.abs(this.bounds.availWidth/this.options.steps)},getValue:function(){return this.value.target},setStep:function(e,t,i){this.setValue(this.options.steps&&e>1?(e-1)/(this.options.steps-1):0,this.options.steps&&t>1?(t-1)/(this.options.steps-1):0,i)},setValue:function(e,t,i,n){this.setTargetValue([e,t||0]),i&&(this.groupCopy(this.value.current,this.value.target),this.updateOffsetFromValue(),n||this.callAnimationCallback())},startTap:function(){!this.disabled&&this.options.tapping&&(this.tapping=!0,this.setWrapperOffset(),this.setTargetValueByOffset([d.x-this.offset.wrapper[0]-this.handle.offsetWidth/2,d.y-this.offset.wrapper[1]-this.handle.offsetHeight/2]))},stopTap:function(){!this.disabled&&this.tapping&&(this.tapping=!1,this.setTargetValue(this.value.current))},startDrag:function(){this.disabled||(this.dragging=!0,this.setWrapperOffset(),this.dragStartPosition={x:d.x,y:d.y},this.offset.mouse=[d.x-l.get(this.handle)[0],d.y-l.get(this.handle)[1]],this.wrapper.className.match(this.options.activeClass)||(this.wrapper.className+=" "+this.options.activeClass),this.callDragStartCallback())},stopDrag:function(){if(!this.disabled&&this.dragging){this.dragging=!1;var e=0===this.bounds.availWidth?0:(d.x-this.dragStartPosition.x)/this.bounds.availWidth,t=0===this.bounds.availHeight?0:(d.y-this.dragStartPosition.y)/this.bounds.availHeight,i=[e,t],n=this.groupClone(this.value.current);if(this.options.slide){var a=this.change;n[0]+=4*a[0],n[1]+=4*a[1]}this.setTargetValue(n),this.wrapper.className=this.wrapper.className.replace(" "+this.options.activeClass,""),this.callDragStopCallback(i)}},callAnimationCallback:function(){var e=this.value.current;this.options.snap&&this.options.steps>1&&(e=this.getClosestSteps(e)),this.groupCompare(e,this.value.prev)||("function"==typeof this.options.animationCallback&&this.options.animationCallback.call(this,e[0],e[1]),this.groupCopy(this.value.prev,e))},callTargetCallback:function(){"function"==typeof this.options.callback&&this.options.callback.call(this,this.value.target[0],this.value.target[1])},callDragStartCallback:function(){"function"==typeof this.options.dragStartCallback&&this.options.dragStartCallback.call(this,this.value.target[0],this.value.target[1])},callDragStopCallback:function(e){"function"==typeof this.options.dragStopCallback&&this.options.dragStopCallback.call(this,this.value.target[0],this.value.target[1],e)},animateWithRequestAnimationFrame:function(e){e?(this.timeOffset=this.timeStamp?e-this.timeStamp:0,this.timeStamp=e):this.timeOffset=25,this.animate(),this.interval=this.requestAnimationFrame(this.animateWithRequestAnimationFrame)},animate:function(e,t){if(!e||this.dragging){if(this.dragging){var i=this.groupClone(this.value.target),n=[d.x-this.offset.wrapper[0]-this.offset.mouse[0],d.y-this.offset.wrapper[1]-this.offset.mouse[1]];this.setTargetValueByOffset(n,this.options.loose),this.change=[this.value.target[0]-i[0],this.value.target[1]-i[1]]}(this.dragging||t)&&this.groupCopy(this.value.current,this.value.target),(this.dragging||this.glide()||t)&&(this.updateOffsetFromValue(),this.callAnimationCallback())}},glide:function(){var e=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];return e[0]||e[1]?(Math.abs(e[0])>this.valuePrecision[0]||Math.abs(e[1])>this.valuePrecision[1]?(this.value.current[0]+=e[0]*Math.min(this.options.speed*this.timeOffset/25,1),this.value.current[1]+=e[1]*Math.min(this.options.speed*this.timeOffset/25,1)):this.groupCopy(this.value.current,this.value.target),!0):!1},updateOffsetFromValue:function(){this.options.snap?this.offset.current=this.getOffsetsByRatios(this.getClosestSteps(this.value.current)):this.offset.current=this.getOffsetsByRatios(this.value.current),this.groupCompare(this.offset.current,this.offset.prev)||(this.renderHandlePosition(),this.groupCopy(this.offset.prev,this.offset.current))},renderHandlePosition:function(){var e="";return this.options.css3&&u.transform?(this.options.horizontal&&(e+="translateX("+this.offset.current[0]+"px)"),this.options.vertical&&(e+=" translateY("+this.offset.current[1]+"px)"),void(this.handle.style[u.transform]=e)):(this.options.horizontal&&(this.handle.style.left=this.offset.current[0]+"px"),void(this.options.vertical&&(this.handle.style.top=this.offset.current[1]+"px")))},setTargetValue:function(e,t){var i=t?this.getLooseValue(e):this.getProperValue(e);this.groupCopy(this.value.target,i),this.offset.target=this.getOffsetsByRatios(i),this.callTargetCallback()},setTargetValueByOffset:function(e,t){var i=this.getRatiosByOffsets(e),n=t?this.getLooseValue(i):this.getProperValue(i);this.groupCopy(this.value.target,n),this.offset.target=this.getOffsetsByRatios(n)},getLooseValue:function(e){var t=this.getProperValue(e);return[t[0]+(e[0]-t[0])/4,t[1]+(e[1]-t[1])/4]},getProperValue:function(e){var t=this.groupClone(e);return t[0]=Math.max(t[0],0),t[1]=Math.max(t[1],0),t[0]=Math.min(t[0],1),t[1]=Math.min(t[1],1),(!this.dragging&&!this.tapping||this.options.snap)&&this.options.steps>1&&(t=this.getClosestSteps(t)),t},getRatiosByOffsets:function(e){return[this.getRatioByOffset(e[0],this.bounds.availWidth,this.bounds.left),this.getRatioByOffset(e[1],this.bounds.availHeight,this.bounds.top)]},getRatioByOffset:function(e,t,i){return t?(e-i)/t:0},getOffsetsByRatios:function(e){return[this.getOffsetByRatio(e[0],this.bounds.availWidth,this.bounds.left),this.getOffsetByRatio(e[1],this.bounds.availHeight,this.bounds.top)]},getOffsetByRatio:function(e,t,i){return Math.round(e*t)+i},getStepNumber:function(e){return this.getClosestStep(e)*(this.options.steps-1)+1},getClosestSteps:function(e){return[this.getClosestStep(e[0]),this.getClosestStep(e[1])]},getClosestStep:function(e){for(var t=0,i=1,n=0;n<=this.options.steps-1;n++)Math.abs(this.stepRatios[n]-e)<i&&(i=Math.abs(this.stepRatios[n]-e),t=n);return this.stepRatios[t]},groupCompare:function(e,t){return e[0]==t[0]&&e[1]==t[1]},groupCopy:function(e,t){e[0]=t[0],e[1]=t[1]},groupClone:function(e){return[e[0],e[1]]},draggingOnDisabledAxis:function(){return!this.options.horizontal&&d.xDiff>d.yDiff||!this.options.vertical&&d.yDiff>d.xDiff}};for(var n=function(e,t){return function(){return e.apply(t,arguments)}},a=function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i)},r=function(e,t,i){e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent&&e.detachEvent("on"+t,i)},o=function(e){e||(e=window.event),e.preventDefault&&e.preventDefault(),e.returnValue=!1},s=function(e){e||(e=window.event),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},d={x:0,y:0,xDiff:0,yDiff:0,refresh:function(e){e||(e=window.event),"mousemove"==e.type?this.set(e):e.touches&&this.set(e.touches[0])},set:function(e){var t=this.x,i=this.y;e.clientX||e.clientY?(this.x=e.clientX,this.y=e.clientY):(e.pageX||e.pageY)&&(this.x=e.pageX-document.body.scrollLeft-document.documentElement.scrollLeft,this.y=e.pageY-document.body.scrollTop-document.documentElement.scrollTop),this.xDiff=Math.abs(this.x-t),this.yDiff=Math.abs(this.y-i)}},l={get:function(e){var t={left:0,top:0};return void 0!==e.getBoundingClientRect&&(t=e.getBoundingClientRect()),[t.left,t.top]}},u={transform:e("transform"),perspective:e("perspective"),backfaceVisibility:e("backfaceVisibility")},c=["webkit","moz"],h=window.requestAnimationFrame,p=window.cancelAnimationFrame,f=0;f<c.length&&!h;++f)h=window[c[f]+"RequestAnimationFrame"],p=window[c[f]+"CancelAnimationFrame"]||window[c[f]+"CancelRequestAnimationFrame"];return h||(h=function(e){return setTimeout(e,25)},p=clearTimeout),i}),define("webvttparser",[],function(){var e=function(){this.parse=function(e,n){function a(e,t){c.push({message:e,line:s+1,col:t})}var r=/\r\n|\r|\n/,o=Date.now(),s=0,d=e.split(r),l=!1,u=[],c=[];for((d[s].length<6||0!=d[s].indexOf("WEBVTT")||d[s].length>6&&" "!=d[s][6]&&"	"!=d[s][6])&&a('No valid signature. (File needs to start with "WEBVTT".)'),s++;""!=d[s]&&void 0!=d[s];){if(a("No blank line after the signature."),-1!=d[s].indexOf("-->")){l=!0;break}s++}for(;void 0!=d[s];){for(var h;!l&&""==d[s];)s++;if(!l&&void 0==d[s])break;h={id:"",startTime:0,endTime:0,pauseOnExit:!1,direction:"horizontal",snapToLines:!0,linePosition:"auto",textPosition:50,size:100,alignment:"middle",text:"",tree:null};var p=!0;if(-1==d[s].indexOf("-->")){if(h.id=d[s],/^NOTE($|[ \t])/.test(h.id)){for(s++;""!=d[s]&&void 0!=d[s];)-1!=d[s].indexOf("-->")&&a("Cannot have timestamp in a comment."),s++;continue}if(s++,""==d[s]||void 0==d[s]){a("Cue identifier cannot be standalone.");continue}-1==d[s].indexOf("-->")&&(p=!1,a("Cue identifier needs to be followed by timestamp."))}l=!1;var f=new t(d[s],a),v=0;if(u.length>0&&(v=u[u.length-1].startTime),!p||f.parse(h,v)){for(s++;""!=d[s]&&void 0!=d[s];){if(-1!=d[s].indexOf("-->")){a("Blank line missing before cue."),l=!0;break}""!=h.text&&(h.text+="\n"),h.text+=d[s],s++}var g=new i(h.text,a,n);h.tree=g.parse(h.startTime,h.endTime),u.push(h)}else for(h=null,s++;""!=d[s]&&void 0!=d[s];){if(-1!=d[s].indexOf("-->")){l=!0;break}s++}}return u.sort(function(e,t){return e.startTime<t.startTime?-1:e.startTime>t.startTime?1:e.endTime>t.endTime?-1:e.endTime<t.endTime?1:0}),{cues:u,errors:c,time:Date.now()-o}}},t=function(e,t){function i(t){for(;void 0!=e[d]&&t.test(e[d]);)d++}function n(t){for(var i="";void 0!=e[d]&&t.test(e[d]);)i+=e[d],d++;return i}function a(){var t,i,a,r,o="minutes";if(void 0==e[d])return void l("No timestamp found.");if(!/\d/.test(e[d]))return void l("Timestamp must start with a character in the range 0-9.");if(t=n(/\d/),(t.length>2||parseInt(t,10)>59)&&(o="hours"),":"!=e[d])return void l("No time unit separator found.");if(d++,i=n(/\d/),2!=i.length)return void l("Must be exactly two digits.");if("hours"==o||":"==e[d]){if(":"!=e[d])return void l("No seconds found or minutes is greater than 59.");if(d++,a=n(/\d/),2!=a.length)return void l("Must be exactly two digits.")}else a=i,i=t,t="0";return"."!=e[d]?void l('No decimal separator (".") found.'):(d++,r=n(/\d/),3!=r.length?void l("Milliseconds must be given in three digits."):parseInt(i,10)>59?void l("You cannot have more than 59 minutes."):parseInt(a,10)>59?void l("You cannot have more than 59 seconds."):60*parseInt(t,10)*60+60*parseInt(i,10)+parseInt(a,10)+parseInt(r,10)/1e3)}function r(e,t){for(var i=e.split(o),n=[],a=0;a<i.length;a++)if(""!=i[a]){var r=i[a].indexOf(":"),s=i[a].slice(0,r);if(value=i[a].slice(r+1),-1!=n.indexOf(s)&&l("Duplicate setting."),n.push(s),""==value)return void l("No value for setting defined.");if("vertical"==s){if("rl"!=value&&"lr"!=value){l("Writing direction can only be set to 'rl' or 'rl'.");continue}t.direction=value}else if("line"==s){if(!/\d/.test(value)){l("Line position takes a number or percentage.");continue}if(-1!=value.indexOf("-",1)){l("Line position can only have '-' at the start.");continue}if(-1!=value.indexOf("%")&&value.indexOf("%")!=value.length-1){l("Line position can only have '%' at the end.");continue}if("-"==value[0]&&"%"==value[value.length-1]){l("Line position cannot be a negative percentage.");continue}if("%"==value[value.length-1]){if(parseInt(value,10)>100){l("Line position cannot be >100%.");continue}t.snapToLines=!1}t.linePosition=parseInt(value,10)}else if("position"==s){if("%"!=value[value.length-1]){l("Text position must be a percentage.");continue}if(parseInt(value,10)>100){l("Size cannot be >100%.");continue}t.textPosition=parseInt(value,10)}else if("size"==s){if("%"!=value[value.length-1]){l("Size must be a percentage.");continue}if(parseInt(value,10)>100){l("Size cannot be >100%.");continue}t.size=parseInt(value,10)}else if("align"==s){var d=["start","middle","end","left","right"];if(-1==d.indexOf(value)){l("Alignment can only be set to one of "+d.join(", ")+".");continue}t.alignment=value}else l("Invalid setting.")}}var o=/[\u0020\t\f]/,s=/[^\u0020\t\f]/,e=e,d=0,l=function(e){t(e,d+1)},u=!0;this.parse=function(t,n){if(i(o),t.startTime=a(),void 0!=t.startTime){if(t.startTime<n&&l("Start timestamp is not greater than or equal to start timestamp of previous cue."),s.test(e[d])&&l("Timestamp not separated from '-->' by whitespace."),i(o),"-"!=e[d])return void l("No valid timestamp separator found.");if(d++,"-"!=e[d])return void l("No valid timestamp separator found.");if(d++,">"!=e[d])return void l("No valid timestamp separator found.");if(d++,s.test(e[d])&&l("'-->' not separated from timestamp by whitespace."),i(o),t.endTime=a(),void 0!=t.endTime)return t.endTime<=t.startTime&&l("End timestamp is not greater than start timestamp."),s.test(e[d])&&(u=!1),i(o),r(e.substring(d),t),!0}},this.parseTimestamp=function(){var t=a();return void 0!=e[d]?void l("Timestamp must not have trailing characters."):t}},i=function(e,i,n){function a(){for(var t="data",i="",n="",a=[];void 0!=e[r-1]||0==r;){var s=e[r];if("data"==t)if("&"==s)n=s,t="escape";else if("<"==s&&""==i)t="tag";else{if("<"==s||void 0==s)return["text",i];i+=s}else if("escape"==t)if("&"==s)o("Incorrect escape."),i+=n,n=s;else if(/[abglmnsprt]/.test(s))n+=s;else if(";"==s)"&amp"==n?i+="&":"&lt"==n?i+="<":"&gt"==n?i+=">":"&lrm"==n?i+="‎":"&rlm"==n?i+="‏":"&nbsp"==n?i+=" ":(o("Incorrect escape."),i+=n+";"),t="data";else{if("<"==s||void 0==s)return o("Incorrect escape."),i+=n,["text",i];o("Incorrect escape."),i+=n+s,t="data"}else if("tag"==t)if("	"==s||"\n"==s||"\f"==s||" "==s)t="start tag annotation";else if("."==s)t="start tag class";else if("/"==s)t="end tag";else if(/\d/.test(s))i=s,t="timestamp tag";else{if(">"==s||void 0==s)return">"==s&&r++,["start tag","",[],""];i=s,t="start tag"}else if("start tag"==t)if("	"==s||"\f"==s||" "==s)t="start tag annotation";else if("\n"==s)n=s,t="start tag annotation";else if("."==s)t="start tag class";else{if(">"==s||void 0==s)return">"==s&&r++,["start tag",i,[],""];i+=s}else if("start tag class"==t)if("	"==s||"\f"==s||" "==s)a.push(n),n="",t="start tag annotation";else if("\n"==s)a.push(n),n=s,t="start tag annotation";else if("."==s)a.push(n),n="";else{if(">"==s||void 0==s)return">"==s&&r++,a.push(n),["start tag",i,a,""];n+=s}else if("start tag annotation"==t){if(">"==s||void 0==s)return">"==s&&r++,n=n.split(/[\u0020\t\f\r\n]+/).filter(function(e){return e?!0:void 0}).join(" "),["start tag",i,a,n];n+=s}else if("end tag"==t){if(">"==s||void 0==s)return">"==s&&r++,["end tag",i];i+=s}else if("timestamp tag"==t){if(">"==s||void 0==s)return">"==s&&r++,["timestamp",i];i+=s}else o("Never happens.");r++}}var e=e,r=0,o=function(e){"metadata"!=n&&i(e,r+1)};this.parse=function(i,s){function d(e){c.children.push({type:"object",name:e[1],classes:e[2],children:[],parent:c}),c=c.children[c.children.length-1]}function l(e){for(var t=c;t;){if(t.name==e)return!0;t=t.parent}}for(var u={children:[]},c=u,h=[];void 0!=e[r];){var p=a();if("text"==p[0])c.children.push({type:"text",value:p[1],parent:c});else if("start tag"==p[0]){"chapters"==n&&o("Start tags not allowed in chapter title text.");var f=p[1];"v"!=f&&"lang"!=f&&""!=p[3]&&o("Only <v> and <lang> can have an annotation."),"c"==f||"i"==f||"b"==f||"u"==f||"ruby"==f?d(p):"rt"==f&&"ruby"==c.name?d(p):"v"==f?(l("v")&&o("<v> cannot be nested inside itself."),
d(p),c.value=p[3],p[3]||o("<v> requires an annotation.")):"lang"==f?(d(p),c.value=p[3]):o("Incorrect start tag.")}else if("end tag"==p[0])"chapters"==n&&o("End tags not allowed in chapter title text."),p[1]==c.name?c=c.parent:"ruby"==p[1]&&"rt"==c.name?c=c.parent.parent:o("Incorrect end tag.");else if("timestamp"==p[0]){"chapters"==n&&o("Timestamp not allowed in chapter title text.");var v=new t(p[1],o),g=v.parseTimestamp();void 0!=g&&((i>=g||g>=s)&&o("Timestamp must be between start timestamp and end timestamp."),h.length>0&&h[h.length-1]>=g&&o("Timestamp must be greater than any previous timestamp."),c.children.push({type:"timestamp",value:g,parent:c}),h.push(g))}}for(;c.parent;)"v"!=c.name&&o("Required end tag missing."),c=c.parent;return u}};return e}),function(e,t,i,n){"use strict";function a(e,t,i){return setTimeout(u(e,i),t)}function r(e,t,i){return Array.isArray(e)?(o(e,i[t],i),!0):!1}function o(e,t,i){var a;if(e)if(e.forEach)e.forEach(t,i);else if(e.length!==n)for(a=0;a<e.length;)t.call(i,e[a],a,e),a++;else for(a in e)e.hasOwnProperty(a)&&t.call(i,e[a],a,e)}function s(e,t,i){for(var a=Object.keys(t),r=0;r<a.length;)(!i||i&&e[a[r]]===n)&&(e[a[r]]=t[a[r]]),r++;return e}function d(e,t){return s(e,t,!0)}function l(e,t,i){var n,a=t.prototype;n=e.prototype=Object.create(a),n.constructor=e,n._super=a,i&&s(n,i)}function u(e,t){return function(){return e.apply(t,arguments)}}function c(e,t){return typeof e==ue?e.apply(t?t[0]||n:n,t):e}function h(e,t){return e===n?t:e}function p(e,t,i){o(m(t),function(t){e.addEventListener(t,i,!1)})}function f(e,t,i){o(m(t),function(t){e.removeEventListener(t,i,!1)})}function v(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function g(e,t){return e.indexOf(t)>-1}function m(e){return e.trim().split(/\s+/g)}function E(e,t,i){if(e.indexOf&&!i)return e.indexOf(t);for(var n=0;n<e.length;){if(i&&e[n][i]==t||!i&&e[n]===t)return n;n++}return-1}function y(e){return Array.prototype.slice.call(e,0)}function _(e,t,i){for(var n=[],a=[],r=0;r<e.length;){var o=t?e[r][t]:e[r];E(a,o)<0&&n.push(e[r]),a[r]=o,r++}return i&&(n=t?n.sort(function(e,i){return e[t]>i[t]}):n.sort()),n}function b(e,t){for(var i,a,r=t[0].toUpperCase()+t.slice(1),o=0;o<de.length;){if(i=de[o],a=i?i+r:t,a in e)return a;o++}return n}function A(){return fe++}function T(e){var t=e.ownerDocument;return t.defaultView||t.parentWindow}function w(e,t){var i=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){c(e.options.enable,[e])&&i.handler(t)},this.init()}function L(e){var t,i=e.options.inputClass;return new(t=i?i:me?B:Ee?H:ge?z:x)(e,S)}function S(e,t,i){var n=i.pointers.length,a=i.changedPointers.length,r=t&we&&n-a===0,o=t&(Se|Ie)&&n-a===0;i.isFirst=!!r,i.isFinal=!!o,r&&(e.session={}),i.eventType=t,I(e,i),e.emit("hammer.input",i),e.recognize(i),e.session.prevInput=i}function I(e,t){var i=e.session,n=t.pointers,a=n.length;i.firstInput||(i.firstInput=O(t)),a>1&&!i.firstMultiple?i.firstMultiple=O(t):1===a&&(i.firstMultiple=!1);var r=i.firstInput,o=i.firstMultiple,s=o?o.center:r.center,d=t.center=P(n);t.timeStamp=pe(),t.deltaTime=t.timeStamp-r.timeStamp,t.angle=G(s,d),t.distance=R(s,d),C(i,t),t.offsetDirection=D(t.deltaX,t.deltaY),t.scale=o?U(o.pointers,n):1,t.rotation=o?N(o.pointers,n):0,M(i,t);var l=e.element;v(t.srcEvent.target,l)&&(l=t.srcEvent.target),t.target=l}function C(e,t){var i=t.center,n=e.offsetDelta||{},a=e.prevDelta||{},r=e.prevInput||{};t.eventType!==we&&r.eventType!==Se||(a=e.prevDelta={x:r.deltaX||0,y:r.deltaY||0},n=e.offsetDelta={x:i.x,y:i.y}),t.deltaX=a.x+(i.x-n.x),t.deltaY=a.y+(i.y-n.y)}function M(e,t){var i,a,r,o,s=e.lastInterval||t,d=t.timeStamp-s.timeStamp;if(t.eventType!=Ie&&(d>Te||s.velocity===n)){var l=s.deltaX-t.deltaX,u=s.deltaY-t.deltaY,c=k(d,l,u);a=c.x,r=c.y,i=he(c.x)>he(c.y)?c.x:c.y,o=D(l,u),e.lastInterval=t}else i=s.velocity,a=s.velocityX,r=s.velocityY,o=s.direction;t.velocity=i,t.velocityX=a,t.velocityY=r,t.direction=o}function O(e){for(var t=[],i=0;i<e.pointers.length;)t[i]={clientX:ce(e.pointers[i].clientX),clientY:ce(e.pointers[i].clientY)},i++;return{timeStamp:pe(),pointers:t,center:P(t),deltaX:e.deltaX,deltaY:e.deltaY}}function P(e){var t=e.length;if(1===t)return{x:ce(e[0].clientX),y:ce(e[0].clientY)};for(var i=0,n=0,a=0;t>a;)i+=e[a].clientX,n+=e[a].clientY,a++;return{x:ce(i/t),y:ce(n/t)}}function k(e,t,i){return{x:t/e||0,y:i/e||0}}function D(e,t){return e===t?Ce:he(e)>=he(t)?e>0?Me:Oe:t>0?Pe:ke}function R(e,t,i){i||(i=Ne);var n=t[i[0]]-e[i[0]],a=t[i[1]]-e[i[1]];return Math.sqrt(n*n+a*a)}function G(e,t,i){i||(i=Ne);var n=t[i[0]]-e[i[0]],a=t[i[1]]-e[i[1]];return 180*Math.atan2(a,n)/Math.PI}function N(e,t){return G(t[1],t[0],Ue)-G(e[1],e[0],Ue)}function U(e,t){return R(t[0],t[1],Ue)/R(e[0],e[1],Ue)}function x(){this.evEl=Be,this.evWin=Ve,this.allow=!0,this.pressed=!1,w.apply(this,arguments)}function B(){this.evEl=qe,this.evWin=ze,w.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function V(){this.evTarget=We,this.evWin=Ye,this.started=!1,w.apply(this,arguments)}function F(e,t){var i=y(e.touches),n=y(e.changedTouches);return t&(Se|Ie)&&(i=_(i.concat(n),"identifier",!0)),[i,n]}function H(){this.evTarget=Xe,this.targetIds={},w.apply(this,arguments)}function q(e,t){var i=y(e.touches),n=this.targetIds;if(t&(we|Le)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var a,r,o=y(e.changedTouches),s=[],d=this.target;if(r=i.filter(function(e){return v(e.target,d)}),t===we)for(a=0;a<r.length;)n[r[a].identifier]=!0,a++;for(a=0;a<o.length;)n[o[a].identifier]&&s.push(o[a]),t&(Se|Ie)&&delete n[o[a].identifier],a++;return s.length?[_(r.concat(s),"identifier",!0),s]:void 0}function z(){w.apply(this,arguments);var e=u(this.handler,this);this.touch=new H(this.manager,e),this.mouse=new x(this.manager,e)}function j(e,t){this.manager=e,this.set(t)}function W(e){if(g(e,tt))return tt;var t=g(e,it),i=g(e,nt);return t&&i?it+" "+nt:t||i?t?it:nt:g(e,et)?et:$e}function Y(e){this.id=A(),this.manager=null,this.options=d(e||{},this.defaults),this.options.enable=h(this.options.enable,!0),this.state=at,this.simultaneous={},this.requireFail=[]}function Q(e){return e&lt?"cancel":e&st?"end":e&ot?"move":e&rt?"start":""}function X(e){return e==ke?"down":e==Pe?"up":e==Me?"left":e==Oe?"right":""}function K(e,t){var i=t.manager;return i?i.get(e):e}function Z(){Y.apply(this,arguments)}function J(){Z.apply(this,arguments),this.pX=null,this.pY=null}function $(){Z.apply(this,arguments)}function ee(){Y.apply(this,arguments),this._timer=null,this._input=null}function te(){Z.apply(this,arguments)}function ie(){Z.apply(this,arguments)}function ne(){Y.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ae(e,t){return t=t||{},t.recognizers=h(t.recognizers,ae.defaults.preset),new re(e,t)}function re(e,t){t=t||{},this.options=d(t,ae.defaults),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.element=e,this.input=L(this),this.touchAction=new j(this,this.options.touchAction),oe(this,!0),o(t.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function oe(e,t){var i=e.element;o(e.options.cssProps,function(e,n){i.style[b(i.style,n)]=t?e:""})}function se(e,i){var n=t.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=i,i.target.dispatchEvent(n)}var de=["","webkit","moz","MS","ms","o"],le=t.createElement("div"),ue="function",ce=Math.round,he=Math.abs,pe=Date.now,fe=1,ve=/mobile|tablet|ip(ad|hone|od)|android/i,ge="ontouchstart"in e,me=b(e,"PointerEvent")!==n,Ee=ge&&ve.test(navigator.userAgent),ye="touch",_e="pen",be="mouse",Ae="kinect",Te=25,we=1,Le=2,Se=4,Ie=8,Ce=1,Me=2,Oe=4,Pe=8,ke=16,De=Me|Oe,Re=Pe|ke,Ge=De|Re,Ne=["x","y"],Ue=["clientX","clientY"];w.prototype={handler:function(){},init:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(T(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&f(this.element,this.evEl,this.domHandler),this.evTarget&&f(this.target,this.evTarget,this.domHandler),this.evWin&&f(T(this.element),this.evWin,this.domHandler)}};var xe={mousedown:we,mousemove:Le,mouseup:Se},Be="mousedown",Ve="mousemove mouseup";l(x,w,{handler:function(e){var t=xe[e.type];t&we&&0===e.button&&(this.pressed=!0),t&Le&&1!==e.which&&(t=Se),this.pressed&&this.allow&&(t&Se&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:be,srcEvent:e}))}});var Fe={pointerdown:we,pointermove:Le,pointerup:Se,pointercancel:Ie,pointerout:Ie},He={2:ye,3:_e,4:be,5:Ae},qe="pointerdown",ze="pointermove pointerup pointercancel";e.MSPointerEvent&&(qe="MSPointerDown",ze="MSPointerMove MSPointerUp MSPointerCancel"),l(B,w,{handler:function(e){var t=this.store,i=!1,n=e.type.toLowerCase().replace("ms",""),a=Fe[n],r=He[e.pointerType]||e.pointerType,o=r==ye,s=E(t,e.pointerId,"pointerId");a&we&&(0===e.button||o)?0>s&&(t.push(e),s=t.length-1):a&(Se|Ie)&&(i=!0),0>s||(t[s]=e,this.callback(this.manager,a,{pointers:t,changedPointers:[e],pointerType:r,srcEvent:e}),i&&t.splice(s,1))}});var je={touchstart:we,touchmove:Le,touchend:Se,touchcancel:Ie},We="touchstart",Ye="touchstart touchmove touchend touchcancel";l(V,w,{handler:function(e){var t=je[e.type];if(t===we&&(this.started=!0),this.started){var i=F.call(this,e,t);t&(Se|Ie)&&i[0].length-i[1].length===0&&(this.started=!1),this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:ye,srcEvent:e})}}});var Qe={touchstart:we,touchmove:Le,touchend:Se,touchcancel:Ie},Xe="touchstart touchmove touchend touchcancel";l(H,w,{handler:function(e){var t=Qe[e.type],i=q.call(this,e,t);i&&this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:ye,srcEvent:e})}}),l(z,w,{handler:function(e,t,i){var n=i.pointerType==ye,a=i.pointerType==be;if(n)this.mouse.allow=!1;else if(a&&!this.mouse.allow)return;t&(Se|Ie)&&(this.mouse.allow=!0),this.callback(e,t,i)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ke=b(le.style,"touchAction"),Ze=Ke!==n,Je="compute",$e="auto",et="manipulation",tt="none",it="pan-x",nt="pan-y";j.prototype={set:function(e){e==Je&&(e=this.compute()),Ze&&(this.manager.element.style[Ke]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return o(this.manager.recognizers,function(t){c(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),W(e.join(" "))},preventDefaults:function(e){if(!Ze){var t=e.srcEvent,i=e.offsetDirection;if(this.manager.session.prevented)return void t.preventDefault();var n=this.actions,a=g(n,tt),r=g(n,nt),o=g(n,it);return a||r&&i&De||o&&i&Re?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var at=1,rt=2,ot=4,st=8,dt=st,lt=16,ut=32;Y.prototype={defaults:{},set:function(e){return s(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(r(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=K(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return r(e,"dropRecognizeWith",this)?this:(e=K(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(r(e,"requireFailure",this))return this;var t=this.requireFail;return e=K(e,this),-1===E(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(r(e,"dropRequireFailure",this))return this;e=K(e,this);var t=E(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function t(t){i.manager.emit(i.options.event+(t?Q(n):""),e)}var i=this,n=this.state;st>n&&t(!0),t(),n>=st&&t(!0)},tryEmit:function(e){return this.canEmit()?this.emit(e):void(this.state=ut)},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(ut|at)))return!1;e++}return!0},recognize:function(e){var t=s({},e);return c(this.options.enable,[this,t])?(this.state&(dt|lt|ut)&&(this.state=at),this.state=this.process(t),void(this.state&(rt|ot|st|lt)&&this.tryEmit(t))):(this.reset(),void(this.state=ut))},process:function(e){},getTouchAction:function(){},reset:function(){}},l(Z,Y,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,i=e.eventType,n=t&(rt|ot),a=this.attrTest(e);return n&&(i&Ie||!a)?t|lt:n||a?i&Se?t|st:t&rt?t|ot:rt:ut}}),l(J,Z,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ge},getTouchAction:function(){var e=this.options.direction,t=[];return e&De&&t.push(nt),e&Re&&t.push(it),t},directionTest:function(e){var t=this.options,i=!0,n=e.distance,a=e.direction,r=e.deltaX,o=e.deltaY;return a&t.direction||(t.direction&De?(a=0===r?Ce:0>r?Me:Oe,i=r!=this.pX,n=Math.abs(e.deltaX)):(a=0===o?Ce:0>o?Pe:ke,i=o!=this.pY,n=Math.abs(e.deltaY))),e.direction=a,i&&n>t.threshold&&a&t.direction},attrTest:function(e){return Z.prototype.attrTest.call(this,e)&&(this.state&rt||!(this.state&rt)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=X(e.direction);t&&this.manager.emit(this.options.event+t,e),this._super.emit.call(this,e)}}),l($,Z,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[tt]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&rt)},emit:function(e){if(this._super.emit.call(this,e),1!==e.scale){var t=e.scale<1?"in":"out";this.manager.emit(this.options.event+t,e)}}}),l(ee,Y,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[$e]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!n||!i||e.eventType&(Se|Ie)&&!r)this.reset();else if(e.eventType&we)this.reset(),this._timer=a(function(){this.state=dt,this.tryEmit()},t.time,this);else if(e.eventType&Se)return dt;return ut},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===dt&&(e&&e.eventType&Se?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=pe(),this.manager.emit(this.options.event,this._input)))}}),l(te,Z,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[tt]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&rt)}}),l(ie,Z,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:De|Re,pointers:1},getTouchAction:function(){return J.prototype.getTouchAction.call(this)},attrTest:function(e){var t,i=this.options.direction;return i&(De|Re)?t=e.velocity:i&De?t=e.velocityX:i&Re&&(t=e.velocityY),this._super.attrTest.call(this,e)&&i&e.direction&&e.distance>this.options.threshold&&he(t)>this.options.velocity&&e.eventType&Se},emit:function(e){var t=X(e.direction);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),l(ne,Y,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[et]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),e.eventType&we&&0===this.count)return this.failTimeout();if(n&&r&&i){if(e.eventType!=Se)return this.failTimeout();var o=this.pTime?e.timeStamp-this.pTime<t.interval:!0,s=!this.pCenter||R(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,s&&o?this.count+=1:this.count=1,this._input=e;var d=this.count%t.taps;if(0===d)return this.hasRequireFailures()?(this._timer=a(function(){this.state=dt,this.tryEmit()},t.interval,this),rt):dt}return ut},failTimeout:function(){return this._timer=a(function(){this.state=ut},this.options.interval,this),ut},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==dt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ae.VERSION="2.0.4",ae.defaults={domEvents:!1,touchAction:Je,enable:!0,inputTarget:null,inputClass:null,preset:[[te,{enable:!1}],[$,{enable:!1},["rotate"]],[ie,{direction:De}],[J,{direction:De},["swipe"]],[ne],[ne,{event:"doubletap",taps:2},["tap"]],[ee]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ct=1,ht=2;re.prototype={set:function(e){return s(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?ht:ct},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var i,n=this.recognizers,a=t.curRecognizer;(!a||a&&a.state&dt)&&(a=t.curRecognizer=null);for(var r=0;r<n.length;)i=n[r],t.stopped===ht||a&&i!=a&&!i.canRecognizeWith(a)?i.reset():i.recognize(e),!a&&i.state&(rt|ot|st)&&(a=t.curRecognizer=i),r++}},get:function(e){if(e instanceof Y)return e;for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i];return null},add:function(e){if(r(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(r(e,"remove",this))return this;var t=this.recognizers;return e=this.get(e),t.splice(E(t,e),1),this.touchAction.update(),this},on:function(e,t){var i=this.handlers;return o(m(e),function(e){i[e]=i[e]||[],i[e].push(t)}),this},off:function(e,t){var i=this.handlers;return o(m(e),function(e){t?i[e].splice(E(i[e],t),1):delete i[e]}),this},emit:function(e,t){this.options.domEvents&&se(e,t);var i=this.handlers[e]&&this.handlers[e].slice();if(i&&i.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](t),n++}},destroy:function(){this.element&&oe(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},s(ae,{INPUT_START:we,INPUT_MOVE:Le,INPUT_END:Se,INPUT_CANCEL:Ie,STATE_POSSIBLE:at,STATE_BEGAN:rt,STATE_CHANGED:ot,STATE_ENDED:st,STATE_RECOGNIZED:dt,STATE_CANCELLED:lt,STATE_FAILED:ut,DIRECTION_NONE:Ce,DIRECTION_LEFT:Me,DIRECTION_RIGHT:Oe,DIRECTION_UP:Pe,DIRECTION_DOWN:ke,DIRECTION_HORIZONTAL:De,DIRECTION_VERTICAL:Re,DIRECTION_ALL:Ge,Manager:re,Input:w,TouchAction:j,TouchInput:H,MouseInput:x,PointerEventInput:B,TouchMouseInput:z,SingleTouchInput:V,Recognizer:Y,AttrRecognizer:Z,Tap:ne,Pan:J,Swipe:ie,Pinch:$,Rotate:te,Press:ee,on:p,off:f,each:o,merge:d,extend:s,inherit:l,bindFn:u,prefixed:b}),typeof define==ue&&define.amd?define("hammer",[],function(){return ae}):"undefined"!=typeof module&&module.exports?module.exports=ae:e[i]=ae}(window,document,"Hammer"),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("hls_lib",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Hls=e()}}(function(){return function e(t,i,n){function a(o,s){if(!i[o]){if(!t[o]){var d="function"==typeof require&&require;if(!s&&d)return d(o,!0);if(r)return r(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[o]={exports:{}};t[o][0].call(u.exports,function(e){var i=t[o][1][e];return a(i?i:e)},u,u.exports,e,t,i,n)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(e,t,i){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function a(e){return"function"==typeof e}function r(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!r(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,i,n,r,d,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(i=this._events[e],s(i))return!1;if(a(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),i.apply(this,r)}else if(o(i))for(r=Array.prototype.slice.call(arguments,1),l=i.slice(),n=l.length,d=0;n>d;d++)l[d].apply(this,r);return!0},n.prototype.addListener=function(e,t){var i;if(!a(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,a(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(i=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}if(!a(t))throw TypeError("listener must be a function");var n=!1;return i.listener=t,this.on(e,i),this},n.prototype.removeListener=function(e,t){var i,n,r,s;if(!a(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],r=i.length,n=-1,i===t||a(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(i)){for(s=r;s-- >0;)if(i[s]===t||i[s].listener&&i[s].listener===t){n=s;break}if(0>n)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],a(i))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?a(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(a(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(e,t,i){var n=arguments[3],a=arguments[4],r=arguments[5],o=JSON.stringify;t.exports=function(e){for(var t,i=Object.keys(r),s=0,d=i.length;d>s;s++){var l=i[s],u=r[l].exports;if(u===e||u["default"]===e){t=l;break}}if(!t){t=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var c={},s=0,d=i.length;d>s;s++){var l=i[s];c[l]=l}a[t]=[Function(["require","module","exports"],"("+e+")(self)"),c]}var h=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[t]=t,a[h]=[Function(["require"],"var f = require("+o(t)+");(f.default ? f.default : f)(self);"),p];var f="("+n+")({"+Object.keys(a).map(function(e){return o(e)+":["+a[e][0]+","+o(a[e][1])+"]"}).join(",")+"},{},["+o(h)+"])",v=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(v.createObjectURL(new Blob([f],{type:"text/javascript"})))}},{}],3:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=e("../events"),l=n(d),u=e("../event-handler"),c=n(u),h=e("../helper/buffer-helper"),p=n(h),f=e("../errors"),v=e("../utils/logger"),g=e("./ewma-bandwidth-estimator"),m=n(g),E=function(e){function t(e){a(this,t);var i=r(this,Object.getPrototypeOf(t).call(this,e,l["default"].FRAG_LOADING,l["default"].FRAG_LOADED,l["default"].ERROR));return i.lastLoadedFragLevel=0,i._autoLevelCapping=-1,i._nextAutoLevel=-1,i.hls=e,i.onCheck=i.abandonRulesCheck.bind(i),i}return o(t,e),s(t,[{key:"destroy",value:function(){this.clearTimer(),c["default"].prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this.bwEstimator){var t=this.hls,i=e.frag.level,n=t.levels[i].details.live,a=t.config,r=void 0,o=void 0;n?(r=a.abrEwmaFastLive,o=a.abrEwmaSlowLive):(r=a.abrEwmaFastVoD,o=a.abrEwmaSlowVoD),this.bwEstimator=new m["default"](t,o,r)}var s=e.frag;s.trequest=performance.now(),this.fragCurrent=s}},{key:"abandonRulesCheck",value:function(){var e=this.hls,t=e.media,i=this.fragCurrent;if(!i.loader||i.loader.stats&&i.loader.stats.aborted)return v.logger.warn("frag loader destroy or aborted, disarm abandonRulesCheck"),void this.clearTimer();if(t&&(!t.paused||!t.readyState)&&i.autoLevel&&i.level){var n=performance.now()-i.trequest;if(n>500*i.duration){var a=e.levels,r=Math.max(1,1e3*i.loaded/n),o=Math.max(i.loaded,Math.round(i.duration*a[i.level].bitrate/8)),s=t.currentTime,d=(o-i.loaded)/r,u=p["default"].bufferInfo(t,s,e.config.maxBufferHole).end-s;if(u<2*i.duration&&d>u){var c=void 0,h=void 0;for(h=i.level-1;h>=0&&(c=i.duration*a[h].bitrate/(6.4*r),v.logger.log("fragLoadedDelay/bufferStarvationDelay/fragLevelNextLoadedDelay["+h+"] :"+d.toFixed(1)+"/"+u.toFixed(1)+"/"+c.toFixed(1)),!(u>c));h--);d>c&&(h=Math.max(0,h),e.nextLoadLevel=h,this.bwEstimator.sample(n,i.loaded),v.logger.warn("loading too slow, abort fragment loading and switch to level "+h),i.loader.abort(),this.clearTimer(),e.trigger(l["default"].FRAG_LOAD_EMERGENCY_ABORTED,{frag:i}))}}}}},{key:"onFragLoaded",value:function(e){var t=e.stats;void 0===t.aborted&&1===e.frag.loadCounter&&this.bwEstimator.sample(performance.now()-t.trequest,t.loaded),this.clearTimer(),this.lastLoadedFragLevel=e.frag.level,this._nextAutoLevel=-1}},{key:"onError",value:function(e){switch(e.details){case f.ErrorDetails.FRAG_LOAD_ERROR:case f.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}}},{key:"clearTimer",value:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping=e}},{key:"nextAutoLevel",get:function(){var e,t,i=this.hls,n=i.levels,a=i.config;if(t=-1===this._autoLevelCapping&&n&&n.length?n.length-1:this._autoLevelCapping,-1!==this._nextAutoLevel)return Math.min(this._nextAutoLevel,t);var r=this.bwEstimator.getEstimate(),o=void 0;for(e=0;t>=e;e++)if(o=e<=this.lastLoadedFragLevel?a.abrBandWidthFactor*r:a.abrBandWidthUpFactor*r,o<n[e].bitrate)return Math.max(0,e-1);return e-1},set:function(e){this._nextAutoLevel=e}}]),t}(c["default"]);i["default"]=E},{"../errors":21,"../event-handler":22,"../events":23,"../helper/buffer-helper":24,"../utils/logger":38,"./ewma-bandwidth-estimator":6}],4:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=e("../events"),l=n(d),u=e("../event-handler"),c=n(u),h=e("../utils/logger"),p=e("../errors"),f=function(e){function t(e){a(this,t);var i=r(this,Object.getPrototypeOf(t).call(this,e,l["default"].MEDIA_ATTACHING,l["default"].MEDIA_DETACHING,l["default"].BUFFER_RESET,l["default"].BUFFER_APPENDING,l["default"].BUFFER_CODECS,l["default"].BUFFER_EOS,l["default"].BUFFER_FLUSHING,l["default"].LEVEL_UPDATED));return i._msDuration=null,i._levelDuration=null,i.onsbue=i.onSBUpdateEnd.bind(i),i.onsbe=i.onSBUpdateError.bind(i),i}return o(t,e),s(t,[{key:"destroy",value:function(){c["default"].prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function(e){var t=this.media=e.media;if(t){var i=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),i.addEventListener("sourceopen",this.onmso),i.addEventListener("sourceended",this.onmse),i.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(i)}}},{key:"onMediaDetaching",value:function(){var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(t){h.logger.warn("onMediaDetaching:"+t.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc);try{this.media.src="",this.media.removeAttribute("src")}catch(t){h.logger.warn("onMediaDetaching:"+t.message+" while unlinking video.src")}this.mediaSource=null,this.media=null,this.pendingTracks=null,this.sourceBuffer=null}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(l["default"].MEDIA_DETACHED)}},{key:"onMediaSourceOpen",value:function(){h.logger.log("media source opened"),this.hls.trigger(l["default"].MEDIA_ATTACHED,{media:this.media}),this.mediaSource.removeEventListener("sourceopen",this.onmso);var e=this.pendingTracks;e&&(this.onBufferCodecs(e),this.pendingTracks=null,this.doAppending())}},{key:"onMediaSourceClose",value:function(){h.logger.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){h.logger.log("media source ended")}},{key:"onSBUpdateEnd",value:function(){this._needsFlush&&this.doFlush(),this._needsEos&&this.onBufferEos(),this.hls.trigger(l["default"].BUFFER_APPENDED),this.doAppending()}},{key:"onSBUpdateError",value:function(e){h.logger.error("sourceBuffer error:"+e),this.hls.trigger(l["default"].ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferReset",value:function(){var e=this.sourceBuffer;if(e){for(var t in e){var i=e[t];try{this.mediaSource.removeSourceBuffer(i),i.removeEventListener("updateend",this.onsbue),i.removeEventListener("error",this.onsbe)}catch(n){}
}this.sourceBuffer=null}this.flushRange=[],this.appended=0}},{key:"onBufferCodecs",value:function(e){var t=this.mediaSource;if(!t||"open"!==t.readyState)return void(this.pendingTracks=e);if(!this.sourceBuffer){var i={};for(var n in e){var a=e[n],r=a.levelCodec||a.codec,o=a.container+";codecs="+r;h.logger.log("creating sourceBuffer with mimeType:"+o);var s=i[n]=t.addSourceBuffer(o);s.addEventListener("updateend",this.onsbue),s.addEventListener("error",this.onsbe)}this.sourceBuffer=i}}},{key:"onBufferAppending",value:function(e){this.segments?this.segments.push(e):this.segments=[e],this.doAppending()}},{key:"onBufferAppendFail",value:function(e){h.logger.error("sourceBuffer error:"+e.event),this.hls.trigger(l["default"].ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1,frag:this.fragCurrent})}},{key:"onBufferEos",value:function(){var e=this.sourceBuffer,t=this.mediaSource;t&&"open"===t.readyState&&(e.audio&&e.audio.updating||e.video&&e.video.updating?this._needsEos=!0:(h.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment"),t.endOfStream(),this._needsEos=!1))}},{key:"onBufferFlushing",value:function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset}),this.flushBufferCounter=0,this.doFlush()}},{key:"onLevelUpdated",value:function(e){var t=e.details;0!==t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this.updateMediaElementDuration())}},{key:"updateMediaElementDuration",value:function(){if(null!==this._levelDuration){var e=this.media,t=this.mediaSource;if(e&&t&&0!==e.readyState&&"open"===t.readyState){for(var i in t.sourceBuffers)if(t.sourceBuffers[i].updating)return;null===this._msDuration&&(this._msDuration=t.duration),this._levelDuration>this._msDuration&&(h.logger.log("Updating mediasource duration to "+this._levelDuration),t.duration=this._levelDuration,this._msDuration=this._levelDuration)}}}},{key:"doFlush",value:function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,i=this.sourceBuffer;if(i)for(var n in i)t+=i[n].buffered.length;this.appended=t,this.hls.trigger(l["default"].BUFFER_FLUSHED)}}},{key:"doAppending",value:function(){var e=this.hls,t=this.sourceBuffer,i=this.segments;if(t){if(this.media.error)return i=[],void h.logger.error("trying to append although a media error occured, flush segment and abort");for(var n in t)if(t[n].updating)return;if(i.length){var a=i.shift();try{t[a.type].appendBuffer(a.data),this.appendError=0,this.appended++}catch(r){h.logger.error("error while trying to append buffer:"+r.message),i.unshift(a);var o={type:p.ErrorTypes.MEDIA_ERROR};if(22===r.code)return this.segments=[],o.details=p.ErrorDetails.BUFFER_FULL_ERROR,void e.trigger(l["default"].ERROR,o);if(this.appendError?this.appendError++:this.appendError=1,o.details=p.ErrorDetails.BUFFER_APPEND_ERROR,o.frag=this.fragCurrent,this.appendError>e.config.appendErrorMaxRetry)return h.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),i=[],o.fatal=!0,void e.trigger(l["default"].ERROR,o);o.fatal=!1,e.trigger(l["default"].ERROR,o)}}}}},{key:"flushBuffer",value:function(e,t){var i,n,a,r,o,s;if(this.flushBufferCounter<this.appended&&this.sourceBuffer)for(var d in this.sourceBuffer){if(i=this.sourceBuffer[d],i.updating)return h.logger.warn("cannot flush, sb updating in progress"),!1;for(n=0;n<i.buffered.length;n++)if(a=i.buffered.start(n),r=i.buffered.end(n),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&t===Number.POSITIVE_INFINITY?(o=e,s=t):(o=Math.max(a,e),s=Math.min(r,t)),Math.min(s,r)-o>.5)return this.flushBufferCounter++,h.logger.log("flush "+d+" ["+o+","+s+"], of ["+a+","+r+"], pos:"+this.media.currentTime),i.remove(o,s),!1}else h.logger.warn("abort flushing too many retries");return h.logger.log("buffer flushed"),!0}}]),t}(c["default"]);i["default"]=f},{"../errors":21,"../event-handler":22,"../events":23,"../utils/logger":38}],5:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=e("../events"),l=n(d),u=e("../event-handler"),c=n(u),h=function(e){function t(e){return a(this,t),r(this,Object.getPrototypeOf(t).call(this,e,l["default"].MEDIA_ATTACHING,l["default"].MANIFEST_PARSED))}return o(t,e),s(t,[{key:"destroy",value:function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))}},{key:"onMediaAttaching",value:function(e){this.media=e.media instanceof HTMLVideoElement?e.media:null}},{key:"onManifestParsed",value:function(e){this.hls.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=e.levels,this.hls.firstLevel=this.getMaxLevel(e.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:"detectPlayerSize",value:function(){if(this.media){var e=this.levels?this.levels.length:0;e&&(this.hls.autoLevelCapping=this.getMaxLevel(e-1),this.hls.autoLevelCapping>this.autoLevelCapping&&this.hls.streamController.nextLevelSwitch(),this.autoLevelCapping=this.hls.autoLevelCapping)}}},{key:"getMaxLevel",value:function(e){var t=void 0,i=void 0,n=void 0,a=this.mediaWidth,r=this.mediaHeight,o=0,s=0;for(i=0;e>=i&&(n=this.levels[i],t=i,o=n.width,s=n.height,!(o>=a||s>=r));i++);return t}},{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(t){}return e}},{key:"mediaWidth",get:function(){var e=void 0;return this.media&&(e=this.media.width||this.media.clientWidth||this.media.offsetWidth,e*=this.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0;return this.media&&(e=this.media.height||this.media.clientHeight||this.media.offsetHeight,e*=this.contentScaleFactor),e}}]),t}(c["default"]);i["default"]=h},{"../event-handler":22,"../events":23}],6:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("../utils/ewma"),s=n(o),d=function(){function e(t,i,n){a(this,e),this.hls=t,this.defaultEstimate_=5e5,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new s["default"](i),this.fast_=new s["default"](n)}return r(e,[{key:"sample",value:function(e,t){e=Math.max(e,this.minDelayMs_);var i=8e3*t/e,n=e/1e3;this.fast_.sample(n,i),this.slow_.sample(n,i)}},{key:"getEstimate",value:function(){return!this.fast_||this.fast_.getTotalWeight()<this.minWeight_?this.defaultEstimate_:Math.min(this.fast_.getEstimate(),this.slow_.getEstimate())}},{key:"destroy",value:function(){}}]),e}();i["default"]=d},{"../utils/ewma":37}],7:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=e("../events"),l=n(d),u=e("../event-handler"),c=n(u),h=e("../utils/logger"),p=e("../errors"),f=function(e){function t(e){a(this,t);var i=r(this,Object.getPrototypeOf(t).call(this,e,l["default"].MANIFEST_LOADED,l["default"].LEVEL_LOADED,l["default"].ERROR));return i.ontick=i.tick.bind(i),i._manualLevel=i._autoLevelCapping=-1,i}return o(t,e),s(t,[{key:"destroy",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this._manualLevel=-1}},{key:"startLoad",value:function(){this.canload=!0,this.timer&&this.tick()}},{key:"stopLoad",value:function(){this.canload=!1}},{key:"onManifestLoaded",value:function(e){var t,i,n=[],a=[],r={},o=!1,s=!1,d=this.hls;if(e.levels.forEach(function(e){e.videoCodec&&(o=!0),e.audioCodec&&(s=!0);var t=r[e.bitrate];void 0===t?(r[e.bitrate]=n.length,e.url=[e.url],e.urlId=0,n.push(e)):n[t].url.push(e.url)}),o&&s?n.forEach(function(e){e.videoCodec&&a.push(e)}):a=n,a=a.filter(function(e){var t=function(e){return MediaSource.isTypeSupported("audio/mp4;codecs="+e)},i=function(e){return MediaSource.isTypeSupported("video/mp4;codecs="+e)},n=e.audioCodec,a=e.videoCodec;return(!n||t(n))&&(!a||i(a))}),a.length){for(t=a[0].bitrate,a.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=a,i=0;i<a.length;i++)if(a[i].bitrate===t){this._firstLevel=i,h.logger.log("manifest loaded,"+a.length+" level(s) found, first bitrate:"+t);break}d.trigger(l["default"].MANIFEST_PARSED,{levels:this._levels,firstLevel:this._firstLevel,stats:e.stats})}else d.trigger(l["default"].ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:d.url,reason:"no level with compatible codecs found in manifest"})}},{key:"setLevelInternal",value:function(e){var t=this._levels;if(e>=0&&e<t.length){this.timer&&(clearTimeout(this.timer),this.timer=null),this._level=e,h.logger.log("switching to level "+e),this.hls.trigger(l["default"].LEVEL_SWITCH,{level:e});var i=t[e];if(void 0===i.details||i.details.live===!0){h.logger.log("(re)loading playlist for level "+e);var n=i.urlId;this.hls.trigger(l["default"].LEVEL_LOADING,{url:i.url[n],level:e,id:n})}}else this.hls.trigger(l["default"].ERROR,{type:p.ErrorTypes.OTHER_ERROR,details:p.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})}},{key:"onError",value:function(e){if(!e.fatal){var t=e.details,i=this.hls,n=void 0,a=void 0,r=!1;switch(t){case p.ErrorDetails.FRAG_LOAD_ERROR:case p.ErrorDetails.FRAG_LOAD_TIMEOUT:case p.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case p.ErrorDetails.KEY_LOAD_ERROR:case p.ErrorDetails.KEY_LOAD_TIMEOUT:n=e.frag.level;break;case p.ErrorDetails.LEVEL_LOAD_ERROR:case p.ErrorDetails.LEVEL_LOAD_TIMEOUT:n=e.level,r=!0}if(void 0!==n)if(a=this._levels[n],a.urlId<a.url.length-1)a.urlId++,a.details=void 0,h.logger.warn("level controller,"+t+" for level "+n+": switching to redundant stream id "+a.urlId);else{var o=-1===this._manualLevel&&n;o?(h.logger.warn("level controller,"+t+": emergency switch-down for next fragment"),i.abrController.nextAutoLevel=0):a&&a.details&&a.details.live?(h.logger.warn("level controller,"+t+" on live stream, discard"),r&&(this._level=void 0)):t!==p.ErrorDetails.FRAG_LOAD_ERROR&&t!==p.ErrorDetails.FRAG_LOAD_TIMEOUT&&(h.logger.error("cannot recover "+t+" error"),this._level=void 0,this.timer&&(clearTimeout(this.timer),this.timer=null),e.fatal=!0,i.trigger(l["default"].ERROR,e))}}}},{key:"onLevelLoaded",value:function(e){if(e.level===this._level){var t=e.details;if(t.live){var i=1e3*t.targetduration,n=this._levels[e.level],a=n.details;a&&t.endSN===a.endSN&&(i/=2,h.logger.log("same live playlist, reload twice faster")),i-=performance.now()-e.stats.trequest,i=Math.max(1e3,Math.round(i)),h.logger.log("live playlist, reload in "+i+" ms"),this.timer=setTimeout(this.ontick,i)}else this.timer=null}}},{key:"tick",value:function(){var e=this._level;if(void 0!==e&&this.canload){var t=this._levels[e],i=t.urlId;this.hls.trigger(l["default"].LEVEL_LOADING,{url:t.url[i],level:e,id:i})}}},{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this._level},set:function(e){var t=this._levels;t&&t.length>e&&(this._level===e&&void 0!==t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this._manualLevel},set:function(e){this._manualLevel=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){return void 0===this._startLevel?this._firstLevel:this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this._manualLevel?this._manualLevel:this.hls.abrController.nextAutoLevel},set:function(e){this.level=e,-1===this._manualLevel&&(this.hls.abrController.nextAutoLevel=e)}}]),t}(c["default"]);i["default"]=f},{"../errors":21,"../event-handler":22,"../events":23,"../utils/logger":38}],8:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=e("../demux/demuxer"),l=n(d),u=e("../events"),c=n(u),h=e("../event-handler"),p=n(h),f=e("../utils/logger"),v=e("../utils/binary-search"),g=n(v),m=e("../helper/buffer-helper"),E=n(m),y=e("../helper/level-helper"),_=n(y),b=e("../errors"),A={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR"},T=function(e){function t(e){a(this,t);var i=r(this,Object.getPrototypeOf(t).call(this,e,c["default"].MEDIA_ATTACHED,c["default"].MEDIA_DETACHING,c["default"].MANIFEST_LOADING,c["default"].MANIFEST_PARSED,c["default"].LEVEL_LOADED,c["default"].KEY_LOADED,c["default"].FRAG_LOADED,c["default"].FRAG_LOAD_EMERGENCY_ABORTED,c["default"].FRAG_PARSING_INIT_SEGMENT,c["default"].FRAG_PARSING_DATA,c["default"].FRAG_PARSED,c["default"].ERROR,c["default"].BUFFER_APPENDED,c["default"].BUFFER_FLUSHED));return i.config=e.config,i.audioCodecSwap=!1,i.ticks=0,i.ontick=i.tick.bind(i),i}return o(t,e),s(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),p["default"].prototype.destroy.call(this),this.state=A.STOPPED}},{key:"startLoad",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0];if(this.levels){var t=this.media,i=this.lastCurrentTime;this.stopLoad(),this.demuxer=new l["default"](this.hls),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,t&&i?(f.logger.log("configure startPosition @"+i),this.lastPaused||(f.logger.log("resuming video"),t.play()),this.state=A.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=A.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else f.logger.warn("cannot start loading as manifest not parsed yet"),this.state=A.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=A.STOPPED}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){var e,t,i,n=this.hls,a=n.config,r=this.media,o=r&&r.seeking;switch(this.state){case A.ERROR:case A.PAUSED:break;case A.STARTING:var s=n.startLevel;-1===s&&(s=0,this.fragBitrateTest=!0),this.level=n.nextLoadLevel=s,this.state=A.WAITING_LEVEL,this.loadedmetadata=!1;break;case A.IDLE:if(!r&&(this.startFragRequested||!a.startFragPrefetch))break;e=this.loadedmetadata?r.currentTime:this.nextLoadPosition,t=n.nextLoadLevel;var d,l=E["default"].bufferInfo(r,e,a.maxBufferHole),u=l.len,h=l.end,p=this.fragPrevious;if(this.levels[t].hasOwnProperty("bitrate")?(d=Math.max(8*a.maxBufferSize/this.levels[t].bitrate,a.maxBufferLength),d=Math.min(d,a.maxMaxBufferLength)):d=a.maxBufferLength,d>u){if(n.nextLoadLevel=t,this.level=t,i=this.levels[t].details,"undefined"==typeof i||i.live&&this.levelLastLoaded!==t){this.state=A.WAITING_LEVEL;break}var v=i.fragments,m=v.length,y=v[0].start,_=v[m-1].start+v[m-1].duration,T=void 0;if(i.live){var w=void 0!==a.liveMaxLatencyDuration?a.liveMaxLatencyDuration:a.liveMaxLatencyDurationCount*i.targetduration;if(h<Math.max(y,_-w)){var L=void 0!==a.liveSyncDuration?a.liveSyncDuration:a.liveSyncDurationCount*i.targetduration,S=y+Math.max(0,i.totalduration-L);f.logger.log("buffer end: "+h+" is located too far from the end of live sliding playlist, reset currentTime to : "+S.toFixed(3)),h=S,r&&r.readyState&&r.duration>S&&(r.currentTime=S)}if(i.PTSKnown&&h>_)break;if(this.startFragRequested&&!i.PTSKnown){if(p){var I=p.sn+1;I>=i.startSN&&I<=i.endSN&&(T=v[I-i.startSN],f.logger.log("live playlist, switching playlist, load frag with next SN: "+T.sn))}T||(T=v[Math.min(m-1,Math.round(m/2))],f.logger.log("live playlist, switching playlist, unknown, load middle frag : "+T.sn))}}else y>h&&(T=v[0]);if(T||!function(){var e=a.maxFragLookUpTolerance;_>h?((h>_-e||o)&&(e=0),T=g["default"].search(v,function(t){return t.start+t.duration-e<=h?1:t.start-e>h?-1:0})):T=v[m-1]}(),T){if(y=T.start,p&&T.level===p.level&&T.sn===p.sn){if(!(T.sn<i.endSN)){i.live||(this.hls.trigger(c["default"].BUFFER_EOS),o||(this.state=A.ENDED));break}var C=p.deltaPTS,M=T.sn-i.startSN;C&&C>a.maxBufferHole?(T=v[M-1],f.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),p.loadCounter--):(T=v[M+1],f.logger.log("SN just loaded, load next one: "+T.sn))}if(null!=T.decryptdata.uri&&null==T.decryptdata.key)f.logger.log("Loading key for "+T.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+t),this.state=A.KEY_LOADING,n.trigger(c["default"].KEY_LOADING,{frag:T});else{if(f.logger.log("Loading "+T.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+t+", currentTime:"+e+",bufferEnd:"+h.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,T.loadCounter){T.loadCounter++;var O=a.fragLoadingLoopThreshold;if(T.loadCounter>O&&Math.abs(this.fragLoadIdx-T.loadIdx)<O)return void n.trigger(c["default"].ERROR,{type:b.ErrorTypes.MEDIA_ERROR,details:b.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:T})}else T.loadCounter=1;T.loadIdx=this.fragLoadIdx,this.fragCurrent=T,this.startFragRequested=!0,T.autoLevel=n.autoLevelEnabled,n.trigger(c["default"].FRAG_LOADING,{frag:T}),this.state=A.FRAG_LOADING}}}break;case A.WAITING_LEVEL:t=this.levels[this.level],t&&t.details&&(this.state=A.IDLE);break;case A.FRAG_LOADING_WAITING_RETRY:var P=performance.now(),k=this.retryDate;(!k||P>=k||o)&&(f.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=A.IDLE);break;case A.STOPPED:case A.FRAG_LOADING:case A.PARSING:case A.PARSED:case A.ENDED:}this._checkBuffer(),this._checkFragmentChanged()}},{key:"getBufferRange",value:function(e){var t,i,n=this.bufferRange;if(n)for(t=n.length-1;t>=0;t--)if(i=n[t],e>=i.start&&e<=i.end)return i;return null}},{key:"followingBufferRange",value:function(e){return e?this.getBufferRange(e.end+.5):null}},{key:"isBuffered",value:function(e){var t=this.media;if(t)for(var i=t.buffered,n=0;n<i.length;n++)if(e>=i.start(n)&&e<=i.end(n))return!0;return!1}},{key:"_checkFragmentChanged",value:function(){var e,t,i=this.media;if(i&&i.seeking===!1&&(t=i.currentTime,t>i.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=t),this.isBuffered(t)?e=this.getBufferRange(t):this.isBuffered(t+.1)&&(e=this.getBufferRange(t+.1)),e)){var n=e.frag;n!==this.fragPlaying&&(this.fragPlaying=n,this.hls.trigger(c["default"].FRAG_CHANGED,{frag:n}))}}},{key:"immediateLevelSwitch",value:function(){f.logger.log("immediateLevelSwitch"),this.immediateSwitch||(this.immediateSwitch=!0,this.previouslyPaused=this.media.paused,this.media.pause());var e=this.fragCurrent;e&&e.loader&&e.loader.abort(),this.fragCurrent=null,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=A.PAUSED,this.hls.trigger(c["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY})}},{key:"immediateLevelSwitchEnd",value:function(){this.immediateSwitch=!1;var e=this.media;e&&e.readyState&&(e.currentTime-=1e-4,this.previouslyPaused||e.play())}},{key:"nextLevelSwitch",value:function(){var e=this.media;if(e&&e.readyState){var t=void 0,i=void 0,n=void 0;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,i=this.getBufferRange(e.currentTime),i&&i.start>1&&(this.state=A.PAUSED,this.hls.trigger(c["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:i.start-1})),e.paused)t=0;else{var a=this.hls.nextLoadLevel,r=this.levels[a],o=this.fragLastKbps;t=o&&this.fragCurrent?this.fragCurrent.duration*r.bitrate/(1e3*o)+1:0}if(n=this.getBufferRange(e.currentTime+t),n&&(n=this.followingBufferRange(n))){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null,this.state=A.PAUSED,this.hls.trigger(c["default"].BUFFER_FLUSHING,{startOffset:n.start,endOffset:Number.POSITIVE_INFINITY})}}}},{key:"onMediaAttached",value:function(e){var t=this.media=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended),this.levels&&this.config.autoStartLoad&&this.hls.startLoad()}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(f.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){if(this.state===A.FRAG_LOADING){if(0===E["default"].bufferInfo(this.media,this.media.currentTime,this.config.maxBufferHole).len){f.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load");var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.state=A.IDLE}}else this.state===A.ENDED&&(this.state=A.IDLE);this.media&&(this.lastCurrentTime=this.media.currentTime),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()}},{key:"onMediaSeeked",value:function(){this.tick()}},{key:"onMediaEnded",value:function(){f.logger.log("media ended"),this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoading",value:function(){f.logger.log("trigger BUFFER_RESET"),this.hls.trigger(c["default"].BUFFER_RESET),this.bufferRange=[],this.stalled=!1}},{key:"onManifestParsed",value:function(e){var t,i=!1,n=!1;e.levels.forEach(function(e){t=e.audioCodec,t&&(-1!==t.indexOf("mp4a.40.2")&&(i=!0),-1!==t.indexOf("mp4a.40.5")&&(n=!0))}),this.audioCodecSwitch=i&&n,this.audioCodecSwitch&&f.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startLevelLoaded=!1,this.startFragRequested=!1,this.config.autoStartLoad&&this.hls.startLoad()}},{key:"onLevelLoaded",value:function(e){var t=e.details,i=e.level,n=this.levels[i],a=t.totalduration,r=0;if(f.logger.log("level "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+a),this.levelLastLoaded=i,t.live){var o=n.details;o?(_["default"].mergeDetails(o,t),r=t.fragments[0].start,t.PTSKnown?f.logger.log("live playlist sliding:"+r.toFixed(3)):f.logger.log("live playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,f.logger.log("live playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(n.details=t,this.hls.trigger(c["default"].LEVEL_UPDATED,{details:t,level:i}),this.startFragRequested===!1){if(t.live){var s=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;this.startPosition=Math.max(0,r+a-s)}this.nextLoadPosition=this.startPosition}this.state===A.WAITING_LEVEL&&(this.state=A.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===A.KEY_LOADING&&(this.state=A.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent;if(this.state===A.FRAG_LOADING&&t&&e.frag.level===t.level&&e.frag.sn===t.sn)if(f.logger.log("Loaded  "+t.sn+" of level "+t.level),this.fragBitrateTest===!0)this.state=A.IDLE,this.fragBitrateTest=!1,this.startFragRequested=!1,e.stats.tparsed=e.stats.tbuffered=performance.now(),this.hls.trigger(c["default"].FRAG_BUFFERED,{stats:e.stats,frag:t});else{this.state=A.PARSING,this.stats=e.stats;var i=this.levels[this.level],n=i.details,a=n.totalduration,r=void 0!==t.startDTS?t.startDTS:t.start,o=t.level,s=t.sn,d=i.audioCodec||this.config.defaultAudioCodec;this.audioCodecSwap&&(f.logger.log("swapping playlist audio codec"),void 0===d&&(d=this.lastAudioCodec),d&&(d=-1!==d.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingAppending=0,f.logger.log("Demuxing "+s+" of ["+n.startSN+" ,"+n.endSN+"],level "+o);var l=this.demuxer;l&&l.push(e.payload,d,i.videoCodec,r,t.cc,o,s,a,t.decryptdata)}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){if(this.state===A.PARSING){var t,i,n=e.tracks;if(i=n.audio){var a=this.levels[this.level].audioCodec,r=navigator.userAgent.toLowerCase();a&&this.audioCodecSwap&&(f.logger.log("swapping playlist audio codec"),a=-1!==a.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==i.metadata.channelCount&&-1===r.indexOf("firefox")&&(a="mp4a.40.5"),-1!==r.indexOf("android")&&(a="mp4a.40.2",f.logger.log("Android: force audio codec to"+a)),i.levelCodec=a}if(i=n.video,i&&(i.levelCodec=this.levels[this.level].videoCodec),e.unique){var o={codec:"",levelCodec:""};for(t in e.tracks)i=n[t],o.container=i.container,o.codec&&(o.codec+=",",o.levelCodec+=","),i.codec&&(o.codec+=i.codec),i.levelCodec&&(o.levelCodec+=i.levelCodec);n={audiovideo:o}}this.hls.trigger(c["default"].BUFFER_CODECS,n);for(t in n){i=n[t],f.logger.log("track:"+t+",container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var s=i.initSegment;s&&(this.pendingAppending++,this.hls.trigger(c["default"].BUFFER_APPENDING,{type:t,data:s}))}this.tick()}}},{key:"onFragParsingData",value:function(e){var t=this;if(this.state===A.PARSING){this.tparse2=Date.now();var i=this.levels[this.level],n=this.fragCurrent;f.logger.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb);var a=_["default"].updateFragPTSDTS(i.details,n.sn,e.startPTS,e.endPTS,e.startDTS,e.endDTS),r=this.hls;r.trigger(c["default"].LEVEL_PTS_UPDATED,{details:i.details,level:this.level,drift:a}),[e.data1,e.data2].forEach(function(i){i&&(t.pendingAppending++,r.trigger(c["default"].BUFFER_APPENDING,{type:e.type,data:i}))}),this.nextLoadPosition=e.endPTS,this.bufferRange.push({type:e.type,start:e.startPTS,end:e.endPTS,frag:n}),this.tick()}else f.logger.warn("not in PARSING state but "+this.state+", ignoring FRAG_PARSING_DATA event")}},{key:"onFragParsed",value:function(){this.state===A.PARSING&&(this.stats.tparsed=performance.now(),this.state=A.PARSED,this._checkAppendedParsed())}},{key:"onBufferAppended",value:function(){switch(this.state){case A.PARSING:case A.PARSED:this.pendingAppending--,this._checkAppendedParsed()}}},{key:"_checkAppendedParsed",value:function(){if(this.state===A.PARSED&&0===this.pendingAppending){var e=this.fragCurrent,t=this.stats;e&&(this.fragPrevious=e,t.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*t.length/(t.tbuffered-t.tfirst)),this.hls.trigger(c["default"].FRAG_BUFFERED,{stats:t,frag:e}),f.logger.log("media buffered : "+this.timeRangesToString(this.media.buffered)),this.state=A.IDLE),this.tick()}}},{key:"onError",value:function(e){switch(e.details){case b.ErrorDetails.FRAG_LOAD_ERROR:case b.ErrorDetails.FRAG_LOAD_TIMEOUT:if(!e.fatal){var t=this.fragLoadError;if(t?t++:t=1,t<=this.config.fragLoadingMaxRetry){this.fragLoadError=t,e.frag.loadCounter=0;var i=Math.min(Math.pow(2,t-1)*this.config.fragLoadingRetryDelay,64e3);f.logger.warn("mediaController: frag loading failed, retry in "+i+" ms"),this.retryDate=performance.now()+i,this.state=A.FRAG_LOADING_WAITING_RETRY}else f.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.hls.trigger(c["default"].ERROR,e),this.state=A.ERROR}break;case b.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case b.ErrorDetails.LEVEL_LOAD_ERROR:case b.ErrorDetails.LEVEL_LOAD_TIMEOUT:case b.ErrorDetails.KEY_LOAD_ERROR:case b.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==A.ERROR&&(this.state=e.fatal?A.ERROR:A.IDLE,f.logger.warn("mediaController: "+e.details+" while loading frag,switch to "+this.state+" state ..."));break;case b.ErrorDetails.BUFFER_FULL_ERROR:this.state!==A.PARSING&&this.state!==A.PARSED||(this.config.maxMaxBufferLength/=2,f.logger.warn("reduce max buffer length to "+this.config.maxMaxBufferLength+"s and switch to IDLE state"),this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=A.IDLE)}}},{key:"_checkBuffer",value:function(){var e=this.media;if(e&&e.readyState){var t=e.currentTime,i=e.buffered;if(!this.loadedmetadata&&i.length){this.loadedmetadata=!0;var n=this.startPosition;if(!t&&t!==n&&n){f.logger.log("target start position:"+n);var a=i.start(0),r=i.end(0);(a>n||n>r)&&(n=a,f.logger.log("target start position not buffered, seek to buffered.start(0) "+a)),f.logger.log("adjust currentTime from "+t+" to "+n),e.currentTime=n}}else{var o=E["default"].bufferInfo(e,t,0),s=!(e.paused||e.ended||0===e.buffered.length),d=.4,l=t>e.playbackRate*this.lastCurrentTime;if(this.stalled&&l&&(this.stalled=!1,f.logger.log("playback not stuck anymore @"+t)),s&&o.len<=d&&(l?(d=0,this.seekHoleNudgeDuration=0):this.stalled?this.seekHoleNudgeDuration+=this.config.seekHoleNudgeDuration:(this.seekHoleNudgeDuration=0,
f.logger.log("playback seems stuck @"+t),this.hls.trigger(c["default"].ERROR,{type:b.ErrorTypes.MEDIA_ERROR,details:b.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1}),this.stalled=!0),o.len<=d)){var u=o.nextStart,h=u-t;if(u&&h<this.config.maxSeekHole&&h>0){f.logger.log("adjust currentTime from "+e.currentTime+" to next buffered @ "+u+" + nudge "+this.seekHoleNudgeDuration);var p=u+this.seekHoleNudgeDuration-e.currentTime;e.currentTime=u+this.seekHoleNudgeDuration,this.hls.trigger(c["default"].ERROR,{type:b.ErrorTypes.MEDIA_ERROR,details:b.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:p})}}}}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=A.IDLE,this.tick()}},{key:"onBufferFlushed",value:function(){var e,t,i=[];for(t=0;t<this.bufferRange.length;t++)e=this.bufferRange[t],this.isBuffered((e.start+e.end)/2)&&i.push(e);this.bufferRange=i,this.immediateSwitch&&this.immediateLevelSwitchEnd(),this.state=A.IDLE,this.fragPrevious=null}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"timeRangesToString",value:function(e){for(var t="",i=e.length,n=0;i>n;n++)t+="["+e.start(n)+","+e.end(n)+"]";return t}},{key:"currentLevel",get:function(){if(this.media){var e=this.getBufferRange(this.media.currentTime);if(e)return e.frag.level}return-1}},{key:"nextBufferRange",get:function(){return this.media?this.followingBufferRange(this.getBufferRange(this.media.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferRange;return e?e.frag.level:-1}}]),t}(p["default"]);i["default"]=T},{"../demux/demuxer":17,"../errors":21,"../event-handler":22,"../events":23,"../helper/buffer-helper":24,"../helper/level-helper":25,"../utils/binary-search":35,"../utils/logger":38}],9:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=e("../events"),l=n(d),u=e("../event-handler"),c=n(u),h=e("../utils/cea-708-interpreter"),p=n(h),f=function(e){function t(e){a(this,t);var i=r(this,Object.getPrototypeOf(t).call(this,e,l["default"].MEDIA_ATTACHING,l["default"].MEDIA_DETACHING,l["default"].FRAG_PARSING_USERDATA,l["default"].MANIFEST_LOADING,l["default"].FRAG_LOADED));return i.hls=e,i.config=e.config,i.config.enableCEA708Captions&&(i.cea708Interpreter=new p["default"]),i}return o(t,e),s(t,[{key:"destroy",value:function(){c["default"].prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function(e){var t=this.media=e.media;this.cea708Interpreter.attach(t)}},{key:"onMediaDetaching",value:function(){this.cea708Interpreter.detach()}},{key:"onManifestLoading",value:function(){this.lastPts=Number.POSITIVE_INFINITY}},{key:"onFragLoaded",value:function(e){var t=e.frag.start;t<=this.lastPts&&this.cea708Interpreter.clear(),this.lastPts=t}},{key:"onFragParsingUserdata",value:function(e){for(var t=0;t<e.samples.length;t++)this.cea708Interpreter.push(e.samples[t].pts,e.samples[t].bytes)}}]),t}(c["default"]);i["default"]=f},{"../event-handler":22,"../events":23,"../utils/cea-708-interpreter":36}],10:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(t){n(this,e),this._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],this._precompute();var i,a,r,o,s,d=this._tables[0][4],l=this._tables[1],u=t.length,c=1;if(4!==u&&6!==u&&8!==u)throw new Error("Invalid aes key size="+u);for(o=t.slice(0),s=[],this._key=[o,s],i=u;4*u+28>i;i++)r=o[i-1],(i%u===0||8===u&&i%u===4)&&(r=d[r>>>24]<<24^d[r>>16&255]<<16^d[r>>8&255]<<8^d[255&r],i%u===0&&(r=r<<8^r>>>24^c<<24,c=c<<1^283*(c>>7))),o[i]=o[i-u]^r;for(a=0;i;a++,i--)r=o[3&a?i:i-4],4>=i||4>a?s[a]=r:s[a]=l[0][d[r>>>24]]^l[1][d[r>>16&255]]^l[2][d[r>>8&255]]^l[3][d[255&r]]}return a(e,[{key:"_precompute",value:function(){var e,t,i,n,a,r,o,s,d,l=this._tables[0],u=this._tables[1],c=l[4],h=u[4],p=[],f=[];for(e=0;256>e;e++)f[(p[e]=e<<1^283*(e>>7))^e]=e;for(t=i=0;!c[t];t^=n||1,i=f[i]||1)for(o=i^i<<1^i<<2^i<<3^i<<4,o=o>>8^255&o^99,c[t]=o,h[o]=t,r=p[a=p[n=p[t]]],d=16843009*r^65537*a^257*n^16843008*t,s=257*p[o]^16843008*o,e=0;4>e;e++)l[e][t]=s=s<<24^s>>>8,u[e][o]=d=d<<24^d>>>8;for(e=0;5>e;e++)l[e]=l[e].slice(0),u[e]=u[e].slice(0)}},{key:"decrypt",value:function(e,t,i,n,a,r){var o,s,d,l,u=this._key[1],c=e^u[0],h=n^u[1],p=i^u[2],f=t^u[3],v=u.length/4-2,g=4,m=this._tables[1],E=m[0],y=m[1],_=m[2],b=m[3],A=m[4];for(l=0;v>l;l++)o=E[c>>>24]^y[h>>16&255]^_[p>>8&255]^b[255&f]^u[g],s=E[h>>>24]^y[p>>16&255]^_[f>>8&255]^b[255&c]^u[g+1],d=E[p>>>24]^y[f>>16&255]^_[c>>8&255]^b[255&h]^u[g+2],f=E[f>>>24]^y[c>>16&255]^_[h>>8&255]^b[255&p]^u[g+3],g+=4,c=o,h=s,p=d;for(l=0;4>l;l++)a[(3&-l)+r]=A[c>>>24]<<24^A[h>>16&255]<<16^A[p>>8&255]<<8^A[255&f]^u[g++],o=c,c=h,h=p,p=f,f=o}}]),e}();i["default"]=r},{}],11:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("./aes"),s=n(o),d=function(){function e(t,i){a(this,e),this.key=t,this.iv=i}return r(e,[{key:"ntoh",value:function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}},{key:"doDecrypt",value:function(e,t,i){var n,a,r,o,d,l,u,c,h,p=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),f=new s["default"](Array.prototype.slice.call(t)),v=new Uint8Array(e.byteLength),g=new Int32Array(v.buffer);for(n=~~i[0],a=~~i[1],r=~~i[2],o=~~i[3],h=0;h<p.length;h+=4)d=~~this.ntoh(p[h]),l=~~this.ntoh(p[h+1]),u=~~this.ntoh(p[h+2]),c=~~this.ntoh(p[h+3]),f.decrypt(d,l,u,c,g,h),g[h]=this.ntoh(g[h]^n),g[h+1]=this.ntoh(g[h+1]^a),g[h+2]=this.ntoh(g[h+2]^r),g[h+3]=this.ntoh(g[h+3]^o),n=d,a=l,r=u,o=c;return v}},{key:"localDecrypt",value:function(e,t,i,n){var a=this.doDecrypt(e,t,i);n.set(a,e.byteOffset)}},{key:"decrypt",value:function(e){var t=32e3,i=new Int32Array(e),n=new Uint8Array(e.byteLength),a=0,r=this.key,o=this.iv;for(this.localDecrypt(i.subarray(a,a+t),r,o,n),a=t;a<i.length;a+=t)o=new Uint32Array([this.ntoh(i[a-4]),this.ntoh(i[a-3]),this.ntoh(i[a-2]),this.ntoh(i[a-1])]),this.localDecrypt(i.subarray(a,a+t),r,o,n);return n}}]),e}();i["default"]=d},{"./aes":10}],12:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("./aes128-decrypter"),s=n(o),d=e("../errors"),l=e("../utils/logger"),u=function(){function e(t){a(this,e),this.hls=t;try{var i=window?window.crypto:crypto;this.subtle=i.subtle||i.webkitSubtle,this.disableWebCrypto=!this.subtle}catch(n){this.disableWebCrypto=!0}}return r(e,[{key:"destroy",value:function(){}},{key:"decrypt",value:function(e,t,i,n){this.disableWebCrypto&&this.hls.config.enableSoftwareAES?this.decryptBySoftware(e,t,i,n):this.decryptByWebCrypto(e,t,i,n)}},{key:"decryptByWebCrypto",value:function(e,t,i,n){var a=this;l.logger.log("decrypting by WebCrypto API"),this.subtle.importKey("raw",t,{name:"AES-CBC",length:128},!1,["decrypt"]).then(function(r){a.subtle.decrypt({name:"AES-CBC",iv:i.buffer},r,e).then(n)["catch"](function(r){a.onWebCryptoError(r,e,t,i,n)})})["catch"](function(r){a.onWebCryptoError(r,e,t,i,n)})}},{key:"decryptBySoftware",value:function(e,t,i,n){l.logger.log("decrypting by JavaScript Implementation");var a=new DataView(t.buffer),r=new Uint32Array([a.getUint32(0),a.getUint32(4),a.getUint32(8),a.getUint32(12)]);a=new DataView(i.buffer);var o=new Uint32Array([a.getUint32(0),a.getUint32(4),a.getUint32(8),a.getUint32(12)]),d=new s["default"](r,o);n(d.decrypt(e).buffer)}},{key:"onWebCryptoError",value:function(e,t,i,n,a){this.hls.config.enableSoftwareAES?(l.logger.log("disabling to use WebCrypto API"),this.disableWebCrypto=!0,this.decryptBySoftware(t,i,n,a)):(l.logger.error("decrypting error : "+e.message),this.hls.trigger(Event.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))}}]),e}();i["default"]=u},{"../errors":21,"../utils/logger":38,"./aes128-decrypter":11}],13:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("./adts"),s=n(o),d=e("../utils/logger"),l=e("../demux/id3"),u=n(l),c=function(){function e(t,i){a(this,e),this.observer=t,this.remuxerClass=i,this.remuxer=new this.remuxerClass(t),this._aacTrack={container:"audio/adts",type:"audio",id:-1,sequenceNumber:0,samples:[],len:0}}return r(e,[{key:"push",value:function(e,t,i,n,a,r,o,l){var c,h,p,f,v,g,m,E,y,_=this._aacTrack,b=new u["default"](e),A=90*b.timeStamp;for(v=b.length,E=e.length;E-1>v&&(255!==e[v]||240!==(240&e[v+1]));v++);for(_.audiosamplerate||(c=s["default"].getAudioConfig(this.observer,e,v,t),_.config=c.config,_.audiosamplerate=c.samplerate,_.channelCount=c.channelCount,_.codec=c.codec,_.duration=l,d.logger.log("parsed codec:"+_.codec+",rate:"+c.samplerate+",nb channel:"+c.channelCount)),f=0,p=9216e4/_.audiosamplerate;E>v+5&&(g=1&e[v+1]?7:9,h=(3&e[v+3])<<11|e[v+4]<<3|(224&e[v+5])>>>5,h-=g,h>0&&E>=v+g+h);)for(m=A+f*p,y={unit:e.subarray(v+g,v+g+h),pts:m,dts:m},_.samples.push(y),_.len+=h,v+=h+g,f++;E-1>v&&(255!==e[v]||240!==(240&e[v+1]));v++);this.remuxer.remux(this._aacTrack,{samples:[]},{samples:[{pts:A,dts:A,unit:b.payload}]},{samples:[]},n)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,i,n=new u["default"](e);if(n.hasTimeStamp)for(t=n.length,i=e.length;i-1>t;t++)if(255===e[t]&&240===(240&e[t+1]))return!0;return!1}}]),e}();i["default"]=c},{"../demux/id3":19,"../utils/logger":38,"./adts":14}],14:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=e("../utils/logger"),o=e("../errors"),s=function(){function e(){n(this,e)}return a(e,null,[{key:"getAudioConfig",value:function(e,t,i,n){var a,s,d,l,u,c=navigator.userAgent.toLowerCase(),h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return a=((192&t[i+2])>>>6)+1,s=(60&t[i+2])>>>2,s>h.length-1?void e.trigger(Event.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+s}):(l=(1&t[i+2])<<2,l|=(192&t[i+3])>>>6,r.logger.log("manifest codec:"+n+",ADTS data:type:"+a+",sampleingIndex:"+s+"["+h[s]+"Hz],channelConfig:"+l),-1!==c.indexOf("firefox")?s>=6?(a=5,u=new Array(4),d=s-3):(a=2,u=new Array(2),d=s):-1!==c.indexOf("android")?(a=2,u=new Array(2),d=s):(a=5,u=new Array(4),n&&(-1!==n.indexOf("mp4a.40.29")||-1!==n.indexOf("mp4a.40.5"))||!n&&s>=6?d=s-3:((n&&-1!==n.indexOf("mp4a.40.2")&&s>=6&&1===l||!n&&1===l)&&(a=2,u=new Array(2)),d=s)),u[0]=a<<3,u[0]|=(14&s)>>1,u[1]|=(1&s)<<7,u[1]|=l<<3,5===a&&(u[1]|=(14&d)>>1,u[2]=(1&d)<<7,u[2]|=8,u[3]=0),{config:u,samplerate:h[s],channelCount:l,codec:"mp4a.40."+a})}}]),e}();i["default"]=s},{"../errors":21,"../utils/logger":38}],15:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("../events"),s=n(o),d=e("../errors"),l=e("../demux/aacdemuxer"),u=n(l),c=e("../demux/tsdemuxer"),h=n(c),p=e("../remux/mp4-remuxer"),f=n(p),v=e("../remux/passthrough-remuxer"),g=n(v),m=function(){function e(t,i){a(this,e),this.hls=t,this.typeSupported=i}return r(e,[{key:"destroy",value:function(){var e=this.demuxer;e&&e.destroy()}},{key:"push",value:function(e,t,i,n,a,r,o,l){var c=this.demuxer;if(!c){var p=this.hls;if(h["default"].probe(e))c=this.typeSupported.mp2t===!0?new h["default"](p,g["default"]):new h["default"](p,f["default"]);else{if(!u["default"].probe(e))return void p.trigger(s["default"].ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});c=new u["default"](p,f["default"])}this.demuxer=c}c.push(e,t,i,n,a,r,o,l)}}]),e}();i["default"]=m},{"../demux/aacdemuxer":13,"../demux/tsdemuxer":20,"../errors":21,"../events":23,"../remux/mp4-remuxer":32,"../remux/passthrough-remuxer":33}],16:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(i,"__esModule",{value:!0});var a=e("../demux/demuxer-inline"),r=n(a),o=e("../events"),s=n(o),d=e("events"),l=n(d),u=function(e){var t=new l["default"];t.trigger=function(e){for(var i=arguments.length,n=Array(i>1?i-1:0),a=1;i>a;a++)n[a-1]=arguments[a];t.emit.apply(t,[e,e].concat(n))},t.off=function(e){for(var i=arguments.length,n=Array(i>1?i-1:0),a=1;i>a;a++)n[a-1]=arguments[a];t.removeListener.apply(t,[e].concat(n))},e.addEventListener("message",function(i){var n=i.data;switch(n.cmd){case"init":e.demuxer=new r["default"](t,n.typeSupported);break;case"demux":e.demuxer.push(new Uint8Array(n.data),n.audioCodec,n.videoCodec,n.timeOffset,n.cc,n.level,n.sn,n.duration)}}),t.on(s["default"].FRAG_PARSING_INIT_SEGMENT,function(t,i){e.postMessage({event:t,tracks:i.tracks,unique:i.unique})}),t.on(s["default"].FRAG_PARSING_DATA,function(t,i){var n={event:t,type:i.type,startPTS:i.startPTS,endPTS:i.endPTS,startDTS:i.startDTS,endDTS:i.endDTS,data1:i.data1.buffer,data2:i.data2.buffer,nb:i.nb};e.postMessage(n,[n.data1,n.data2])}),t.on(s["default"].FRAG_PARSED,function(t){e.postMessage({event:t})}),t.on(s["default"].ERROR,function(t,i){e.postMessage({event:t,data:i})}),t.on(s["default"].FRAG_PARSING_METADATA,function(t,i){var n={event:t,samples:i.samples};e.postMessage(n)}),t.on(s["default"].FRAG_PARSING_USERDATA,function(t,i){var n={event:t,samples:i.samples};e.postMessage(n)})};i["default"]=u},{"../demux/demuxer-inline":15,"../events":23,events:1}],17:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("../events"),s=n(o),d=e("../demux/demuxer-inline"),l=n(d),u=e("../demux/demuxer-worker"),c=n(u),h=e("../utils/logger"),p=e("../crypt/decrypter"),f=n(p),v=function(){function t(i){a(this,t),this.hls=i;var n={mp4:MediaSource.isTypeSupported("video/mp4"),mp2t:i.config.enableMP2TPassThrough&&MediaSource.isTypeSupported("video/mp2t")};if(i.config.enableWorker&&"undefined"!=typeof Worker){h.logger.log("demuxing in webworker");try{var r=e("webworkify");this.w=r(c["default"]),this.onwmsg=this.onWorkerMessage.bind(this),this.w.addEventListener("message",this.onwmsg),this.w.postMessage({cmd:"init",typeSupported:n})}catch(o){h.logger.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),this.demuxer=new l["default"](i,n)}}else this.demuxer=new l["default"](i,n);this.demuxInitialized=!0}return r(t,[{key:"destroy",value:function(){this.w?(this.w.removeEventListener("message",this.onwmsg),this.w.terminate(),this.w=null):(this.demuxer.destroy(),this.demuxer=null),this.decrypter&&(this.decrypter.destroy(),this.decrypter=null)}},{key:"pushDecrypted",value:function(e,t,i,n,a,r,o,s){this.w?this.w.postMessage({cmd:"demux",data:e,audioCodec:t,videoCodec:i,timeOffset:n,cc:a,level:r,sn:o,duration:s},[e]):this.demuxer.push(new Uint8Array(e),t,i,n,a,r,o,s)}},{key:"push",value:function(e,t,i,n,a,r,o,s,d){if(e.byteLength>0&&null!=d&&null!=d.key&&"AES-128"===d.method){null==this.decrypter&&(this.decrypter=new f["default"](this.hls));var l=this;this.decrypter.decrypt(e,d.key,d.iv,function(e){l.pushDecrypted(e,t,i,n,a,r,o,s)})}else this.pushDecrypted(e,t,i,n,a,r,o,s)}},{key:"onWorkerMessage",value:function(e){var t=e.data;switch(t.event){case s["default"].FRAG_PARSING_INIT_SEGMENT:var i={};i.tracks=t.tracks,i.unique=t.unique,this.hls.trigger(s["default"].FRAG_PARSING_INIT_SEGMENT,i);break;case s["default"].FRAG_PARSING_DATA:this.hls.trigger(s["default"].FRAG_PARSING_DATA,{data1:new Uint8Array(t.data1),data2:new Uint8Array(t.data2),startPTS:t.startPTS,endPTS:t.endPTS,startDTS:t.startDTS,endDTS:t.endDTS,type:t.type,nb:t.nb});break;case s["default"].FRAG_PARSING_METADATA:this.hls.trigger(s["default"].FRAG_PARSING_METADATA,{samples:t.samples});break;case s["default"].FRAG_PARSING_USERDATA:this.hls.trigger(s["default"].FRAG_PARSING_USERDATA,{samples:t.samples});break;default:this.hls.trigger(t.event,t.data)}}}]),t}();i["default"]=v},{"../crypt/decrypter":12,"../demux/demuxer-inline":15,"../demux/demuxer-worker":16,"../events":23,"../utils/logger":38,webworkify:2}],18:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=e("../utils/logger"),o=function(){function e(t){n(this,e),this.data=t,this.bytesAvailable=this.data.byteLength,this.word=0,this.bitsAvailable=0}return a(e,[{key:"loadWord",value:function(){var e=this.data.byteLength-this.bytesAvailable,t=new Uint8Array(4),i=Math.min(4,this.bytesAvailable);if(0===i)throw new Error("no bytes available");t.set(this.data.subarray(e,e+i)),this.word=new DataView(t.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i}},{key:"skipBits",value:function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:"readBits",value:function(e){var t=Math.min(this.bitsAvailable,e),i=this.word>>>32-t;return e>32&&r.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),t=e-t,t>0?i<<t|this.readBits(t):i}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!==(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(e){var t,i,n=8,a=8;for(t=0;e>t;t++)0!==a&&(i=this.readEG(),a=(n+i+256)%256),n=0===a?n:a}},{key:"readSPS",value:function(){var e,t,i,n,a,r,o,s,d,l=0,u=0,c=0,h=0,p=1;if(this.readUByte(),e=this.readUByte(),t=this.readBits(5),this.skipBits(3),i=this.readUByte(),this.skipUEG(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var f=this.readUEG();if(3===f&&this.skipBits(1),this.skipUEG(),this.skipUEG(),this.skipBits(1),this.readBoolean())for(s=3!==f?8:12,d=0;s>d;d++)this.readBoolean()&&(6>d?this.skipScalingList(16):this.skipScalingList(64))}this.skipUEG();var v=this.readUEG();if(0===v)this.readUEG();else if(1===v)for(this.skipBits(1),this.skipEG(),this.skipEG(),n=this.readUEG(),d=0;n>d;d++)this.skipEG();if(this.skipUEG(),this.skipBits(1),a=this.readUEG(),r=this.readUEG(),o=this.readBits(1),0===o&&this.skipBits(1),this.skipBits(1),this.readBoolean()&&(l=this.readUEG(),u=this.readUEG(),c=this.readUEG(),h=this.readUEG()),this.readBoolean()&&this.readBoolean()){var g=void 0,m=this.readUByte();switch(m){case 1:g=[1,1];break;case 2:g=[12,11];break;case 3:g=[10,11];break;case 4:g=[16,11];break;case 5:g=[40,33];break;case 6:g=[24,11];break;case 7:g=[20,11];break;case 8:g=[32,11];break;case 9:g=[80,33];break;case 10:g=[18,11];break;case 11:g=[15,11];break;case 12:g=[64,33];break;case 13:g=[160,99];break;case 14:g=[4,3];break;case 15:g=[3,2];break;case 16:g=[2,1];break;case 255:g=[this.readUByte()<<8|this.readUByte(),this.readUByte()<<8|this.readUByte()]}g&&(p=g[0]/g[1])}return{width:Math.ceil((16*(a+1)-2*l-2*u)*p),height:(2-o)*(r+1)*16-(o?2:4)*(c+h)}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),e}();i["default"]=o},{"../utils/logger":38}],19:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=e("../utils/logger"),o=function(){function e(t){n(this,e),this._hasTimeStamp=!1;for(var i,a,o,s,d,l,u,c,h=0;;)if(u=this.readUTF(t,h,3),h+=3,"ID3"===u)h+=3,i=127&t[h++],a=127&t[h++],o=127&t[h++],s=127&t[h++],d=(i<<21)+(a<<14)+(o<<7)+s,l=h+d,this._parseID3Frames(t,h,l),h=l;else{if("3DI"!==u)return h-=3,c=h,void(c&&(this.hasTimeStamp||r.logger.warn("ID3 tag found, but no timestamp"),this._length=c,this._payload=t.subarray(0,c)));h+=7,r.logger.log("3DI footer found, end: "+h)}}return a(e,[{key:"readUTF",value:function(e,t,i){var n="",a=t,r=t+i;do n+=String.fromCharCode(e[a++]);while(r>a);return n}},{key:"_parseID3Frames",value:function(e,t,i){for(var n,a,o,s,d;i>=t+8;)switch(n=this.readUTF(e,t,4),t+=4,a=e[t++]<<24+e[t++]<<16+e[t++]<<8+e[t++],s=e[t++]<<8+e[t++],o=t,n){case"PRIV":if("com.apple.streaming.transportStreamTimestamp"===this.readUTF(e,t,44)){t+=44,t+=4;var l=1&e[t++];this._hasTimeStamp=!0,d=((e[t++]<<23)+(e[t++]<<15)+(e[t++]<<7)+e[t++])/45,l&&(d+=47721858.84),d=Math.round(d),r.logger.trace("ID3 timestamp found: "+d),this._timeStamp=d}}}},{key:"hasTimeStamp",get:function(){return this._hasTimeStamp}},{key:"timeStamp",get:function(){return this._timeStamp}},{key:"length",get:function(){return this._length}},{key:"payload",get:function(){return this._payload}}]),e}();i["default"]=o},{"../utils/logger":38}],20:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("./adts"),s=n(o),d=e("../events"),l=n(d),u=e("./exp-golomb"),c=n(u),h=e("../utils/logger"),p=e("../errors"),f=function(){function e(t,i){a(this,e),this.observer=t,this.remuxerClass=i,this.lastCC=0,this.remuxer=new this.remuxerClass(t)}return r(e,[{key:"switchLevel",value:function(){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack={container:"video/mp2t",type:"video",id:-1,sequenceNumber:0,samples:[],len:0,nbNalu:0},this._aacTrack={container:"video/mp2t",type:"audio",id:-1,sequenceNumber:0,samples:[],len:0},this._id3Track={type:"id3",id:-1,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:"text",id:-1,sequenceNumber:0,samples:[],len:0},this.aacOverFlow=null,this.aacLastPTS=null,this.avcNaluState=0,this.remuxer.switchLevel()}},{key:"insertDiscontinuity",value:function(){this.switchLevel(),this.remuxer.insertDiscontinuity()}},{key:"push",value:function(e,t,i,n,a,r,o,s){var d,u,c,f,v,g,m,E,y=e.length,_=this.remuxer.passthrough,b=!1;this.audioCodec=t,this.videoCodec=i,this.timeOffset=n,this._duration=s,this.contiguous=!1,a!==this.lastCC&&(h.logger.log("discontinuity detected"),this.insertDiscontinuity(),this.lastCC=a),r!==this.lastLevel?(h.logger.log("level switch detected"),this.switchLevel(),this.lastLevel=r):o===this.lastSN+1&&(this.contiguous=!0),this.lastSN=o;var A=this.pmtParsed,T=this._avcTrack.id,w=this._aacTrack.id,L=this._id3Track.id;for(y-=y%188,f=0;y>f;f+=188)if(71===e[f]){if(v=!!(64&e[f+1]),g=((31&e[f+1])<<8)+e[f+2],m=(48&e[f+3])>>4,m>1){if(E=f+5+e[f+4],E===f+188)continue}else E=f+4;if(A)if(g===T){if(v){if(d&&(this._parseAVCPES(this._parsePES(d)),_&&this._avcTrack.codec&&(-1===w||this._aacTrack.codec)))return void this.remux(e);d={data:[],size:0}}d&&(d.data.push(e.subarray(E,f+188)),d.size+=f+188-E)}else if(g===w){if(v){if(u&&(this._parseAACPES(this._parsePES(u)),_&&this._aacTrack.codec&&(-1===T||this._avcTrack.codec)))return void this.remux(e);u={data:[],size:0}}u&&(u.data.push(e.subarray(E,f+188)),u.size+=f+188-E)}else g===L&&(v&&(c&&this._parseID3PES(this._parsePES(c)),c={data:[],size:0}),c&&(c.data.push(e.subarray(E,f+188)),c.size+=f+188-E));else v&&(E+=e[E]+1),0===g?this._parsePAT(e,E):g===this._pmtId?(this._parsePMT(e,E),A=this.pmtParsed=!0,T=this._avcTrack.id,w=this._aacTrack.id,L=this._id3Track.id,b&&(h.logger.log("reparse from beginning"),b=!1,f=-188)):(h.logger.log("unknown PID found before PAT/PMT"),b=!0)}else this.observer.trigger(l["default"].ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});d&&this._parseAVCPES(this._parsePES(d)),u&&this._parseAACPES(this._parsePES(u)),c&&this._parseID3PES(this._parsePES(c)),this.remux(null)}},{key:"remux",value:function(e){this.remuxer.remux(this._aacTrack,this._avcTrack,this._id3Track,this._txtTrack,this.timeOffset,this.contiguous,e)}},{key:"destroy",value:function(){this.switchLevel(),this._initPTS=this._initDTS=void 0,this._duration=0}},{key:"_parsePAT",value:function(e,t){this._pmtId=(31&e[t+10])<<8|e[t+11]}},{key:"_parsePMT",value:function(e,t){var i,n,a,r;for(i=(15&e[t+1])<<8|e[t+2],n=t+3+i-4,a=(15&e[t+10])<<8|e[t+11],t+=12+a;n>t;){switch(r=(31&e[t+1])<<8|e[t+2],e[t]){case 15:this._aacTrack.id=r;break;case 21:this._id3Track.id=r;break;case 27:this._avcTrack.id=r;break;default:h.logger.log("unkown stream type:"+e[t])}t+=((15&e[t+3])<<8|e[t+4])+5}}},{key:"_parsePES",value:function(e){var t,i,n,a,r,o,s,d,l,u=0,c=e.data;if(t=c[0],n=(t[0]<<16)+(t[1]<<8)+t[2],1===n){for(a=(t[4]<<8)+t[5],i=t[7],192&i&&(s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,s>4294967295&&(s-=8589934592),64&i?(d=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,d>4294967295&&(d-=8589934592)):d=s),r=t[8],l=r+9,e.size-=l,o=new Uint8Array(e.size);c.length;){t=c.shift();var h=t.byteLength;if(l){if(l>h){l-=h;continue}t=t.subarray(l),h-=l,l=0}o.set(t,u),u+=h}return{data:o,pts:s,dts:d,len:a}}return null}},{key:"_parseAVCPES",value:function(e){var t,i,n,a,r=this,o=this._avcTrack,s=o.samples,d=this._parseAVCNALu(e.data),l=[],u=!1,p=!1,f=0;if(0===d.length&&s.length>0){var v=s[s.length-1],g=v.units.units[v.units.units.length-1],m=new Uint8Array(g.data.byteLength+e.data.byteLength);m.set(g.data,0),m.set(e.data,g.data.byteLength),g.data=m,v.units.length+=e.data.byteLength,o.len+=e.data.byteLength}e.data=null;var E="",y=function(){l.length&&((p===!0||o.sps&&(s.length||this.contiguous))&&(i={units:{units:l,length:f},pts:e.pts,dts:e.dts,key:p},s.push(i),o.len+=f,o.nbNalu+=l.length),l=[],f=0)}.bind(this);d.forEach(function(i){switch(i.type){case 1:n=!0,u&&(E+="NDR ");break;case 5:n=!0,u&&(E+="IDR "),p=!0;break;case 6:n=!0,u&&(E+="SEI "),t=new c["default"](i.data),t.readUByte();var s=t.readUByte();if(4===s){var d=0;do d=t.readUByte();while(255===d);var h=t.readUByte();if(181===h){var v=t.readUShort();if(49===v){var g=t.readUInt();if(1195456820===g){var m=t.readUByte();if(3===m){var _=t.readUByte(),b=t.readUByte(),A=31&_,T=[_,b];for(a=0;A>a;a++)T.push(t.readUByte()),T.push(t.readUByte()),T.push(t.readUByte());r._txtTrack.samples.push({type:3,pts:e.pts,bytes:T})}}}}}break;case 7:if(n=!0,u&&(E+="SPS "),!o.sps){t=new c["default"](i.data);var w=t.readSPS();o.width=w.width,o.height=w.height,o.sps=[i.data],o.duration=r._duration;var L=i.data.subarray(1,4),S="avc1.";for(a=0;3>a;a++){var I=L[a].toString(16);I.length<2&&(I="0"+I),S+=I}o.codec=S}break;case 8:n=!0,u&&(E+="PPS "),o.pps||(o.pps=[i.data]);break;case 9:n=!1,u&&(E+="AUD "),y();break;default:n=!1,E+="unknown NAL "+i.type+" "}n&&(l.push(i),f+=i.data.byteLength)}),(u||E.length)&&h.logger.log(E),y()}},{key:"_parseAVCNALu",value:function(e){for(var t,i,n,a,r,o,s=0,d=e.byteLength,l=this.avcNaluState,u=[];d>s;)switch(t=e[s++],l){case 0:0===t&&(l=1);break;case 1:l=0===t?2:0;break;case 2:case 3:if(0===t)l=3;else if(1===t&&d>s){if(a=31&e[s],r)n={data:e.subarray(r,s-l-1),type:o},u.push(n);else{var c=this.avcNaluState;if(c&&4-c>=s){var h=this._avcTrack,p=h.samples;if(p.length){var f=p[p.length-1],v=f.units.units,g=v[v.length-1];g.state&&(g.data=g.data.subarray(0,g.data.byteLength-c),f.units.length-=c,h.len-=c)}}if(i=s-l-1,i>0){var m=this._avcTrack,E=m.samples;if(E.length){var y=E[E.length-1],_=y.units.units,b=_[_.length-1],A=new Uint8Array(b.data.byteLength+i);A.set(b.data,0),A.set(e.subarray(0,i),b.data.byteLength),b.data=A,y.units.length+=i,m.len+=i}}}r=s,o=a,l=0}else l=0}return r&&(n={data:e.subarray(r,d),type:o,state:l},u.push(n),this.avcNaluState=l),u}},{key:"_parseAACPES",value:function(e){var t,i,n,a,r,o,d,u,c,f=this._aacTrack,v=e.data,g=e.pts,m=0,E=this._duration,y=this.audioCodec,_=this.aacOverFlow,b=this.aacLastPTS;if(_){var A=new Uint8Array(_.byteLength+v.byteLength);
A.set(_,0),A.set(v,_.byteLength),v=A}for(r=m,u=v.length;u-1>r&&(255!==v[r]||240!==(240&v[r+1]));r++);if(r){var T,w;if(u-1>r?(T="AAC PES did not start with ADTS header,offset:"+r,w=!1):(T="no ADTS header found in AAC PES",w=!0),this.observer.trigger(l["default"].ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.FRAG_PARSING_ERROR,fatal:w,reason:T}),w)return}if(f.audiosamplerate||(t=s["default"].getAudioConfig(this.observer,v,r,y),f.config=t.config,f.audiosamplerate=t.samplerate,f.channelCount=t.channelCount,f.codec=t.codec,f.duration=E,h.logger.log("parsed codec:"+f.codec+",rate:"+t.samplerate+",nb channel:"+t.channelCount)),a=0,n=9216e4/f.audiosamplerate,_&&b){var L=b+n;Math.abs(L-g)>1&&(h.logger.log("AAC: align PTS for overlapping frames by "+Math.round((L-g)/90)),g=L)}for(;u>r+5&&(o=1&v[r+1]?7:9,i=(3&v[r+3])<<11|v[r+4]<<3|(224&v[r+5])>>>5,i-=o,i>0&&u>=r+o+i);)for(d=g+a*n,c={unit:v.subarray(r+o,r+o+i),pts:d,dts:d},f.samples.push(c),f.len+=i,r+=i+o,a++;u-1>r&&(255!==v[r]||240!==(240&v[r+1]));r++);_=u>r?v.subarray(r,u):null,this.aacOverFlow=_,this.aacLastPTS=d}},{key:"_parseID3PES",value:function(e){this._id3Track.samples.push(e)}}],[{key:"probe",value:function(e){return e.length>=564&&71===e[0]&&71===e[188]&&71===e[376]}}]),e}();i["default"]=f},{"../errors":21,"../events":23,"../utils/logger":38,"./adts":14,"./exp-golomb":18}],21:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",OTHER_ERROR:"otherError"},i.ErrorDetails={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",INTERNAL_EXCEPTION:"internalException"}},{}],22:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=e("./utils/logger"),d=e("./errors"),l=e("./events"),u=n(l),c=function(){function e(t){a(this,e),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var i=arguments.length,n=Array(i>1?i-1:0),r=1;i>r;r++)n[r-1]=arguments[r];this.handledEvents=n,this.useGenericHandler=!0,this.registerListeners()}return o(e,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===r(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if("hlsEventGeneric"===e)throw new Error("Forbidden event name: "+e);this.hls.on(e,this.onEvent)}.bind(this))}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)}.bind(this))}},{key:"onEvent",value:function(e,t){this.onEventGeneric(e,t)}},{key:"onEventGeneric",value:function(e,t){var i=function(e,t){var i="on"+e.replace("hls","");if("function"!=typeof this[i])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")");return this[i].bind(this,t)};try{i.call(this,e,t).call()}catch(n){s.logger.error("internal error happened while processing "+e+":"+n.message),this.hls.trigger(u["default"].ERROR,{type:d.ErrorTypes.OTHER_ERROR,details:d.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:n})}}}]),e}();i["default"]=c},{"./errors":21,"./events":23,"./utils/logger":38}],23:[function(e,t,i){"use strict";t.exports={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVEL_SWITCH:"hlsLevelSwitch",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded"}},{}],24:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(){n(this,e)}return a(e,null,[{key:"bufferInfo",value:function(e,t,i){if(e){var n,a=e.buffered,r=[];for(n=0;n<a.length;n++)r.push({start:a.start(n),end:a.end(n)});return this.bufferedInfo(r,t,i)}return{len:0,start:0,end:0,nextStart:void 0}}},{key:"bufferedInfo",value:function(e,t,i){var n,a,r,o,s,d=[];for(e.sort(function(e,t){var i=e.start-t.start;return i?i:t.end-e.end}),s=0;s<e.length;s++){var l=d.length;if(l){var u=d[l-1].end;e[s].start-u<i?e[s].end>u&&(d[l-1].end=e[s].end):d.push(e[s])}else d.push(e[s])}for(s=0,n=0,a=r=t;s<d.length;s++){var c=d[s].start,h=d[s].end;if(t+i>=c&&h>t)a=c,r=h,n=r-t;else if(c>t+i){o=c;break}}return{len:n,start:a,end:r,nextStart:o}}}]),e}();i["default"]=r},{}],25:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=e("../utils/logger"),o=function(){function e(){n(this,e)}return a(e,null,[{key:"mergeDetails",value:function(t,i){var n,a=Math.max(t.startSN,i.startSN)-i.startSN,o=Math.min(t.endSN,i.endSN)-i.startSN,s=i.startSN-t.startSN,d=t.fragments,l=i.fragments,u=0;if(a>o)return void(i.PTSKnown=!1);for(var c=a;o>=c;c++){var h=d[s+c],p=l[c];u=h.cc-p.cc,isNaN(h.startPTS)||(p.start=p.startPTS=h.startPTS,p.endPTS=h.endPTS,p.duration=h.duration,n=p)}if(u)for(r.logger.log("discontinuity sliding from playlist, take drift into account"),c=0;c<l.length;c++)l[c].cc+=u;if(n)e.updateFragPTSDTS(i,n.sn,n.startPTS,n.endPTS,n.startDTS,n.endDTS);else if(s>=0&&s<d.length){var f=d[s].start;for(c=0;c<l.length;c++)l[c].start+=f}i.PTSKnown=t.PTSKnown}},{key:"updateFragPTSDTS",value:function(t,i,n,a,r,o){var s,d,l,u;if(i<t.startSN||i>t.endSN)return 0;if(s=i-t.startSN,d=t.fragments,l=d[s],!isNaN(l.startPTS)){var c=Math.abs(l.startPTS-n);isNaN(l.deltaPTS)?l.deltaPTS=c:l.deltaPTS=Math.max(c,l.deltaPTS),n=Math.min(n,l.startPTS),a=Math.max(a,l.endPTS),r=Math.min(r,l.startDTS),o=Math.max(o,l.endDTS)}var h=n-l.start;for(l.start=l.startPTS=n,l.endPTS=a,l.startDTS=r,l.endDTS=o,l.duration=a-n,u=s;u>0;u--)e.updatePTS(d,u,u-1);for(u=s;u<d.length-1;u++)e.updatePTS(d,u,u+1);return t.PTSKnown=!0,h}},{key:"updatePTS",value:function(e,t,i){var n=e[t],a=e[i],o=a.startPTS;isNaN(o)?i>t?a.start=n.start+n.duration:a.start=n.start-a.duration:i>t?(n.duration=o-n.start,n.duration<0&&r.logger.error("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):(a.duration=n.start-o,a.duration<0&&r.logger.error("negative duration computed for frag "+a.sn+",level "+a.level+", there should be some duration drift between playlist and fragment!"))}}]),e}();i["default"]=o},{"../utils/logger":38}],26:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("./events"),s=n(o),d=e("./errors"),l=e("./loader/playlist-loader"),u=n(l),c=e("./loader/fragment-loader"),h=n(c),p=e("./controller/abr-controller"),f=n(p),v=e("./controller/buffer-controller"),g=n(v),m=e("./controller/cap-level-controller"),E=n(m),y=e("./controller/stream-controller"),_=n(y),b=e("./controller/level-controller"),A=n(b),T=e("./controller/timeline-controller"),w=n(T),L=e("./utils/logger"),S=e("./utils/xhr-loader"),I=n(S),C=e("events"),M=n(C),O=e("./loader/key-loader"),P=n(O),k=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];a(this,e);var i=e.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var n in i)n in t||(t[n]=i[n]);if(void 0!==t.liveMaxLatencyDurationCount&&t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(t.liveMaxLatencyDuration<=t.liveSyncDuration||void 0===t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');(0,L.enableLogs)(t.debug),this.config=t;var r=this.observer=new M["default"];r.trigger=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;t>n;n++)i[n-1]=arguments[n];r.emit.apply(r,[e,e].concat(i))},r.off=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;t>n;n++)i[n-1]=arguments[n];r.removeListener.apply(r,[e].concat(i))},this.on=r.on.bind(r),this.off=r.off.bind(r),this.trigger=r.trigger.bind(r),this.playlistLoader=new u["default"](this),this.fragmentLoader=new h["default"](this),this.levelController=new A["default"](this),this.abrController=new t.abrController(this),this.bufferController=new t.bufferController(this),this.capLevelController=new t.capLevelController(this),this.streamController=new t.streamController(this),this.timelineController=new t.timelineController(this),this.keyLoader=new P["default"](this)}return r(e,null,[{key:"isSupported",value:function(){return window.MediaSource&&"function"==typeof window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"Events",get:function(){return s["default"]}},{key:"ErrorTypes",get:function(){return d.ErrorTypes}},{key:"ErrorDetails",get:function(){return d.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig||(e.defaultConfig={autoStartLoad:!0,debug:!1,capLevelToPlayerSize:!1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,seekHoleNudgeDuration:.01,stalledInBufferedNudgeThreshold:10,maxFragLookUpTolerance:.2,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,appendErrorMaxRetry:3,loader:I["default"],fLoader:void 0,pLoader:void 0,abrController:f["default"],bufferController:g["default"],capLevelController:E["default"],streamController:_["default"],timelineController:w["default"],enableCEA708Captions:!0,enableMP2TPassThrough:!1,abrEwmaFastLive:5,abrEwmaSlowLive:9,abrEwmaFastVoD:4,abrEwmaSlowVoD:15,abrBandWidthFactor:.8,abrBandWidthUpFactor:.7}),e.defaultConfig},set:function(t){e.defaultConfig=t}}]),r(e,[{key:"destroy",value:function(){L.logger.log("destroy"),this.trigger(s["default"].DESTROYING),this.detachMedia(),this.playlistLoader.destroy(),this.fragmentLoader.destroy(),this.levelController.destroy(),this.abrController.destroy(),this.bufferController.destroy(),this.capLevelController.destroy(),this.streamController.destroy(),this.timelineController.destroy(),this.keyLoader.destroy(),this.url=null,this.observer.removeAllListeners()}},{key:"attachMedia",value:function(e){L.logger.log("attachMedia"),this.media=e,this.trigger(s["default"].MEDIA_ATTACHING,{media:e})}},{key:"detachMedia",value:function(){L.logger.log("detachMedia"),this.trigger(s["default"].MEDIA_DETACHING),this.media=null}},{key:"loadSource",value:function(e){L.logger.log("loadSource:"+e),this.url=e,this.trigger(s["default"].MANIFEST_LOADING,{url:e})}},{key:"startLoad",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0];L.logger.log("startLoad"),this.levelController.startLoad(),this.streamController.startLoad(e)}},{key:"stopLoad",value:function(){L.logger.log("stopLoad"),this.levelController.stopLoad(),this.streamController.stopLoad()}},{key:"swapAudioCodec",value:function(){L.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){L.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)}},{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){L.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){L.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){L.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return this.levelController.firstLevel},set:function(e){L.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){L.logger.log("set startLevel:"+e),this.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this.abrController.autoLevelCapping},set:function(e){L.logger.log("set autoLevelCapping:"+e),this.abrController.autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}}]),e}();i["default"]=k},{"./controller/abr-controller":3,"./controller/buffer-controller":4,"./controller/cap-level-controller":5,"./controller/level-controller":7,"./controller/stream-controller":8,"./controller/timeline-controller":9,"./errors":21,"./events":23,"./loader/fragment-loader":28,"./loader/key-loader":29,"./loader/playlist-loader":30,"./utils/logger":38,"./utils/xhr-loader":40,events:1}],27:[function(e,t,i){"use strict";t.exports=e("./hls.js")["default"]},{"./hls.js":26}],28:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=e("../events"),l=n(d),u=e("../event-handler"),c=n(u),h=e("../errors"),p=function(e){function t(e){return a(this,t),r(this,Object.getPrototypeOf(t).call(this,e,l["default"].FRAG_LOADING))}return o(t,e),s(t,[{key:"destroy",value:function(){this.loader&&(this.loader.destroy(),this.loader=null),c["default"].prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag;this.frag=t,this.frag.loaded=0;var i=this.hls.config;t.loader=this.loader="undefined"!=typeof i.fLoader?new i.fLoader(i):new i.loader(i),this.loader.load(t.url,"arraybuffer",this.loadsuccess.bind(this),this.loaderror.bind(this),this.loadtimeout.bind(this),i.fragLoadingTimeOut,1,0,this.loadprogress.bind(this),t)}},{key:"loadsuccess",value:function(e,t){var i=e.currentTarget.response;t.length=i.byteLength,this.frag.loader=void 0,this.hls.trigger(l["default"].FRAG_LOADED,{payload:i,frag:this.frag,stats:t})}},{key:"loaderror",value:function(e){this.loader&&this.loader.abort(),this.hls.trigger(l["default"].ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:this.frag,response:e})}},{key:"loadtimeout",value:function(){this.loader&&this.loader.abort(),this.hls.trigger(l["default"].ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:this.frag})}},{key:"loadprogress",value:function(e,t){this.frag.loaded=t.loaded,this.hls.trigger(l["default"].FRAG_LOAD_PROGRESS,{frag:this.frag,stats:t})}}]),t}(c["default"]);i["default"]=p},{"../errors":21,"../event-handler":22,"../events":23}],29:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=e("../events"),l=n(d),u=e("../event-handler"),c=n(u),h=e("../errors"),p=function(e){function t(e){a(this,t);var i=r(this,Object.getPrototypeOf(t).call(this,e,l["default"].KEY_LOADING));return i.decryptkey=null,i.decrypturl=null,i}return o(t,e),s(t,[{key:"destroy",value:function(){this.loader&&(this.loader.destroy(),this.loader=null),c["default"].prototype.destroy.call(this)}},{key:"onKeyLoading",value:function(e){var t=this.frag=e.frag,i=t.decryptdata,n=i.uri;if(n!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;t.loader=this.loader=new a.loader(a),this.decrypturl=n,this.decryptkey=null,t.loader.load(n,"arraybuffer",this.loadsuccess.bind(this),this.loaderror.bind(this),this.loadtimeout.bind(this),a.fragLoadingTimeOut,a.fragLoadingMaxRetry,a.fragLoadingRetryDelay,this.loadprogress.bind(this),t)}else this.decryptkey&&(i.key=this.decryptkey,this.hls.trigger(l["default"].KEY_LOADED,{frag:t}))}},{key:"loadsuccess",value:function(e){var t=this.frag;this.decryptkey=t.decryptdata.key=new Uint8Array(e.currentTarget.response),t.loader=void 0,this.hls.trigger(l["default"].KEY_LOADED,{frag:t})}},{key:"loaderror",value:function(e){this.loader&&this.loader.abort(),this.hls.trigger(l["default"].ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:this.frag,response:e})}},{key:"loadtimeout",value:function(){this.loader&&this.loader.abort(),this.hls.trigger(l["default"].ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:this.frag})}},{key:"loadprogress",value:function(){}}]),t}(c["default"]);i["default"]=p},{"../errors":21,"../event-handler":22,"../events":23}],30:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=e("../events"),l=n(d),u=e("../event-handler"),c=n(u),h=e("../errors"),p=e("../utils/url"),f=n(p),v=e("../utils/attr-list"),g=n(v),m=function(e){function t(e){return a(this,t),r(this,Object.getPrototypeOf(t).call(this,e,l["default"].MANIFEST_LOADING,l["default"].LEVEL_LOADING))}return o(t,e),s(t,[{key:"destroy",value:function(){this.loader&&(this.loader.destroy(),this.loader=null),this.url=this.id=null,c["default"].prototype.destroy.call(this)}},{key:"onManifestLoading",value:function(e){this.load(e.url,null)}},{key:"onLevelLoading",value:function(e){this.load(e.url,e.level,e.id)}},{key:"load",value:function(e,t,i){var n,a,r,o=this.hls.config;if(this.loading&&this.loader){if(this.url===e&&this.id===t&&this.id2===i)return;this.loader.abort()}this.url=e,this.id=t,this.id2=i,null===this.id?(n=o.manifestLoadingMaxRetry,a=o.manifestLoadingTimeOut,r=o.manifestLoadingRetryDelay):(n=o.levelLoadingMaxRetry,a=o.levelLoadingTimeOut,r=o.levelLoadingRetryDelay),this.loader="undefined"!=typeof o.pLoader?new o.pLoader(o):new o.loader(o),this.loading=!0,this.loader.load(e,"",this.loadsuccess.bind(this),this.loaderror.bind(this),this.loadtimeout.bind(this),a,n,r)}},{key:"resolve",value:function(e,t){return f["default"].buildAbsoluteURL(t,e)}},{key:"parseMasterPlaylist",value:function(e,t){for(var i=[],n=void 0,a=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g;null!=(n=a.exec(e));){var r={},o=r.attrs=new g["default"](n[1]);r.url=this.resolve(n[2],t);var s=o.decimalResolution("RESOLUTION");s&&(r.width=s.width,r.height=s.height),r.bitrate=o.decimalInteger("AVERAGE-BANDWIDTH")||o.decimalInteger("BANDWIDTH"),r.name=o.NAME;var d=o.CODECS;if(d){d=d.split(",");for(var l=0;l<d.length;l++){var u=d[l];-1!==u.indexOf("avc1")?r.videoCodec=this.avc1toavcoti(u):r.audioCodec=u}}i.push(r)}return i}},{key:"avc1toavcoti",value:function(e){var t,i=e.split(".");return i.length>2?(t=i.shift()+".",t+=parseInt(i.shift()).toString(16),t+=("000"+parseInt(i.shift()).toString(16)).substr(-4)):t=e,t}},{key:"cloneObj",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"parseLevelPlaylist",value:function(e,t,i){var n,a,r,o,s=0,d=0,l={url:t,fragments:[],live:!0,startSN:0},u={method:null,key:null,iv:null,uri:null},c=0,h=null,p=null;for(a=/(?:#EXT-X-(MEDIA-SEQUENCE):(\d+))|(?:#EXT-X-(TARGETDURATION):(\d+))|(?:#EXT-X-(KEY):(.*))|(?:#EXT(INF):([\d\.]+)[^\r\n]*([\r\n]+[^#|\r\n]+)?)|(?:#EXT-X-(BYTERANGE):([\d]+[@[\d]*)]*[\r\n]+([^#|\r\n]+)?|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(PROGRAM-DATE-TIME):(.*)[\r\n]+([^#|\r\n]+)?)/g;null!==(n=a.exec(e));)switch(n.shift(),n=n.filter(function(e){return void 0!==e}),n[0]){case"MEDIA-SEQUENCE":s=l.startSN=parseInt(n[1]);break;case"TARGETDURATION":l.targetduration=parseFloat(n[1]);break;case"ENDLIST":l.live=!1;break;case"DIS":c++;break;case"BYTERANGE":var f=n[1].split("@");o=1===f.length?r:parseInt(f[1]),r=parseInt(f[0])+o,p&&!p.url&&(p.byteRangeStartOffset=o,p.byteRangeEndOffset=r,p.url=this.resolve(n[2],t));break;case"INF":var v=parseFloat(n[1]);if(!isNaN(v)){var m,E=s++;if(u.method&&u.uri&&!u.iv){m=this.cloneObj(u);for(var y=new Uint8Array(16),_=12;16>_;_++)y[_]=E>>8*(15-_)&255;m.iv=y}else m=u;var b=n[2]?this.resolve(n[2],t):null;p={url:b,duration:v,start:d,sn:E,level:i,cc:c,byteRangeStartOffset:o,byteRangeEndOffset:r,decryptdata:m,programDateTime:h},l.fragments.push(p),d+=v,o=null,h=null}break;case"KEY":var A=n[1],T=new g["default"](A),w=T.enumeratedString("METHOD"),L=T.URI,S=T.hexadecimalInteger("IV");w&&(u={method:null,key:null,iv:null,uri:null},L&&"AES-128"===w&&(u.method=w,u.uri=this.resolve(L,t),u.key=null,u.iv=S));break;case"PROGRAM-DATE-TIME":h=new Date(Date.parse(n[1])),p&&!p.url&&n.length>=3&&(p.url=this.resolve(n[2],t),p.programDateTime=h)}return p&&!p.url&&(l.fragments.pop(),d-=p.duration),l.totalduration=d,l.endSN=s-1,l}},{key:"loadsuccess",value:function(e,t){var i,n=e.currentTarget,a=n.responseText,r=n.responseURL,o=this.id,s=this.id2,d=this.hls;if(this.loading=!1,void 0===r&&(r=this.url),t.tload=performance.now(),t.mtime=new Date(n.getResponseHeader("Last-Modified")),0===a.indexOf("#EXTM3U"))if(a.indexOf("#EXTINF:")>0)if(null===this.id)d.trigger(l["default"].MANIFEST_LOADED,{levels:[{url:r}],url:r,stats:t});else{var u=this.parseLevelPlaylist(a,r,o);t.tparsed=performance.now(),d.trigger(l["default"].LEVEL_LOADED,{details:u,level:o,id:s,stats:t})}else i=this.parseMasterPlaylist(a,r),i.length?d.trigger(l["default"].MANIFEST_LOADED,{levels:i,url:r,stats:t}):d.trigger(l["default"].ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:r,reason:"no level found in manifest"});else d.trigger(l["default"].ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:r,reason:"no EXTM3U delimiter"})}},{key:"loaderror",value:function(e){var t,i;null===this.id?(t=h.ErrorDetails.MANIFEST_LOAD_ERROR,i=!0):(t=h.ErrorDetails.LEVEL_LOAD_ERROR,i=!1),this.loader&&this.loader.abort(),this.loading=!1,this.hls.trigger(l["default"].ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:t,fatal:i,url:this.url,loader:this.loader,response:e.currentTarget,level:this.id,id:this.id2})}},{key:"loadtimeout",value:function(){var e,t;null===this.id?(e=h.ErrorDetails.MANIFEST_LOAD_TIMEOUT,t=!0):(e=h.ErrorDetails.LEVEL_LOAD_TIMEOUT,t=!1),this.loader&&this.loader.abort(),this.loading=!1,this.hls.trigger(l["default"].ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:e,fatal:t,url:this.url,loader:this.loader,level:this.id,id:this.id2})}}]),t}(c["default"]);i["default"]=m},{"../errors":21,"../event-handler":22,"../events":23,"../utils/attr-list":34,"../utils/url":39}],31:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(){n(this,e)}return a(e,null,[{key:"init",value:function(){e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var t;for(t in e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:i,audio:n};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=r,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,d,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,a))}},{key:"box",value:function(e){for(var t,i=Array.prototype.slice.call(arguments,1),n=8,a=i.length,r=a;a--;)n+=i[a].byteLength;for(t=new Uint8Array(n),t[0]=n>>24&255,t[1]=n>>16&255,t[2]=n>>8&255,t[3]=255&n,t.set(e,4),a=0,n=8;r>a;a++)t.set(i[a],n),n+=i[a].byteLength;return t}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"mdhd",value:function(t,i){return i*=t,e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"minf",value:function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:"moof",value:function(t,i,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,i))}},{key:"moov",value:function(t){for(var i=t.length,n=[];i--;)n[i]=e.trak(t[i]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(n).concat(e.mvex(t)))}},{key:"mvex",value:function(t){for(var i=t.length,n=[];i--;)n[i]=e.trex(t[i]);return e.box.apply(null,[e.types.mvex].concat(n))}},{key:"mvhd",value:function(t,i){i*=t;var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24&255,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,n)}},{key:"sdtp",value:function(t){var i,n,a=t.samples||[],r=new Uint8Array(4+a.length);for(n=0;n<a.length;n++)i=a[n].flags,
r[n+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return e.box(e.types.sdtp,r)}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:"avc1",value:function(t){var i,n,a,r=[],o=[];for(i=0;i<t.sps.length;i++)n=t.sps[i],a=n.byteLength,r.push(a>>>8&255),r.push(255&a),r=r.concat(Array.prototype.slice.call(n));for(i=0;i<t.pps.length;i++)n=t.pps[i],a=n.byteLength,o.push(a>>>8&255),o.push(255&a),o=o.concat(Array.prototype.slice.call(n));var s=e.box(e.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|t.sps.length].concat(r).concat([t.pps.length]).concat(o))),d=t.width,l=t.height;return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,255&d,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}},{key:"esds",value:function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}},{key:"mp4a",value:function(t){var i=t.audiosamplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]),e.box(e.types.esds,e.esds(t)))}},{key:"stsd",value:function(t){return"audio"===t.type?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}},{key:"tkhd",value:function(t){var i=t.id,n=t.duration*t.timescale,a=t.width,r=t.height;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,r>>8&255,255&r,0,0]))}},{key:"traf",value:function(t,i){var n=e.sdtp(t),a=t.id;return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),e.box(e.types.tfdt,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),e.trun(t,n.length+16+16+8+16+8+8),n)}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"trex",value:function(t){var i=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,i){var n,a,r,o,s,d,l=t.samples||[],u=l.length,c=12+16*u,h=new Uint8Array(c);for(i+=8+c,h.set([0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0),n=0;u>n;n++)a=l[n],r=a.duration,o=a.size,s=a.flags,d=a.cts,h.set([r>>>24&255,r>>>16&255,r>>>8&255,255&r,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,d>>>24&255,d>>>16&255,d>>>8&255,255&d],12+16*n);return e.box(e.types.trun,h)}},{key:"initSegment",value:function(t){e.types||e.init();var i,n=e.moov(t);return i=new Uint8Array(e.FTYP.byteLength+n.byteLength),i.set(e.FTYP),i.set(n,e.FTYP.byteLength),i}}]),e}();i["default"]=r},{}],32:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("../events"),s=n(o),d=e("../utils/logger"),l=e("../remux/mp4-generator"),u=n(l),c=e("../errors"),h=function(){function e(t){a(this,e),this.observer=t,this.ISGenerated=!1,this.PES2MP4SCALEFACTOR=4,this.PES_TIMESCALE=9e4,this.MP4_TIMESCALE=this.PES_TIMESCALE/this.PES2MP4SCALEFACTOR}return r(e,[{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){this._initPTS=this._initDTS=void 0}},{key:"switchLevel",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,i,n,a,r){this.ISGenerated||this.generateIS(e,t,a),this.ISGenerated&&(t.samples.length&&this.remuxVideo(t,a,r),e.samples.length&&this.remuxAudio(e,a,r)),i.samples.length&&this.remuxID3(i,a),n.samples.length&&this.remuxText(n,a),this.observer.trigger(s["default"].FRAG_PARSED)}},{key:"generateIS",value:function(e,t,i){var n,a,r=this.observer,o=e.samples,l=t.samples,h=this.PES_TIMESCALE,p={},f={tracks:p,unique:!1},v=void 0===this._initPTS;v&&(n=a=1/0),e.config&&o.length&&(e.timescale=e.audiosamplerate,e.timescale*e.duration>Math.pow(2,32)&&!function(){var t=function i(e,t){return t?i(t,e%t):e};e.timescale=e.audiosamplerate/t(e.audiosamplerate,1024)}(),d.logger.log("audio mp4 timescale :"+e.timescale),p.audio={container:"audio/mp4",codec:e.codec,initSegment:u["default"].initSegment([e]),metadata:{channelCount:e.channelCount}},v&&(n=a=o[0].pts-h*i)),t.sps&&t.pps&&l.length&&(t.timescale=this.MP4_TIMESCALE,p.video={container:"video/mp4",codec:t.codec,initSegment:u["default"].initSegment([t]),metadata:{width:t.width,height:t.height}},v&&(n=Math.min(n,l[0].pts-h*i),a=Math.min(a,l[0].dts-h*i))),Object.keys(p).length?(r.trigger(s["default"].FRAG_PARSING_INIT_SEGMENT,f),this.ISGenerated=!0,v&&(this._initPTS=n,this._initDTS=a)):r.trigger(s["default"].ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxVideo",value:function(e,t,i){var n,a,r,o,l,c,h,p,f,v,g,m,E,y,_,b=8,A=this.PES_TIMESCALE,T=this.PES2MP4SCALEFACTOR,w=[],L=e.samples.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);for(0>L&&d.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(L/90)+" ms to overcome this issue"),c=new Uint8Array(e.len+4*e.nbNalu+8),n=new DataView(c.buffer),n.setUint32(0,c.byteLength),c.set(u["default"].types.mdat,4);e.samples.length;){for(a=e.samples.shift(),o=0;a.units.units.length;)l=a.units.units.shift(),n.setUint32(b,l.data.byteLength),b+=4,c.set(l.data,b),b+=l.data.byteLength,o+=4+l.data.byteLength;if(g=a.pts-this._initDTS,m=a.dts-this._initDTS+L,m=Math.min(g,m),void 0!==v){E=this._PTSNormalize(g,v),y=this._PTSNormalize(m,v);var S=(y-v)/T;0>=S&&(d.logger.log("invalid sample duration at PTS/DTS: "+a.pts+"/"+a.dts+":"+S),S=1),r.duration=S}else{var I=void 0,C=void 0;I=i?this.nextAvcDts:t*A,E=this._PTSNormalize(g,I),y=this._PTSNormalize(m,I),C=Math.round((y-I)/90),i&&C&&(C>1?d.logger.log("AVC:"+C+" ms hole between fragments detected,filling it"):-1>C&&d.logger.log("AVC:"+-C+" ms overlapping between fragments detected"),y=I,E=Math.max(E-C,y),d.logger.log("Video/PTS/DTS adjusted: "+E+"/"+y+",delta:"+C)),p=Math.max(0,E),f=Math.max(0,y)}r={size:o,duration:0,cts:(E-y)/T,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0}},_=r.flags,a.key===!0?(_.dependsOn=2,_.isNonSync=0):(_.dependsOn=1,_.isNonSync=1),w.push(r),v=y}var M=0;w.length>=2&&(M=w[w.length-2].duration,r.duration=M),this.nextAvcDts=y+M*T,e.len=0,e.nbNalu=0,w.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_=w[0].flags,_.dependsOn=2,_.isNonSync=0),e.samples=w,h=u["default"].moof(e.sequenceNumber++,f/T,e),e.samples=[],this.observer.trigger(s["default"].FRAG_PARSING_DATA,{data1:h,data2:c,startPTS:p/A,endPTS:(E+T*M)/A,startDTS:f/A,endDTS:this.nextAvcDts/A,type:"video",nb:w.length})}},{key:"remuxAudio",value:function(e,t,i){var n,a,r,o,l,c,h,p,f,v,g,m,E,y=8,_=this.PES_TIMESCALE,b=e.timescale,A=_/b,T=1024*e.timescale/e.audiosamplerate,w=[],L=[];for(e.samples.sort(function(e,t){return e.pts-t.pts}),L=e.samples;L.length;){if(a=L.shift(),o=a.unit,v=a.pts-this._initDTS,g=a.dts-this._initDTS,void 0!==f)m=this._PTSNormalize(v,f),E=this._PTSNormalize(g,f),r.duration=(E-f)/A,Math.abs(r.duration-T)>T/10&&d.logger.log("invalid AAC sample duration at PTS "+Math.round(v/90)+",should be 1024,found :"+Math.round(r.duration*e.audiosamplerate/e.timescale)),r.duration=T,m=E=T*A+f;else{var S=void 0,I=void 0;if(S=i?this.nextAacPts:t*_,m=this._PTSNormalize(v,S),E=this._PTSNormalize(g,S),I=Math.round(1e3*(m-S)/_),i&&I){if(I>0)d.logger.log(I+" ms hole between AAC samples detected,filling it");else if(-12>I){d.logger.log(-I+" ms overlapping between AAC samples detected, drop frame"),e.len-=o.byteLength;continue}m=E=S}if(h=Math.max(0,m),p=Math.max(0,E),!(e.len>0))return;l=new Uint8Array(e.len+8),n=new DataView(l.buffer),n.setUint32(0,l.byteLength),l.set(u["default"].types.mdat,4)}l.set(o,y),y+=o.byteLength,r={size:o.byteLength,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},w.push(r),f=E}var C=0,M=w.length;M>=2&&(C=w[M-2].duration,r.duration=C),M&&(this.nextAacPts=m+A*C,e.len=0,e.samples=w,c=u["default"].moof(e.sequenceNumber++,p/A,e),e.samples=[],this.observer.trigger(s["default"].FRAG_PARSING_DATA,{data1:c,data2:l,startPTS:h/_,endPTS:this.nextAacPts/_,startDTS:p/_,endDTS:(E+A*C)/_,type:"audio",nb:M}))}},{key:"remuxID3",value:function(e,t){var i,n=e.samples.length;if(n){for(var a=0;n>a;a++)i=e.samples[a],i.pts=(i.pts-this._initPTS)/this.PES_TIMESCALE,i.dts=(i.dts-this._initDTS)/this.PES_TIMESCALE;this.observer.trigger(s["default"].FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[],t=t}},{key:"remuxText",value:function(e,t){e.samples.sort(function(e,t){return e.pts-t.pts});var i,n=e.samples.length;if(n){for(var a=0;n>a;a++)i=e.samples[a],i.pts=(i.pts-this._initPTS)/this.PES_TIMESCALE;this.observer.trigger(s["default"].FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[],t=t}},{key:"_PTSNormalize",value:function(e,t){var i;if(void 0===t)return e;for(i=e>t?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=i;return e}},{key:"passthrough",get:function(){return!1}}]),e}();i["default"]=h},{"../errors":21,"../events":23,"../remux/mp4-generator":31,"../utils/logger":38}],33:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("../events"),s=n(o),d=function(){function e(t){a(this,e),this.observer=t,this.ISGenerated=!1}return r(e,[{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){}},{key:"switchLevel",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,i,n,a,r){var o=this.observer;if(!this.ISGenerated){var d={},l={tracks:d,unique:!0},u=t,c=u.codec;c&&(l.tracks.video={container:u.container,codec:c,metadata:{width:u.width,height:u.height}}),u=e,c=u.codec,c&&(l.tracks.audio={container:u.container,codec:c,metadata:{channelCount:u.channelCount}}),this.ISGenerated=!0,o.trigger(s["default"].FRAG_PARSING_INIT_SEGMENT,l)}o.trigger(s["default"].FRAG_PARSING_DATA,{data1:r,startPTS:a,startDTS:a,type:"audiovideo",nb:1})}},{key:"passthrough",get:function(){return!0}}]),e}();i["default"]=d},{"../events":23}],34:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(t){n(this,e),"string"==typeof t&&(t=e.parseAttrList(t));for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i])}return a(e,[{key:"decimalInteger",value:function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"hexadecimalInteger",value:function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var i=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)i[n]=parseInt(t.slice(2*n,2*n+2),16);return i}return null}},{key:"hexadecimalIntegerAsNumber",value:function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"decimalFloatingPoint",value:function(e){return parseFloat(this[e])}},{key:"enumeratedString",value:function(e){return this[e]}},{key:"decimalResolution",value:function(e){var t=/^(\d+)x(\d+)$/.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}}],[{key:"parseAttrList",value:function(e){for(var t,i=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,n={};null!==(t=i.exec(e));){var a=t[2],r='"';0===a.indexOf(r)&&a.lastIndexOf(r)===a.length-1&&(a=a.slice(1,-1)),n[t[1]]=a}return n}}]),e}();i["default"]=r},{}],35:[function(e,t,i){"use strict";var n={search:function(e,t){for(var i=0,n=e.length-1,a=null,r=null;n>=i;){a=(i+n)/2|0,r=e[a];var o=t(r);if(o>0)i=a+1;else{if(!(0>o))return r;n=a-1}}return null}};t.exports=n},{}],36:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(){n(this,e)}return a(e,[{key:"attach",value:function(e){this.media=e,this.display=[],this.memory=[]}},{key:"detach",value:function(){this.clear()}},{key:"destroy",value:function(){}},{key:"_createCue",value:function(){var e=window.VTTCue||window.TextTrackCue,t=this.cue=new e(-1,-1,"");t.text="",t.pauseOnExit=!1,t.startTime=Number.MAX_VALUE,t.endTime=Number.MAX_VALUE,this.memory.push(t)}},{key:"clear",value:function(){var e=this._textTrack;if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}},{key:"push",value:function(e,t){this.cue||this._createCue();for(var i,n,a,r,o,s=31&t[0],d=2,l=0;s>l;l++)if(i=t[d++],n=127&t[d++],a=127&t[d++],r=0!==(4&i),o=3&i,(0!==n||0!==a)&&r&&0===o){if(32&n||64&n)this.cue.text+=this._fromCharCode(n)+this._fromCharCode(a);else if((17===n||25===n)&&a>=48&&63>=a)switch(a){case 48:this.cue.text+="®";break;case 49:this.cue.text+="°";break;case 50:this.cue.text+="½";break;case 51:this.cue.text+="¿";break;case 52:this.cue.text+="™";break;case 53:this.cue.text+="¢";break;case 54:this.cue.text+="";break;case 55:this.cue.text+="£";break;case 56:this.cue.text+="♪";break;case 57:this.cue.text+=" ";break;case 58:this.cue.text+="è";break;case 59:this.cue.text+="â";break;case 60:this.cue.text+="ê";break;case 61:this.cue.text+="î";break;case 62:this.cue.text+="ô";break;case 63:this.cue.text+="û"}if((17===n||25===n)&&a>=32&&47>=a)switch(a){case 32:break;case 33:break;case 34:break;case 35:break;case 36:break;case 37:break;case 38:break;case 39:break;case 40:break;case 41:break;case 42:break;case 43:break;case 44:break;case 45:break;case 46:break;case 47:}if((20===n||28===n)&&a>=32&&47>=a)switch(a){case 32:this._clearActiveCues(e);break;case 33:this.cue.text=this.cue.text.substr(0,this.cue.text.length-1);break;case 34:break;case 35:break;case 36:break;case 37:break;case 38:break;case 39:break;case 40:break;case 41:this._clearActiveCues(e);break;case 42:break;case 43:break;case 44:this._clearActiveCues(e);break;case 45:break;case 46:this._text="";break;case 47:this._flipMemory(e)}if((23===n||31===n)&&a>=33&&35>=a)switch(a){case 33:break;case 34:break;case 35:}}}},{key:"_fromCharCode",value:function(e){switch(e){case 42:return"á";case 2:return"á";case 2:return"é";case 4:return"í";case 5:return"ó";case 6:return"ú";case 3:return"ç";case 4:return"÷";case 5:return"Ñ";case 6:return"ñ";case 7:return"█";default:return String.fromCharCode(e)}}},{key:"_flipMemory",value:function(e){this._clearActiveCues(e),this._flushCaptions(e)}},{key:"_flushCaptions",value:function(e){this._has708||(this._textTrack=this.media.addTextTrack("captions","English","en"),this._has708=!0);var t=!0,i=!1,n=void 0;try{for(var a,r=this.memory[Symbol.iterator]();!(t=(a=r.next()).done);t=!0){var o=a.value;o.startTime=e,this._textTrack.addCue(o),this.display.push(o)}}catch(s){i=!0,n=s}finally{try{!t&&r["return"]&&r["return"]()}finally{if(i)throw n}}this.memory=[],this.cue=null}},{key:"_clearActiveCues",value:function(e){var t=!0,i=!1,n=void 0;try{for(var a,r=this.display[Symbol.iterator]();!(t=(a=r.next()).done);t=!0){var o=a.value;o.endTime=e}}catch(s){i=!0,n=s}finally{try{!t&&r["return"]&&r["return"]()}finally{if(i)throw n}}this.display=[]}},{key:"_clearBufferedCues",value:function(){}}]),e}();i["default"]=r},{}],37:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(t){n(this,e),this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}return a(e,[{key:"sample",value:function(e,t){var i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e}},{key:"getTotalWeight",value:function(){return this.totalWeight_}},{key:"getEstimate",value:function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_}}]),e}();i["default"]=r},{}],38:[function(e,t,i){"use strict";function n(){}function a(e,t){return t="["+e+"] > "+t}function r(e){var t=window.console[e];return t?function(){for(var i=arguments.length,n=Array(i),r=0;i>r;r++)n[r]=arguments[r];n[0]&&(n[0]=a(e,n[0])),t.apply(window.console,n)}:n}function o(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;t>n;n++)i[n-1]=arguments[n];i.forEach(function(t){l[t]=e[t]?e[t].bind(e):r(t)})}Object.defineProperty(i,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},d={trace:n,debug:n,log:n,warn:n,info:n,error:n},l=d;i.enableLogs=function(e){if(e===!0||"object"===("undefined"==typeof e?"undefined":s(e))){o(e,"debug","log","info","warn","error");try{l.log()}catch(t){l=d}}else l=d},i.logger=l},{}],39:[function(e,t,i){"use strict";var n={buildAbsoluteURL:function(e,t){if(t=t.trim(),/^[a-z]+:/i.test(t))return t;var i=null,a=null,r=/^([^#]*)(.*)$/.exec(t);r&&(a=r[2],t=r[1]);var o=/^([^\?]*)(.*)$/.exec(t);o&&(i=o[2],t=o[1]);var s=/^([^#]*)(.*)$/.exec(e);s&&(e=s[1]);var d=/^([^\?]*)(.*)$/.exec(e);d&&(e=d[1]);var l=/^(([a-z]+:)?\/\/[a-z0-9\.\-_~]+(:[0-9]+)?)?(\/.*)$/i.exec(e);if(!l)throw new Error("Error trying to parse base URL.");var u=l[2]||"",c=l[1]||"",h=l[4],p=null;return p=/^\/\//.test(t)?u+"//"+n.buildAbsolutePath("",t.substring(2)):/^\//.test(t)?c+"/"+n.buildAbsolutePath("",t.substring(1)):n.buildAbsolutePath(c+h,t),i&&(p+=i),a&&(p+=a),p},buildAbsolutePath:function(e,t){for(var i,n,a=t,r="",o=e.replace(/[^\/]*$/,a.replace(/(\/|^)(?:\.?\/+)+/g,"$1")),s=0;n=o.indexOf("/../",s),n>-1;s=n+i)i=/^\/(?:\.\.\/)*/.exec(o.slice(n))[0].length,r=(r+o.substring(s,n)).replace(new RegExp("(?:\\/+[^\\/]*){0,"+(i-1)/3+"}$"),"/");return r+o.substr(s)}};t.exports=n},{}],40:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=e("../utils/logger"),o=function(){function e(t){n(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return a(e,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var e=this.loader,t=this.timeoutHandle;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),t&&window.clearTimeout(t)}},{key:"load",value:function(e,t,i,n,a,r,o,s){var d=arguments.length<=8||void 0===arguments[8]?null:arguments[8],l=arguments.length<=9||void 0===arguments[9]?null:arguments[9];this.url=e,!l||isNaN(l.byteRangeStartOffset)||isNaN(l.byteRangeEndOffset)||(this.byteRange=l.byteRangeStartOffset+"-"+(l.byteRangeEndOffset-1)),this.responseType=t,this.onSuccess=i,this.onProgress=d,this.onTimeout=a,this.onError=n,this.stats={trequest:performance.now(),retry:0},this.timeout=r,this.maxRetry=o,this.retryDelay=s,this.loadInternal()}},{key:"loadInternal",value:function(){var e;e="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest,e.onloadend=this.loadend.bind(this),e.onprogress=this.loadprogress.bind(this),e.open("GET",this.url,!0),this.byteRange&&e.setRequestHeader("Range","bytes="+this.byteRange),e.responseType=this.responseType;var t=this.stats;t.tfirst=0,t.loaded=0,this.xhrSetup&&this.xhrSetup(e,this.url),this.timeoutHandle=window.setTimeout(this.loadtimeout.bind(this),this.timeout),e.send()}},{key:"loadend",value:function(e){var t=e.currentTarget,i=t.status,n=this.stats;n.aborted||(i>=200&&300>i?(window.clearTimeout(this.timeoutHandle),n.tload=Math.max(n.tfirst,performance.now()),this.onSuccess(e,n)):n.retry<this.maxRetry?(r.logger.warn(i+" while loading "+this.url+", retrying in "+this.retryDelay+"..."),this.destroy(),window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,64e3),n.retry++):(window.clearTimeout(this.timeoutHandle),r.logger.error(i+" while loading "+this.url),this.onError(e)))}},{key:"loadtimeout",value:function(e){r.logger.warn("timeout while loading "+this.url),this.onTimeout(e,this.stats)}},{key:"loadprogress",value:function(e){var t=this.stats;0===t.tfirst&&(t.tfirst=Math.max(performance.now(),t.trequest)),t.loaded=e.loaded,this.onProgress&&this.onProgress(e,t)}}]),e}();i["default"]=o},{"../utils/logger":38}]},{},[27])(27)}),define("zeus_mouseinput",["zeus_eventdispatcher","zeus_utils"],function(e,t){function i(){var t=this;t.type="mouse",t._isTouched=!1,t._mouseIdleTracker=new o,t._mouseIdleTracker.mouseIdleCallback=t._onMouseIdle.bind(t),t._mouseIdleTracker.mouseActiveCallback=t._onMouseActive.bind(t),e.mixin(t),t._init()}var n=window.ZeusConstants,a=(window.client,window.View),r=(t.dom,t.css),o=function(){var e=this;e._mouseDown=!1,e.isTouched=!1,e._isActive=!1,e._hideTimeoutId=null,e._touchTimeout=null,e._mouseIdleTimer=null,e._mouseIdleDuration=0,e.mouseIdleCallback=null,e.mouseActiveCallback=null,e._onMouseLeave=e._onMouseLeave.bind(e),e._onMouseEnter=e._onMouseEnter.bind(e),e._onMouseMove=e._onMouseMove.bind(e),e._onMouseDown=e._onMouseDown.bind(e),e._onMouseUp=e._onMouseUp.bind(e),window.Skin.addEventListener("mousemove",e._onMouseMove),window.Skin.addEventListener("mousedown",e._onMouseDown,!0),window.Skin.addEventListener("mouseup",e._onMouseUp)};return o.prototype={get isActive(){return this._isActive},set isActive(e){var t=this;t._isActive=e,e?t.mouseActiveCallback():t.mouseIdleCallback()},_onMouseDown:function(e){LOG.info("mouse down"),this._mouseDown=!0,this._mouseIdleTimer&&clearInterval(this._mouseIdleTimer)},_onMouseUp:function(e){LOG.info("mouse up"),this._mouseDown=!1},_onMouseLeave:function(e){var t=this;t.isTouched||(t._mouseIdleTimer&&clearInterval(t._mouseIdleTimer),t._hideTimeoutId=setTimeout(function(){clearTimeout(t._hideTimeoutId),t._hideTimeoutId=null,t.isActive=!1},1e3)),t._mouseDown=!1,t.isTouched=!1},_onMouseEnter:function(e){var t=this;t._hideTimeoutId&&(clearTimeout(t._hideTimeoutId),t._hideTimeoutId=null),t._resetIdleTimer(),t.isActive=!0},_onMouseMove:function(e){var t=this;t.isActive=!0,t.isTouched||t._resetIdleTimer(),t.isTouched=!1},_resetIdleTimer:function(){var e=this;e._mouseIdleTimer&&clearInterval(e._mouseIdleTimer),e._mouseDown||(e._mouseIdleDuration=0,e._mouseIdleTimer=setInterval(function(){e._mouseIdleDuration+=500,e._mouseIdleDuration>=3e3&&(clearInterval(e._mouseIdleTimer),e._mouseDown=!1,e._isTouched=!1,e.isActive=!1)},500))},setFullscreen:function(e){var t=this;e?(window.Skin.removeEventListener("mouseleave",t._onMouseLeave),window.Skin.removeEventListener("mouseenter",t._onMouseEnter)):(window.Skin.addEventListener("mouseleave",t._onMouseLeave),window.Skin.addEventListener("mouseenter",t._onMouseEnter))}},i.prototype={get isTouched(){return this._isTouched},set isTouched(e){this._isTouched=e,this._mouseIdleTracker.isTouched=e,e?r.addClass(document.body,"bolt-touch-input"):r.removeClass(document.body,"bolt-touch-input")},_onMouseIdle:function(){this._dispatchEvent(n.UI.Event.MOUSE_OUT,null,window.Skin),this.isTouched=!1},_onMouseActive:function(){this._dispatchEvent(n.UI.Event.MOUSE_OVER,null,window.Skin),this.isTouched=!1},setFullscreen:function(e){this._mouseIdleTracker.setFullscreen(e)},_init:function(){var e=this;r.addClass(document.body,"bolt-mouse-input"),e.setFullscreen(a.fullscreen),PlayerState.on(PlayerState.STATE_CHANGED,function(){PlayerState.state===PlayerState.PLAYING&&(e._mouseIdleTracker.isActive||window.View.currentPlayer.isAd()||e._mouseIdleTracker._resetIdleTimer())})}},i}),define("zeus_cors_shim",["swfobject"],function(){function e(e){this._swf=null,this._swfId=null,this._requests=[],this._queuedRequests=[],this.ready=!1,this.callback=e,this.init()}var t=window.ZeusConstants;return e.prototype={},e.prototype.init=function(){this._swfId="cors_"+window.id;var e=document.createElement("div");e.style.display="none",e.id=this._swfId+"_";var i=document.body;i.appendChild(e);var n={onSWFReady:this._getPath()+".onSWFReady"},a={allowscriptaccess:"always",wmode:"transparent"},r={id:this._swfId,name:this._swfId,style:"position:absolute"},o=t.Player.CORS_SHIM;LOG.debug("LOAD CORS SHIM",o),swfobject.embedSWF(o,e.id,"1px","1px",t.FLASHVERSION,null,n,a,r)},e.prototype.onSWFReady=function(){if(!this._swf)for(this.ready=!0,LOG.debug("CORS SWF READY has queued requests?",this._queuedRequests.length),this._swf=document.getElementById(this._swfId),this.callback.call();this._queuedRequests.length>0;){var e=this._queuedRequests.shift();this.send(e.url,e.method,e.data,e.success,e.error,e.dataFormat)}},e.prototype.handleResponse=function(e,t,i){for(var n=0;n<this._requests.length;n++){var a=this._requests[n];if(a.id===parseInt(e)){LOG.info("found a matching request by id "+e+"\n"+a.url),a.success&&(LOG.info("CORS SHIM success",i),a.success.call(null,t)),this._requests.splice(n,1);break}}LOG.info("request success "+i),LOG.info("awaiting responses ",this._requests)},e.prototype.handleError=function(e,t,i){for(var n=0;n<this._requests.length;n++){var a=this._requests[n];if(a.id===parseInt(e)){LOG.error("CORS SHIM response error url",t,"message",i),a.error&&a.error.call(null),this._requests.splice(n,1);break}}LOG.info("response error "+t),LOG.info("pending requests ",this._requests)},e.prototype._getPath=function(){return"window.Cors"},e.prototype.send=function(e,t,i,n,a,r){var o={id:Date.now(),method:t,url:e,data:i,success:n,error:a,dataFormat:r||"text"};this._swf?(this._requests.push(o),"post"===t.toLowerCase()?this._swf.sendPost(o.id,o.url,o.data,this._getPath()+".handleResponse",this._getPath()+".handleError",o.dataFormat):this._swf.sendGet(o.id,o.url,this._getPath()+".handleResponse",this._getPath()+".handleError",o.dataFormat)):this._queuedRequests.push(o)},e}),define("flash_detector",["zeus_utils","zeus_constants","swfobject"],function(e,t){function i(){try{document.body.removeChild(document.getElementById(l)),delete window.flashversion}catch(e){}}function n(){r=setTimeout(function(){o||(s=!0,e.log.warn("cannot detect flash within the time limit"),i(),a(null))},2e3)}var a,r,o,s,d=window.FlashDetectorSWF||zeusBaseUrl+"/swf/flashdetector-9570fe9101.swf",l="fd";return window.flashversion=function(t){s||(e.log.info("window flash version",t),o=t,r&&clearTimeout(r),a(t),i())},{detectFlash:function(r){if(e.log.info("DETECTING FLASH"),a=r,client.browser.ie>0)if(client.hasFlash=swfobject.hasFlashPlayerVersion(t.FLASHVERSION),client.hasFlash){var o=swfobject.getFlashPlayerVersion();window.flashversion(o.major+"."+o.minor+"."+o.release)}else a(null),i();else{var s='<object data="'+d+'" type="application/x-shockwave-flash" width="1" height="1" id="'+l+'" name="'+l+'"><param name="movie" value="'+d+'"/><param name="wmode" value="opaque"/><param name="allowScriptAccess" value="always"/></object>';document.body.insertAdjacentHTML("afterBegin",s),n()}}}}),define("base_appearance_manager",["stapes","zeus_utils","zeus_constants"],function(e,t,i){var n=t.dom,a=t.css,r=(document,e.subclass({constructor:function(){this.useGradient=!1},init:function(){},_normalizeRGBA:function(e){var t=e.match(/([0-9.]+)/g);return t.length>3&&t.pop(),"rgb("+t.join(",")+")"},getInitialSettings:function(){var e=this,r=n.getUI(i.UI.TITLE_TEXT),o=n.getUI(i.UI.SCRUBBER),s=n.getUI(i.UI.TIMERAIL_PROGRESS),d=n.getUI(i.UI.TIMERAIL_BUFFER),l=n.getUI(i.UI.PLAY_ICON),u=JSON.parse(JSON.stringify(window.CurrentVideoConfig.settings));u.appearance||(u.appearance={});var c,h,p,f,v=n.getUI(i.UI.CONTROLBAR),g=getComputedStyle(v),m=/gradient/i.test(g.backgroundImage);if(m){var E=g.backgroundImage,y=[];if(E.indexOf("#")>-1)c=!0,y=E.substring(E.indexOf("#"),E.lastIndexOf(")"));else if(E.indexOf("rgb")>-1)c=!1,p=!0,y=E.substring(E.indexOf("rgb"),E.lastIndexOf(")")),E.indexOf("rgba")>-1&&(h=!0,p=!1);else{f=!0;for(var _,b=/,\s?(\w+)/gi;_=b.exec(E);)_.index===b.lastIndex&&b.lastIndex++,y.push(_[1])}y&&(c?y=y.split(","):h&&(y=function(t){var i=t.match(/(rgba?\([0-9,.\s]*\))/g),n=i[0];n=e._normalizeRGBA(n);var a=i[1];return a=e._normalizeRGBA(a),[n,a]}(y)),p&&(y=function(e){var t=/(rgb\(+.*\)).*(rgb\(+.*\))/gi.exec(e);return[t[1],t[2]]}(y)))}var A=a.getStyleSheetOfClass("bolt-background","backgroundColor");/rgba/i.test(A)&&(A=e._normalizeRGBA(A));var T=/rgba/i.test(g.backgroundColor)?e._normalizeRGBA(g.backgroundColor):g.backgroundColor,w={colors:{background:A,foreground:getComputedStyle(l).color,active:a.getStyleSheetOfClass(".bolt-highlight","color")},text:{provider:null,font:getComputedStyle(r).fontFamily,color:getComputedStyle(r).color},scrubber:{backgroundColor:getComputedStyle(o).backgroundColor,opacity:getComputedStyle(o).opacity,buffer:{backgroundColor:getComputedStyle(d).backgroundColor,opacity:getComputedStyle(d).opacity},progress:{backgroundColor:getComputedStyle(s).backgroundColor,opacity:getComputedStyle(s).opacity}},controlbar:{corner:parseFloat(g.borderBottomLeftRadius)>0?"rounded":"sharp",position:parseFloat(g.bottom)>0?"floating":"docked",backgroundColor:{style:m?"gradient":"flat",primary:m?y[1]:T,secondary:m?y[0]:T},separator:{backgroundColor:{primary:a.getStyleSheetOfClass(".bolt-light-line","backgroundColor"),secondary:a.getStyleSheetOfClass(".bolt-dark-line","backgroundColor")},opacity:a.getStyleSheetOfClass(".bolt-separator","opacity")}},watermark:{position:"bottom-right",opacity:1}};u.appearance=t.mergeObject(w,u.appearance),window.CurrentVideoConfig.settings.appearance=u.appearance,View._dispatchEvent(i.UI.Event.INITIAL_APPEARANCE_SETTINGS_LOADED,{settings:u,related:window.CurrentVideoConfig.related})},updateTextColors:function(){var e=window.PlayerSettings.appearance,t=e.text.color;t&&a.inject(".bolt-custom-text-color {color:"+t+" !important; }");var i=e.text.font;if(i)if("google"===e.text.provider){var n=i.replace(/\s/,"+");a.addLink("//fonts.googleapis.com/css?family="+n,"googlefont",!1,function(){a.inject('.bolt-custom-font {font-family:"'+i+'", sans-serif !important;}')})}else a.inject(".bolt-custom-font {font-family:"+i+", sans-serif !important; }");LOG.info("Appearance manager:: update text colors",t)},updateColors:function(){
var e=window.PlayerSettings.appearance,t=e.colors.background;t&&(0==t.indexOf("0x")&&(t="#"+t.substr(2)),a.inject(".bolt-background { background:"+t+"}"));var i=e.colors.foreground;if(i){0==i.indexOf("0x")&&(i="#"+i.substr(2));try{for(var n=window.Skin.getElementsByClassName("bolt-logo-default")[0],r=n.getElementsByTagName("path"),o=0;o<r.length;o++){var s=r[o];s.removeAttribute("fill")}}catch(d){}a.inject(".bolt-foreground { color:"+i+"; fill: "+i+"}")}var l=e.colors.active;l&&(0==l.indexOf("0x")&&(l="#"+l.substr(2)),a.inject(" .bolt-highlight,.bolt-hover-highlight:hover, .bolt-hover-highlight:hover .bolt-icon { color:"+l+" !important; fill: "+l+"!important;} .bolt-selected, .bolt-selected:hover .bolt-icon { color:"+l+" !important; fill: "+l+"!important;} .bolt-block-highlight { background:"+l+" !important}")),LOG.info("update colors","bg:",t,", fg:",i,", active:",l)},preview:function(e,r){var o=this;switch(e){case"bigButton":r?(View._prerollScreen&&View._prerollScreen.open(),a.inject(".bolt-bigplay-layer .bolt-icon{ fill: "+window.PlayerSettings.appearance.colors.active+"!important }")):View._prerollScreen&&View._prerollScreen.close();break;case"ageGate":View._enableAgeGate=r,View.enableAgeGate(r);break;case"share":PlayerSettings.share=r,r?n.showElement(i.UI.SHARING_BTN):n.hideElement(i.UI.SHARING_BTN);break;case"related":var s=r,d=function(){View._relatedVideoMenu?View._relatedVideoMenu.open():View.setRelatedVideos(s)};r?window.CurrentVideoConfig.related?t.xhr(window.CurrentVideoConfig.related,"get",null,function(e){s=JSON.parse(e),d()}):d():View._relatedVideoMenu&&(View._relatedVideoMenu.close(),window.CurrentVideoConfig.settings.bigButton&&o.preview("bigButton",!0));break;case"subtitle":r?(a.removeClass(Skin,"bolt-subtitle-disabled"),a.addClass(Skin,"bolt-subtitle-enabled")):(a.removeClass(Skin,"bolt-subtitle-enabled"),a.addClass(Skin,"bolt-subtitle-disabled"))}},update:function(e){var n=this,a=e,r=window.PlayerSettings.appearance;"undefined"!=typeof a.related?n.preview("related",a.related):a.settings?(window.PlayerSettings=t.mergeObject(window.PlayerSettings,a.settings,!0),"undefined"!=typeof a.settings.bigButton?n.preview("bigButton",a.settings.bigButton):"undefined"!=typeof a.settings.share?n.preview("share",a.settings.share):"undefined"!=typeof a.settings.minAge?n.preview("ageGate",a.settings.minAge):a.settings.watermark&&(PlayerSettings.watermark||(PlayerSettings.watermark={}),PlayerSettings.watermark=t.mergeObject(window.CurrentVideoConfig.settings.watermark,a.settings.watermark,!0),View._watermark.create())):a.appearance&&(a.appearance.colors&&(r.colors=t.mergeObject(r.colors,a.appearance.colors),n.updateColors()),a.appearance.text&&(r.text=t.mergeObject(r.text,a.appearance.text),n.updateTextColors()),a.appearance.controlbar&&(r.controlbar=t.mergeObject(r.controlbar,a.appearance.controlbar)),a.appearance.scrubber&&(r.scrubber=t.mergeObject(r.scrubber,a.appearance.scrubber)),a.appearance.watermark&&(r.watermark.position=a.appearance.watermark.position||r.watermark.position,r.watermark.opacity=a.appearance.watermark.opacity||r.watermark.opacity)),View._dispatchEvent(i.UI.Event.APPEARANCE_SETTINGS_CHANGED)}}));return r}),define("appearance_manager",["base_appearance_manager"],function(e){var t=e.subclass();return t}),define("base_ui_module",["zeus_eventdispatcher","zeus_utils","zeus_constants"],function(e,t,i){var n=window.View,a=t.dom,r=e.subclass({constructor:function(e){n=window.View,this.UI=i.UI,this.player=e,this._container=null,this.isOpen=null,n.addEventListener(i.UI.Event.APPEARANCE_SETTINGS_CHANGED,function(){this.updateAppearance()},this)},init:function(e){},invalidate:function(){},updateAppearance:function(){},open:function(e){this.isOpen||(this._container&&a.showElement(this._container),this.isOpen=!0,"function"==typeof e&&e.call())},close:function(e){this.isOpen!==!1&&(this._container&&a.hideElement(this._container),this.isOpen=!1,"function"==typeof e&&e.call())}});return window.BaseUI=r,r}),define("base_controlbar",["base_ui_module","hammer","zeus_utils","zeus_constants"],function(e,t,i,n){var a=window.View,r=i.dom,o=i.css,s=e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),this.timeTextSeparator="/",this._mouseEnterTimeout=null,this.audioBtn=r.getUI(n.UI.SOUND_BTN),this.playBtn=r.getUI(n.UI.PLAY_PAUSE_BTN),this.replayBtn=r.getUI(n.UI.REPLAY_BTN),this.qualityBtn=r.getUI(n.UI.SETTINGS_BTN),this.fullscreenBtn=r.getUI(n.UI.FULLSCREEN_BTN),this._container=r.getUI(n.UI.CONTROLBAR),this._timeText=r.getUI(n.UI.TIME_TEXT),this.setUpMediaEventListeners(),this.setUpPlayerEventListeners(),this.setUpUIEventListeners(),this._keepOpen=!1},onPlayPause:function(e){return"false"===e.target.getAttribute("data-bolt-ui-enabled")?void LOG.warn("button is disabled"):void(a.currentPlayer.ended?a._dispatchEvent(n.UI.Event.REPLAY):a._dispatchEvent(n.UI.Event.PLAYPAUSE))},init:function(){var e=this;if(e.updateAppearance(),e.playBtn)if(client.system.android)e.playBtn.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),e.onPlayPause(t)});else{var i=new t(e.playBtn);i.on("tap",function(t){LOG.info("playbutton tap",t),t.srcEvent.stopPropagation(),t.srcEvent.preventDefault(),e.onPlayPause(t)})}if(e.qualityBtn){var r=function(){a.currentPlayer.isAd()!==!0&&("sd"===ContentPlayer.currentQuality?a._dispatchEvent(n.UI.Event.REQUEST_QUALITY,"hd"):a._dispatchEvent(n.UI.Event.REQUEST_QUALITY,"sd"))};if(client.system.android)e.qualityBtn.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),r()});else{var o=new t(e.qualityBtn);o.on("tap",function(e){e.srcEvent.stopPropagation(),e.srcEvent.preventDefault(),r()})}}if(e.fullscreenBtn)if(client.system.android)e.fullscreenBtn.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),LOG.debug(this,"FULLSCREEN"),a.toggleFullscreen()});else{var s=new t(e.fullscreenBtn);s.on("tap",function(e){LOG.debug(e,"FULLSCREEN"),e.srcEvent.stopPropagation(),e.srcEvent.preventDefault(),a.toggleFullscreen()})}PlayerState.on(PlayerState.STATE_CHANGED,function(){switch(PlayerState.state){case PlayerState.START:e.open();break;case PlayerState.PAUSED:e.open();break;case PlayerState.ENDED:case PlayerState.RELATED_VIDEOS:e.open()}},e),a.addEventListener(n.Player.Event.CONFIG_CHANGED,function(){e.updateTimeLabels(),e.open()})},setUpMediaEventListeners:function(){var e=this;n.UI;a.addEventListener(n.Media.Event.STOPPED,function(){this.updateTimeLabels()},this),a.addEventListener(n.Media.Event.TIME_UPDATE,function(){this.updateTimeLabels()},this),a.addEventListener(n.Media.Event.DURATION_CHANGE,function(){a.currentPlayer.sourceChanged&&this.updateTimeLabels()},this),a.addEventListener(n.Media.Event.PLAY,function(){LOG.info("media play"),a.currentPlayer.isAd()&&BoltAdManager.type!=n.Ad.Type.FLASH_VPAID&&e.open()}),a.addEventListener(n.Media.Event.RESUME,function(){}),a.addEventListener(n.Media.Event.STOPPED,function(){})},setUpPlayerEventListeners:function(){},setUpUIEventListeners:function(){a.addEventListener(n.UI.Event.MOUSE_OUT,function(e){e.target===window.Skin&&a.currentPlayer&&!a.currentPlayer.isAd()&&this.close()},this),a.addEventListener(n.UI.Event.MOUSE_OVER,function(e){this.open()},this)},allowAutoHide:function(e){var t=this;e?o.hasClass(t._container,"_hide-mouseout")&&(o.removeClass(t._container,"_hide-mouseout"),o.addClass(t._container,"bolt-hide-mouseout")):o.hasClass(t._container,"bolt-hide-mouseout")&&(o.removeClass(t._container,"bolt-hide-mouseout"),o.addClass(t._container,"_hide-mouseout")),t._keepOpen=!e,t._keepOpen&&t.open()},updateTimeLabels:function(){var e=this,t=a.currentPlayer;if(e._timeText)if(PlayerState.state===PlayerState.START)"number"==typeof CurrentVideoConfig.duration?e._timeText.textContent="0:00"+e.timeTextSeparator+i.toHHMMSS((CurrentVideoConfig.duration/1e3).toString()):e._timeText.textContent="";else if(!t.duration||0===t.duration||t.currentTime>t.duration)e._timeText.textContent="";else{var n=t.currentTime;0>n&&(n=0),e._timeText.textContent=i.toHHMMSS(n.toString())+e.timeTextSeparator+i.toHHMMSS(t.duration.toString())}},updateAppearance:function(){var e=PlayerSettings.appearance,t=e.controlbar.backgroundColor.primary,i=e.colors.background,n=e.controlbar.backgroundColor.style;t&&0==t.indexOf("0x")&&(t="#"+t.substr(2)),i&&0==i.indexOf("0x")&&(i="#"+i.substr(2)),"gradient"===n?t&&(i||(i=t),o.injectBicolorGradient(".bolt-top-bar,.bolt-control-bar","top",i,t),9===window.client.browser.ie&&o.inject('.bolt-top-bar,.bolt-control-bar { filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr="'+t+'",EndColorStr="'+i+'");}')):t&&(o.inject(".bolt-top-bar, .bolt-control-bar { background:"+t+" !important }"),9===window.client.browser.ie&&o.inject('.bolt-top-bar, .bolt-control-bar { filter:progid:DXImageTransform.Microsoft.Gradient(enabled="false");}')),LOG.info("update controlbar appearance:: style:"+n+", primary color:",t," secondary color:",i);var a=e.controlbar.opacity;a&&o.inject(".bolt-control-bar{ opacity:"+a+" !important; }")},close:function(){this._keepOpen||(e.prototype.close.call(this),this._container.style.visibility="hidden",this._container.style.display="block")},open:function(){e.prototype.open.call(this),this._container.style.visibility="visible",this._container.style.display="block",this.invalidate()},invalidate:function(){var e=this;e.updateTimeLabels()}});return s}),define("base_playlist",["hammer","zeus_utils","zeus_constants","base_ui_module"],function(e,t,i,n){var i=window.ZeusConstants,a=t.css,r=t.dom,o=n.subclass({constructor:function(e){n.prototype.constructor.call(this,e);var t=this;t._container=r.getUI(i.UI.PLAYLIST),t.playlistBtn=r.getUI(i.UI.PLAYLIST_BTN),View.addEventListener(i.UI.Event.MOUSE_OUT,function(e){e.target!==t.playlistBtn&&e.target!==window.Skin||t.close()})},toggle:function(){var e=this;e.isOpen?e.close():e.open()},init:function(){var t=this;if(t.playlistBtn)if(client.isMobile)if(client.system.android)t.playlistBtn.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),t.toggle()});else{var i=new e(t.playlistBtn);i.on("tap",function(e){t.toggle()})}else{t.playlistBtn.addEventListener("mouseenter",function(e){r.isEnabled(t.playlistBtn)&&("8"!==client.system.win&&"8.1"!==client.system.win||!client.browser.chrome&&!client.browser.ie?View.onMouseOver(t.playlistBtn):t._mouseEnterTimeout=setTimeout(function(){View.mouseInput.isTouched||View.onMouseOver(t.playlistBtn)},100))}),t.playlistBtn.addEventListener("mouseleave",function(e){r.isEnabled(t.playlistBtn)&&(e.stopPropagation(),View.mouseInput.isTouched||View.onMouseOut(t.playlistBtn))});var i=new e(t.playlistBtn);"8"!==client.system.win&&"8.1"!==client.system.win||!client.browser.chrome&&!client.browser.ie?i.on("tap",function(e){r.isEnabled(t.playlistBtn)&&t.toggle()}):i.on("hammer.input",function(e){r.isEnabled(t.playlistBtn)&&"touch"===e.pointerType&&("touchstart"===e.srcEvent.type||"pointerdown"===e.srcEvent.type?(View.mouseInput.isTouched=!0,t._mouseEnterTimeout&&(clearTimeout(t._mouseEnterTimeout),t._mouseEnterTimeout=null)):"touchend"!==e.srcEvent.type&&"pointerup"!==e.srcEvent.type||e.isFinal&&t.toggle())})}},_selectElement:function(e){this._selectedItem&&(a.addClass(this._selectedItem,"bolt-hover-highlight"),a.removeClass(this._selectedItem,"bolt-selected")),a.removeClass(e,"bolt-hover-highlight"),a.addClass(e,"bolt-selected"),this._selectedItem=e}});return o}),define("base_scrubber",["base_ui_module","hammer","zeus_utils","zeus_constants"],function(e,t,i,n){var a=window.client,r=window.View,o=i.css,s=i.dom,d=e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),this.videoStartTime=0,this._container=s.getUI(n.UI.SCRUBBER),this._pixelTimeFactor=null,this._interactiveEl=s.getUI(n.UI.TIMERAIL_INTERACTIVE),this._bufferEl=s.getUI(n.UI.TIMERAIL_BUFFER),this._progressEl=s.getUI(n.UI.TIMERAIL_PROGRESS),this._fixedValues=null,this._updateTooltip=this._updateTooltip.bind(this),this._tooltip={element:null,pointer:null,label:null}},init:function(){var e=this;e.updateAppearance(),a.isMobile||e._initTooltip();var o=s.getUI(n.UI.TIMERAIL_INTERACTIVE);if(o){var d=new t(o);d.on("tap",function(t){if(!(!s.isEnabled(t.target)||r.currentPlayer.isAd()||null===r.currentPlayer.duration||r.currentPlayer.duration<=0)){var a=r.fullscreen?t.pointers[0].pageX:t.pointers[0].pageX-i.getScreenPosition(o).x,d=a/o.clientWidth,l=d*r.currentPlayer.duration;e._dispatchEvent(n.UI.Event.SEEK,l)}})}r.addEventListener(n.Media.Event.DURATION_CHANGE,function(){r.currentPlayer.isAd()?s.enableUI(n.UI.TIMERAIL_INTERACTIVE,!1):s.enableUI(n.UI.TIMERAIL_INTERACTIVE,!0),r.currentPlayer.sourceChanged&&e.invalidate()}),r.addEventListener(n.Media.Event.CONFIG_CHANGED,function(){e.setVideoStartTime(0)}),r.addEventListener(n.Media.Event.START_TIME_CHANGED,function(){e.setVideoStartTime(0)}),r.addEventListener(n.Media.Event.LOAD_PROGRESS,function(){e.updateBuffer()}),r.addEventListener(n.Media.Event.LOAD_START,function(){e.updateBuffer()}),r.addEventListener(n.Media.Event.TIME_UPDATE,function(){e.updateProgress()}),r.addEventListener(n.Media.Event.STOPPED,function(){e.updateProgress()})},_initTooltip:function(){var e=this;e._tooltip.element=document.getElementsByClassName("bolt-scrubber-tooltip")[0],e._tooltip.label=e._tooltip.element.firstElementChild,e._tooltip.element&&e._tooltip.label&&(e._tooltip.pointer=document.createElement("div"),e._tooltip.pointer.style.position="absolute",e._tooltip.pointer.style.width=0,e._tooltip.pointer.style.height=0,e._tooltip.pointer.style.borderWidth="5px",e._tooltip.pointer.style.borderStyle="solid",e._tooltip.pointer.style.borderColor=getComputedStyle(this._tooltip.element).backgroundColor+" transparent transparent",e._tooltip.element.appendChild(e._tooltip.pointer),e._interactiveEl.addEventListener("mouseenter",e._updateTooltip),e._interactiveEl.addEventListener("mousemove",e._updateTooltip),e._interactiveEl.addEventListener("mouseleave",function(t){e._tooltip.element.style.display="none"}))},_updateTooltip:function(e){var t=this,n=r.currentPlayer;if(0!==n.duration&&n.isAd()!==!0){var a=t._interactiveEl.clientWidth,o=n.fullscreen?e.pageX:e.pageX-i.getScreenPosition(t._interactiveEl).x,s=o/a,d=s*n.duration;t._tooltip.label.textContent=i.toHHMMSS(d),t._tooltip.element.style.display="block";var l=t._tooltip.element.clientWidth,u=0;u=o+l/2>a?a-l:0>o-l/2?0:o-l/2,t._tooltip.element.style.left=u+"px";var c=parseFloat(getComputedStyle(t._tooltip.element).borderRadius),h=2*parseFloat(t._tooltip.pointer.style.borderWidth),p=o-u-h/2;p+h+c>l?p=l-h-c:c>p&&(p=c),t._tooltip.pointer.style.left=p+"px"}},setVideoStartTime:function(e){this.videoStartTime=e,this.invalidate()},invalidate:function(){var e=r.currentPlayer,t=this;e&&(t._pixelTimeFactor=e.duration/t._container.clientWidth),t.resetWidths(),r.currentPlayer.isAd()?s.enableUI(n.UI.TIMERAIL_INTERACTIVE,!1):s.enableUI(n.UI.TIMERAIL_INTERACTIVE,!0)},fixedValues:function(e){if(e){this._fixedValues=[25,50];var t=s.getUI(n.UI.TIMERAIL_BUFFER);t&&(t.style.width="50%");var i=s.getUI(n.UI.TIMERAIL_PROGRESS);i&&(i.style.width="25%")}else this._fixedValues=null},resetWidths:function(){var e=this;if(!e._fixedValues){var t=e.videoStartTime&&e._pixelTimeFactor!=1/0?e.videoStartTime/e._pixelTimeFactor*100/e._container.clientWidth+"%":0;e._progressEl&&(e._progressEl.style.width=t),e._bufferEl&&(e._bufferEl.style.width=t),e.updateBuffer(),e.updateProgress()}},updateBuffer:function(){var e=r.currentPlayer,t=this;if(!t._fixedValues){var i=e.buffered*e.duration/100,n=i/t._pixelTimeFactor;t._bufferEl.style.width=100*n/t._container.clientWidth+"%"}},updateProgress:function(){var e=r.currentPlayer,t=this;t._fixedValues||(t._progressEl.style.width=e.currentTime/t._pixelTimeFactor+"px")},updateAppearance:function(){var e=window.PlayerSettings.appearance,t=e.scrubber.backgroundColor;t&&(0==t.indexOf("0x")&&(t="#"+t.substr(2)),o.inject(".bolt-timebar{ background-color:"+t+" !important;}"));var i=e.scrubber.opacity;i&&o.inject(".bolt-timebar{opacity:"+i+";}");var n=e.scrubber.buffer.backgroundColor;n&&(0==n.indexOf("0x")&&(n="#"+n.substr(2)),o.inject(".bolt-loaded{ background-color:"+n+" !important;}"));var a=e.scrubber.buffer.opacity;a&&o.inject(".bolt-loaded{opacity:"+a+";}");var r=e.scrubber.progress.backgroundColor;r&&(0==r.indexOf("0x")&&(r="#"+n.substr(2)),o.inject(".bolt-progress{ background-color:"+r+" !important;}"));var s=e.scrubber.progress.opacity;s&&o.inject(".bolt-progress{opacity:"+s+";}")}});return d}),define("controlbar",["base_controlbar","hammer","zeus_utils","zeus_constants"],function(e,t,i,n){var a=(i.dom,i.css),r="5px",o="3%",s=e.subclass({constructor:function(t){e.prototype.constructor.call(this,t)},init:function(){e.prototype.init.call(this)},updateAppearance:function(){e.prototype.updateAppearance.call(this);var t=window.PlayerSettings.appearance,i=t.controlbar.separator.backgroundColor.primary;i&&(0==i.indexOf("0x")&&(i="#"+i.substr(2)),a.inject(".bolt-separator .bolt-dark-line{ background-color:"+i+" !important;opacity:"+t.controlbar.separator.opacity+"}"));var n=t.controlbar.separator.backgroundColor.secondary;n&&(0==n.indexOf("0x")&&(n="#"+n.substr(2)),a.inject(".bolt-separator .bolt-light-line{ background-color:"+n+" !important; opacity:"+t.controlbar.separator.opacity+"}"));var s=t.controlbar.separator.opacity;s&&a.inject(".bolt-separator { opacity:"+s+";}");var d=t.controlbar.corner;"rounded"===d?(a.inject(".bolt-control-bar{ border-radius:0 0 "+r+" "+r+" !important; }"),a.inject(".bolt-scrubber{ overflow:hidden; border-radius:"+r+" "+r+" 0 0 !important; }")):"sharp"===d&&a.inject(".bolt-scrubber{ border-radius:0 !important; }");var l=t.controlbar.position;if("floating"===l){var u=100-2*parseFloat(o)+"%";a.inject(".bolt-control-bar{ bottom:"+o+" !important;left:"+o+";right:"+o+";width:"+u+"; }"),a.inject(".bolt-watermark-layer{ bottom:12% !important; }")}else"docked"===l&&(a.inject(".bolt-control-bar{ bottom:0 !important; left:0;right:0; width:100% }"),a.inject(".bolt-watermark-layer{ bottom:11% !important; }"))},close:function(){window.client.isMobile||e.prototype.close.call(this)}});return s}),define("preroll_screen",["base_ui_module","hammer","zeus_utils","zeus_constants"],function(e,t,i,n){var a=window.View,r=i.dom,o=i.css,s=e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),this._container=r.getUI(n.UI.BIG_PLAY)},init:function(){var e=this,i=function(e){return"false"===e.target.getAttribute("data-bolt-ui-enabled")?void LOG.warn("button is disabled"):void(a.currentPlayer.ended?a._dispatchEvent(n.UI.Event.REPLAY):a._dispatchEvent(n.UI.Event.PLAYPAUSE))};if(client.system.android||client.system.ipad)e._container.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),i(e)});else{var r=new t(e._container);r.on("tap",function(e){e.srcEvent.stopPropagation(),e.srcEvent.preventDefault(),i(e)})}window.PlayerState.on(PlayerState.STATE_CHANGED,function(){switch(PlayerState.state){case PlayerState.START:this.open();break;case PlayerState.PAUSED:client.system.iphone?client.system.ios>=9&&this.open():this.open();break;default:this.close()}},this),a.addEventListener(n.Player.Event.PLAY,function(){e.close()})},updateAppearance:function(e){LOG.info("update big play appearance");var t=window.PlayerSettings.appearance,i=t.colors.active;i&&(0==i.indexOf("0x")&&(i="#"+i.substr(2)),o.inject(".bolt-bigplay-layer .bolt-icon { color:"+i+" !important; fill: "+i+"!important;}"))}});return s}),define("titlebar",["base_ui_module","zeus_utils","zeus_constants"],function(e,t,i){var n="5px",a="3%",r=t.css,o=t.dom,s=e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),this._container=o.getUI(i.UI.TITLE_BAR),this.text=null,this._keepOpen=!1},init:function(){PlayerState.on(PlayerState.STATE_CHANGED,function(){switch(PlayerState.state){case PlayerState.START:case PlayerState.PAUSED:case PlayerState.ENDED:this.open();break;case PlayerState.RELATED_VIDEOS:this.close()}},this),this.setTitle(CurrentVideoConfig.settings.title),View.addEventListener(i.Player.Event.CONFIG_CHANGED,function(){this.setTitle(CurrentVideoConfig.settings.title)},this),View.addEventListener(i.UI.Event.PLAYER_CHANGED,function(){this.setTitle(CurrentVideoConfig.settings.title),View.currentPlayer.isAd()?this.close():this.open()},this),View.addEventListener(i.UI.Event.MOUSE_OUT,function(e){e.target===window.Skin&&this.close()},this),View.addEventListener(i.UI.Event.MOUSE_OVER,function(e){View.currentPlayer.isAd()||this.open()},this)},setTitle:function(e){this.text=e;var t=o.getUI(i.UI.TITLE_TEXT);t&&(t.textContent=e)},allowAutoHide:function(e){var t=this;e?r.hasClass(t._container,"_hide-mouseout")&&(r.removeClass(t._container,"_hide-mouseout"),r.addClass(t._container,"bolt-hide-mouseout")):r.hasClass(t._container,"bolt-hide-mouseout")&&(r.removeClass(t._container,"bolt-hide-mouseout"),r.addClass(t._container,"_hide-mouseout")),t._keepOpen=!e,t._keepOpen&&t.open()},updateAppearance:function(){var e=window.PlayerSettings.appearance,t=e.controlbar.corner;"rounded"===t?r.inject(".bolt-top-bar{ border-radius:"+n+" !important; }"):"sharp"===t&&r.inject(".bolt-top-bar { border-radius:0 !important; }");var i=e.controlbar.position;if("floating"===i){var o=100-2*parseFloat(a)+"%";r.inject(".bolt-top-bar{ top:"+a+" !important;left:"+a+";right:"+a+";width:"+o+"; }")}else"docked"===i&&r.inject(".bolt-top-bar{ top:0 !important; left:0;right:0; width:100% }")},close:function(){this._keepOpen||e.prototype.close.call(this)}});return s}),define("scrubber",["zeus_utils","zeus_constants","base_scrubber"],function(e,t,i){var n=(e.css,e.dom),a=i.subclass({constructor:function(e){i.prototype.constructor.call(this,e)},init:function(){i.prototype.init.call(this),client.isMobile||this._initAnimation()},_initAnimation:function(){function i(e){if("in"===e){if(f&&(clearInterval(f),f=null),p||o.isAd())return;p=setInterval(function(){var e=d.clientHeight;if(u>e){var t=e+1;d.style.height=t+"px";var i=-t;d.style.marginTop=i+"px"}else clearInterval(p),p=null},50)}else if("out"===e){if(p&&(clearInterval(p),p=null),f)return;f=setInterval(function(){var e=d.clientHeight;if(e>c){var t=e-1;d.style.height=t+"px";var i=-t;d.style.marginTop=i+"px"}else clearInterval(f),f=null},50)}}var a=t.UI,r=this,o=View.currentPlayer,s=n.getUI(a.CONTROLBAR),d=r._container,l=window.Skin;if(d){var u=d.clientHeight,c=5,h=c;d.style.height=c+"px",d.style.marginTop=-h+"px";var p=null,f=null;l.addEventListener("mousemove",function(t){var n=t.pageY,a=e.getScreenPosition(d).y,r=a-n;20>r?d.clientHeight<u&&i("in"):d.clientHeight>c&&i("out")}),s.addEventListener("mouseenter",function(e){i("in")}),s.addEventListener("mouseleave",function(t){var n=t.pageY,a=e.getScreenPosition(d).y,r=a-n;r>0?r>20&&i("out"):i("out")})}}});return a}),define("content",["base_ui_module","hammer","zeus_utils","zeus_constants"],function(e,t,i,n){var a=window.View,r=i.dom,o=e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),this._cbar=r.getUI(n.UI.CONTROLBAR),this._container=r.getUI(n.UI.CONTENT),this._adContainer=r.getUI(n.UI.AD_CONTAINER),this._defaultBoxModel={}},init:function(){var e=this._container;if(this._defaultBoxModel={position:e.style.position,top:e.style.top,right:e.style.right,left:e.style.left,bottom:e.style.bottom,width:e.style.width,height:e.style.height,marginTop:e.style.marginTop,marginBottom:e.style.marginBottom,marginLeft:e.style.marginLeft,marginRight:e.style.marginRight,paddingTop:e.style.paddingTop,paddingBottom:e.style.paddingBottom,paddingLeft:e.style.paddingLeft,paddingRight:e.style.paddingRight,zIndex:e.style.zIndex},this._adContainer){var i=this._container.clientHeight-this._cbar.clientHeight;this._adContainer.setAttribute("data-zeus-initial-width",this._container.clientWidth.toString()),this._adContainer.setAttribute("data-zeus-initial-height",i.toString())}var o=r.getUI(n.UI.MAIN_VIDEO_CONTAINER);if(o)if(client.isMobile)if(client.system.android||client.system.ipad)o.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),LOG.debug("main video clicked",e.target),a._dispatchEvent(n.UI.Event.PLAYPAUSE)});else{var s=new t(o);s.on("tap",function(e){LOG.debug("main video tapped",e.srcEvent),a._dispatchEvent(n.UI.Event.PLAYPAUSE)})}else if("native"===window.ContentPlayer.type){var d=new t(o);d.on("tap",function(){a._dispatchEvent(n.UI.Event.PLAYPAUSE)})}PlayerState.on(PlayerState.STATE_CHANGED,function(){switch(PlayerState.state){case PlayerState.AGE_GATE:this.setPoster(null);break;case PlayerState.START:case PlayerState.ENDED:this.setPoster(CurrentVideoConfig.content.poster);break;case PlayerState.PLAYING:this.setPoster(null)}},this),BoltAdManager&&BoltAdManager.addEventListener(n.Ad.Event.REQUESTED,function(){"preroll"===BoltAdManager.timing&&this.setPoster(CurrentVideoConfig.content.poster)},this)},setPoster:function(e){var t=r.getUI(n.UI.POSTER);return e?void(t&&(t.style.backgroundImage="url("+i.normalizeProtocol(e)+")",r.showElement(t))):(LOG.debug("NO POSTER"),t.style.backgroundImage="",void r.hideElement(t))},invalidate:function(){var e=this._container;if(a.fullscreen?(e.style.position="absolute",e.style.top=0,e.style.bottom=0,e.style.left=0,e.style.right=0,e.style.margin="auto"):(e.style.position=this._defaultBoxModel.position,e.style.top=this._defaultBoxModel.top,e.style.bottom=this._defaultBoxModel.bottom,e.style.left=this._defaultBoxModel.left,e.style.right=this._defaultBoxModel.right,e.style.marginTop=this._defaultBoxModel.marginTop,e.style.marginLeft=this._defaultBoxModel.marginLeft,e.style.marginBottom=this._defaultBoxModel.marginBottom,e.style.marginRight=this._defaultBoxModel.marginRight,e.style.paddingTop=this._defaultBoxModel.paddingTop,e.style.paddingLeft=this._defaultBoxModel.paddingLeft,e.style.paddingBottom=this._defaultBoxModel.paddingBottom,e.style.paddingRight=this._defaultBoxModel.paddingRight,e.style.zIndex=this._defaultBoxModel.zIndex),this._adContainer){var t=window.BoltAdManager;if(t&&t.adPlayer)if(t.adPlayer.isLinear())if(this._adContainer.style.width="100%",a.currentPlayer.type===n.Ad.Type.FLASH_VPAID){var i=this._container.clientHeight-this._cbar.clientHeight;this._adContainer.style.height=i+"px"}else this._adContainer.style.height="100%";else t.adPlayer.updateLayout();else this._adContainer.style.width="100%",this._adContainer.style.height="100%"}}});return o}),define("loading_indicator",["base_ui_module","zeus_utils","zeus_constants"],function(e,t,i){var n=t.dom,a=function(){function e(e,t){var i,n=document.createElement(e||"div");for(i in t)n[i]=t[i];return n}function t(e){for(var t=1,i=arguments.length;i>t;t++)e.appendChild(arguments[t]);return e}function i(e,t,i,n){var a=["opacity",t,~~(100*e),i,n].join("-"),r=.01+i/n*100,o=Math.max(1-(1-e)/t*(100-r),e),s=l.substring(0,l.indexOf("Animation")).toLowerCase(),d=s&&"-"+s+"-"||"";return c[a]||(h.insertRule("@"+d+"keyframes "+a+"{0%{opacity:"+o+"}"+r+"%{opacity:"+e+"}"+(r+.01)+"%{opacity:1}"+(r+t)%100+"%{opacity:"+e+"}100%{opacity:"+o+"}}",h.cssRules.length),c[a]=1),a}function n(e,t){var i,n,a=e.style;for(t=t.charAt(0).toUpperCase()+t.slice(1),n=0;n<u.length;n++)if(i=u[n]+t,void 0!==a[i])return i;return void 0!==a[t]?t:void 0}function a(e,t){for(var i in t)e.style[n(e,i)||i]=t[i];return e}function r(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)void 0===e[n]&&(e[n]=i[n])}return e}function o(e,t){return"string"==typeof e?e:e[t%e.length]}function s(e){this.opts=r(e||{},s.defaults,p)}function d(){function i(t,i){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',i)}h.addRule(".spin-vml","behavior:url(#default#VML)"),s.prototype.lines=function(e,n){function r(){return a(i("group",{coordsize:u+" "+u,coordorigin:-l+" "+-l}),{width:u,height:u})}function s(e,s,d){t(h,t(a(r(),{rotation:360/n.lines*e+"deg",left:~~s}),t(a(i("roundrect",{arcsize:n.corners}),{width:l,height:n.width,left:n.radius,top:-n.width>>1,filter:d}),i("fill",{color:o(n.color,e),opacity:n.opacity}),i("stroke",{opacity:0}))))}var d,l=n.length+n.width,u=2*l,c=2*-(n.width+n.length)+"px",h=a(r(),{position:"absolute",top:c,left:c});if(n.shadow)for(d=1;d<=n.lines;d++)s(d,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(d=1;d<=n.lines;d++)s(d);return t(e,h)},s.prototype.opacity=function(e,t,i,n){var a=e.firstChild;n=n.shadow&&n.lines||0,a&&t+n<a.childNodes.length&&(a=a.childNodes[t+n],a=a&&a.firstChild,a=a&&a.firstChild,a&&(a.opacity=i))}}var l,u=["webkit","Moz","ms","O"],c={},h=function(){var i=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],i),i.sheet||i.styleSheet}(),p={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};s.defaults={},r(s.prototype,{spin:function(t){this.stop();var i=this,n=i.opts,r=i.el=a(e(0,{className:n.className}),{position:n.position,width:0,zIndex:n.zIndex});n.radius+n.length+n.width;if(t&&(t.insertBefore(r,t.firstChild||null),a(r,{left:n.left,top:n.top})),r.setAttribute("role","progressbar"),i.lines(r,i.opts),!l){var o,s=0,d=(n.lines-1)*(1-n.direction)/2,u=n.fps,c=u/n.speed,h=(1-n.opacity)/(c*n.trail/100),p=c/n.lines;!function f(){s++;for(var e=0;e<n.lines;e++)o=Math.max(1-(s+(n.lines-e)*p)%c*h,n.opacity),i.opacity(r,e*n.direction+d,o,n);i.timeout=i.el&&setTimeout(f,~~(1e3/u))}()}return i},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(n,r){function s(t,i){return a(e(),{position:"absolute",width:r.length+r.width+"px",height:r.width+"px",background:t,boxShadow:i,transformOrigin:"left",transform:"rotate("+~~(360/r.lines*u+r.rotate)+"deg) translate("+r.radius+"px,0)",borderRadius:(r.corners*r.width>>1)+"px"})}for(var d,u=0,c=(r.lines-1)*(1-r.direction)/2;u<r.lines;u++)d=a(e(),{position:"absolute",top:1+~(r.width/2)+"px",transform:r.hwaccel?"translate3d(0,0,0)":"",opacity:r.opacity,animation:l&&i(r.opacity,r.trail,c+u*r.direction,r.lines)+" "+1/r.speed+"s linear infinite"}),r.shadow&&t(d,a(s("#000","0 0 4px #000"),{top:"2px"})),t(n,t(d,s(o(r.color,u),"0 0 1px rgba(0,0,0,.1)")));return n},opacity:function(e,t,i){t<e.childNodes.length&&(e.childNodes[t].style.opacity=i)}});var f=a(e("group"),{behavior:"url(#default#VML)"});return!n(f,"transform")&&f.adj?d():l=n(f,"animation"),s}(),r=e.subclass({constructor:function(t){e.call(this,t),this._container=n.getUI(i.UI.LOADING_INDICATOR),this._spinner=null},init:function(){PlayerState.on(PlayerState.STATE_CHANGED,function(){switch(PlayerState.state){case PlayerState.WAITING:this.open();break;default:this.close()}},this),BoltAdManager&&BoltAdManager.addEventListener(i.Ad.Event.REQUESTED,function(){"preroll"===BoltAdManager.timing&&this.open()},this);var e={lines:9,length:0,width:5,radius:8,corners:0,rotate:0,direction:1,color:"#fff",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto"};this._spinner=new a(e).spin(this._container),View.on(i.Media.Event.NOT_FOUND,function(){View.currentPlayer.isAd()||(LOG.error("Video not found"),this.close())},this)},open:function(){this.isOpen||(this.isOpen=!0,n.showElement(this._container),this.invalidate())},close:function(){this.isOpen&&(this.isOpen=!1,n.hideElement(this._container))}});return r}),define("playlist",["zeus_constants","zeus_utils","base_playlist","dragdealer","hammer"],function(e,t,i,n,a){var r=(t.css,t.dom),o=i.subclass({constructor:function(e){i.prototype.constructor.call(this,e);var t=this;t._html='<div class="bolt-playlist-header bolt-foreground">Playlist</div><div class="bolt-playlist-mask"><div class="bolt-playlist-menu"></div></div><div class="bolt-playlist-slider dragdealer bolt-block-highlight"><div class="bolt-playlist-handle"></div></div>',t._container.insertAdjacentHTML("beforeend",t._html),t._data=null,t._playlistMenu=t._container.querySelector(".bolt-playlist-menu"),
t._mask=t._container.querySelector(".bolt-playlist-mask"),t._slider=t._container.querySelector(".bolt-playlist-slider"),t._handle=t._container.querySelector(".bolt-playlist-handle"),t._header=t._container.querySelector(".bolt-playlist-header"),t._playlistScroller=null,t._selectedItem=null,t._sliderWidth=10,t._initialLayerHeight=0,t._itemRenderers=[],t._autocloseTimeout=null},init:function(t){i.prototype.init.call(this);var n=this;if(t===this._data)return void this._invalidateMenu();LOG.info("PLAYLIST DATA",t),this._data=t;var r=this._container;if(r){if(t&&t.length>0){for(;this._playlistMenu.children.length>0;)this._playlistMenu.removeChild(this._playlistMenu.firstChild);for(var o=this._onItemClicked.bind(this),s=0;s<t.length;s++){var d,l,u,c=t[s];window.PlayerSettings.freePlayer?(d=c.settings.title,l=c.videoId,u=c.content.thumb):(d=c.title,l=c.videoId,u=c.thumb);var h=document.createElement("div");h.setAttribute("class"," bolt-menu-option bolt-playlist-row bolt-hover-highlight"),h.setAttribute("data-video-id",l);var p=new a(h);p.on("tap",o);var f=document.createElement("div");f.setAttribute("class","bolt-playlist-thumbnail"),f.style.background="url("+u+")",f.style.backgroundPosition="center center",f.style.backgroundSize="cover";var v=document.createElement("div");v.setAttribute("class","bolt-playlist-title"),v.textContent=d,h.appendChild(f),h.appendChild(v),s===t.length-1&&(h.style.borderBottom="none"),this._playlistMenu.appendChild(h),this._itemRenderers.push(h)}this._initialLayerHeight=this._container.clientHeight,this.invalidate()}View.addEventListener(e.UI.Event.MOUSE_OVER,function(e){e.target===n.playlistBtn&&n.open()})}},_invalidateMenu:function(){var t=this;if(!View.currentPlayer.isAd()){var i=t._playlistScroller,a=t._playlistMenu,o=r.getUI(e.UI.CONTROLBAR),s=t._container,d=t._mask,l=t._slider;t._handle;0==t._initialLayerHeight&&(t._initialLayerHeight=s.clientHeight);var u=Math.floor(.8*(window.Skin.offsetHeight-o.offsetHeight));d.style.height=u-t._header.clientHeight+"px";var c=t._initialLayerHeight;if(c>u){var h=a.offsetHeight-d.offsetHeight;h>0?(l.style.display="inline",l.style.width=t._sliderWidth+"px",l.style.height=d.clientHeight+"px",i?i.reflow():(i=new n(l,{horizontal:!1,vertical:!0,yPrecision:h,handleClass:"bolt-playlist-handle",animationCallback:function(e,t){a.style.marginTop=-t*h+"px"}}),t._playlistScroller=i),d.style.width=s.clientWidth-2*l.clientWidth+"px",d.style.height=u-t._header.clientHeight+"px"):(l.style.display="none",d.style.width="100%",d.style.height="auto")}else l.style.display="none",d.style.width="100%",d.style.height="auto"}},_onItemClicked:function(t){var i=this,n=t.target;for(t.srcEvent.stopPropagation(),t.srcEvent.preventDefault();!n.hasAttribute("data-video-id");)n=n.parentNode;var a=n.getAttribute("data-video-id");i._selectElement(n);var r=function(e,t){for(var i in e){var n=e[i];if(n.videoId==t)return n}}(i._data,a);i._dispatchEvent(e.UI.Event.PLAYLIST_ITEM_SELECTED,r)},invalidate:function(){for(var e=window.CurrentVideoConfig,t=0;t<this._itemRenderers.length;t++){var i=this._itemRenderers[t];if(i.getAttribute("data-video-id")===e.content.videoId){this._selectElement(i);break}}setTimeout(this._invalidateMenu.bind(this),50)},open:function(){var e=this;if(!e.isOpen){if(i.prototype.open.call(this),window.client.isMobile&&(clearTimeout(e._autocloseTimeout),e._autocloseTimeout=setTimeout(function(){e.close()},1e4)),this._playlistBtn){var n=window.Skin,a=t.getScreenPosition(n),r=t.getScreenPosition(this._playlistBtn),o=r.x-a.x,s=(n.clientWidth-this._container.clientWidth)/2;this._container.clientWidth/n.clientWidth>=.5&&(this._container.style.left=s-o+"px")}this.invalidate()}},close:function(){this.isOpen&&(window.client.isMobile&&clearTimeout(this._autocloseTimeout),i.prototype.close.call(this))}});return o}),define("sharing",["base_ui_module","hammer","zeus_utils","zeus_constants"],function(e,t,i,n){var a=window.View,r=i.dom,o=e.subclass({constructor:function(t){e.prototype.constructor.call(this,t);var i=this;i.isOpen=!1,i._closeBtn=null,i._container=r.getUI(n.UI.SHARING_MENU),i.sharingBtn=r.getUI(n.UI.SHARING_BTN)},toggle:function(){var e=this;e.isOpen?e.close():e.open()},init:function(){LOG.debug("SharingUI init");var e=this;if(e.sharingBtn)if(client.isMobile)if(client.system.android)e.sharingBtn.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),e.toggle()});else{var i=new t(e.sharingBtn);i.on("tap",function(t){t.srcEvent.stopPropagation(),t.srcEvent.preventDefault(),e.toggle()})}else{e.sharingBtn.addEventListener("mouseenter",function(t){r.isEnabled(e.sharingBtn)&&("8"!==client.system.win&&"8.1"!==client.system.win||!client.browser.chrome&&!client.browser.ie?a.onMouseOver(e.sharingBtn):e._mouseEnterTimeout=setTimeout(function(){a.mouseInput.isTouched||a.onMouseOver(e.sharingBtn)},100))}),e.sharingBtn.addEventListener("mouseleave",function(t){r.isEnabled(e.sharingBtn)&&(t.stopPropagation(),a.onMouseOut(e.sharingBtn),a.mouseInput.isTouched=!1)});var i=new t(e.sharingBtn);i.on("tap",function(t){r.isEnabled(e.sharingBtn)&&(LOG.info("sharing on tap"),e.toggle())})}e._closeBtn=e._container.querySelector(".bolt-sharing-close"),e._closeBtn.addEventListener("click",e.close.bind(this));var o=r.getUI(n.UI.SHARING_CODE_INPUT),s=r.getUI(n.UI.EMBED_CODE_INPUT);o.value=window.site.href,s.value=window.embedCode;var d=window.site.href,l=e._container.querySelector(".bolt-share-fb");l&&l.addEventListener("click",function(){window.open("http://www.facebook.com/sharer/sharer.php?u="+d)});var u=e._container.querySelector(".bolt-share-twitter");u&&u.addEventListener("click",function(){window.open("http://twitter.com/share?url="+d)});var c=e._container.querySelector(".bolt-share-gplus");c&&c.addEventListener("click",function(){window.open("https://plus.google.com/share?url="+d)});var h=e._container.querySelector(".bolt-share-email");h&&h.addEventListener("click",function(){window.location.href="mailto:?body="+d})},open:function(){this.isOpen||(e.prototype.open.call(this),this._container&&(this._container.style.visibility="visible",r.showElement(this._container),this.isOpen=!0),window.CurrentVideoConfig.settings.showEmbed===!1?r.hideElement(n.UI.EMBED_CODE_CONTAINER):window.CurrentVideoConfig.settings.showEmbed===!0&&r.showElement(n.UI.EMBED_CODE_CONTAINER),this.invalidate())},close:function(){this.isOpen&&e.prototype.close.call(this)}});return o}),define("subtitles",["hammer","base_ui_module","zeus_utils","zeus_constants"],function(e,t,i,n){var a=i.css,r=i.dom,o=t.subclass({constructor:function(e){t.prototype.constructor.call(this,e);var i=this;i._currentCues=[],i._language="None",i._container=r.getUI(n.UI.SUBTITLE_MENU),i._selectedElement=null,i._onItemClicked=function(e){e.preventDefault();var t=e.currentTarget;i._language=t.textContent,i._loadCaption()},i.subtitleBtn=r.getUI(n.UI.SUBTITLE_BTN),View.addEventListener(n.UI.Event.MOUSE_OVER,function(e){e.target===r.getUI(n.UI.SUBTITLE_BTN)&&i.open()}),View.addEventListener(n.UI.Event.MOUSE_OUT,function(e){e.target===r.getUI(n.UI.SUBTITLE_BTN)&&i.close()}),View.on(n.Media.Event.TIME_UPDATE,function(){View.currentPlayer.isAd()||i.syncCaption()})},toggle:function(){var e=this;e.isOpen?e.close():e.open()},init:function(){var t=this;if(t.subtitleBtn)if(client.isMobile)if(client.system.android)t.subtitleBtn.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),t.toggle()});else{var i=new e(t.subtitleBtn);i.on("tap",function(e){e.srcEvent.stopPropagation(),e.srcEvent.preventDefault(),t.toggle()})}else{t.subtitleBtn.addEventListener("mouseenter",function(e){r.isEnabled(this)&&("8"!==client.system.win&&"8.1"!==client.system.win||!client.browser.chrome&&!client.browser.ie?View.onMouseOver(t.subtitleBtn):t._touchTimeout=setTimeout(function(){View.mouseInput.isTouched||View.onMouseOver(t.subtitleBtn)},100))}),t.subtitleBtn.addEventListener("mouseleave",function(e){r.isEnabled(t.subtitleBtn)&&(e.stopPropagation(),View.mouseInput.isTouched||View.onMouseOut(t.subtitleBtn))});var i=new e(t.subtitleBtn);"8"!==client.system.win&&"8.1"!==client.system.win||!client.browser.chrome&&!client.browser.ie||i.on("hammer.input",function(e){r.isEnabled(t.subtitleBtn)&&"touch"===e.pointerType&&("touchstart"===e.srcEvent.type||"pointerdown"===e.srcEvent.type?(View.mouseInput.isTouched=!0,t._touchTimeout&&(clearTimeout(t._touchTimeout),t._touchTimeout=null)):"touchend"!==e.srcEvent.type&&"pointerup"!==e.srcEvent.type||e.isFinal&&t.toggle())})}},_loadCaption:function(){var e=this,t=e._language;if(LOG.debug("LOAD CAPTION",t),"None"===t)return void(e._currentCues=null);var n,a=CurrentVideoConfig.content.captions;for(var r in a){var o=a[r];if(o.language===t){n=o;break}}void 0!==n&&i.xhr(n.href,"get",null,function(i){i&&(LOG.debug("caption loaded",t),"webvtt"==n.type&&require(["webvttparser"],function(t){var n=new t,a=n.parse(i);e._currentCues=a.cues,e.syncCaption()}))},function(){LOG.warn("Failed to load caption",n.href)})},syncCaption:function(){var e=this,t=n.UI,i=window.ContentPlayer,a=i.currentTime;if(e._currentCues&&0!==e._currentCues.length){var o=r.getUI(t.SUBTITLE_TEXT);if(o.textContent="",r.hideElement(t.SUBTITLE_TEXT),e._currentCues.length>0)for(var s=0;s<e._currentCues.length;s++){var d=e._currentCues[s],l=d.startTime,u=d.endTime,c=d.text;if(a>=l&&u>=a){o.textContent=c,r.isVisible(o)||r.showElement(t.SUBTITLE_TEXT);break}}}},init:function(e){for(;this._container.firstChild;)this._container.removeChild(this._container.firstChild);if(Array.isArray(e)){var t=document.createElement("div");t.setAttribute("class","bolt-menu-option bolt-hover-highlight bolt-background-color"),t.textContent="None",this._container.appendChild(t),t.addEventListener("click",this._onItemClicked.bind(this));for(var i=0;i<e.length;i++){var n=e[i],a=document.createElement("div");a.setAttribute("class","bolt-menu-option bolt-hover-highlight bolt-background-color"),a.textContent=n.language,this._container.appendChild(a),a.addEventListener("click",this._onItemClicked.bind(this))}}},invalidate:function(){var e=this;if(View.currentPlayer.isAd())r.hideElement(e.subtitleBtn),r.hideElement(e._subtitleMenu);else if(e._language)for(var t=0;t<this._container.children.length;t++){var i=this._container.children[t];if(i.textContent.toLowerCase()==e._language.toLowerCase()){this._selectElement(i);break}}else this._selectElement(null)},_selectElement:function(e){this._selectedElement&&a.removeClass(this._selectedElement,"bolt-selected"),e&&a.addClass(e,"bolt-selected"),this._selectedElement=e},open:function(){View.currentPlayer.isAd()||(t.prototype.open.call(this),this.invalidate())}});return o}),define("volume",["hammer","dragdealer","base_ui_module","zeus_utils","zeus_constants"],function(e,t,i,n,a){var r=window.client,o=window.View,s=n.dom,d=i.subclass({constructor:function(e){i.prototype.constructor.call(this,e);var t=this,n='<svg class="bolt-volume-marker bolt-foreground" width="512px" height="512px" viewbox="0 0 512 512" xml:space="preserve"><circle cx="256" cy="256" r="256" /></svg>';t._html='<div data-bolt-ui="volume-slider" class="bolt-volume-slider dragdealer"><div class="bolt-volume-slider-background"></div><div class="bolt-current-volume bolt-block-highlight"></div><div class="bolt-handle bolt-foreground">'+n+"</div></div>",t._container=s.getUI(a.UI.VOLUME_CONTROL),t.soundBtn=s.getUI(a.UI.SOUND_BTN),t._container.insertAdjacentHTML("beforeend",t._html),t._background=t._container.querySelector(".bolt-volume-slider-background"),t._handle=t._container.querySelector(".bolt-handle"),t._fill=t._container.querySelector(".bolt-current-volume"),t._fillMaxHeight=parseFloat(getComputedStyle(t._background).height),t._slider=null,t._tooltipTimeout=null,o.addEventListener(a.UI.Event.MOUSE_OVER,function(e){e.target===t.soundBtn&&(LOG.info("View mouse enter sound btn"),t.open())}),o.addEventListener(a.UI.Event.MOUSE_OUT,function(e){e.target!==t.soundBtn&&e.target!=window.Skin||t.close()})},init:function(){if(this._container){var i=this._container.querySelector(".bolt-volume-slider");this._slider=new t(i,{vertical:!0,horizontal:!1,top:0,bottom:-parseFloat(getComputedStyle(this._handle).height)/2,animationCallback:this._onSliderUpdate.bind(this),handleClass:"bolt-handle",css3:!1}),this.setPlayer(this.player);var n=this;if(r.browser.ie>9?this._container.addEventListener("pointerup",function(e){n._slider&&(n._slider.dragging=!1),e.stopPropagation()}):this._container.addEventListener("mouseup",function(e){n._slider&&(n._slider.dragging=!1),e.stopPropagation()}),n.soundBtn){n.soundBtn.addEventListener("mouseenter",function(e){s.isEnabled(n.soundBtn)&&("8"!==r.system.win&&"8.1"!==r.system.win||!r.browser.chrome&&!r.browser.ie?o.onMouseOver(n.soundBtn):n._mouseEnterTimeout=setTimeout(function(){o.mouseInput.isTouched||o.onMouseOver(n.soundBtn)},100))}),n.soundBtn.addEventListener("mouseleave",function(e){s.isEnabled(n.soundBtn)&&(LOG.debug("mouse leave, audio"),e.stopPropagation(),o.onMouseOut(n.soundBtn),o.mouseInput.isTouched=!1)});var d=new e(n.soundBtn);"8"!==r.system.win&&"8.1"!==r.system.win||!r.browser.chrome&&!r.browser.ie?d.on("tap",function(e){s.isEnabled(n.soundBtn)&&o._dispatchEvent(a.UI.Event.TOGGLE_MUTE)}):d.on("hammer.input",function(e){s.isEnabled(n.soundBtn)&&("touch"===e.pointerType?"touchstart"===e.srcEvent.type||"pointerdown"===e.srcEvent.type?(o.mouseInput.isTouched=!0,n._mouseEnterTimeout&&(clearTimeout(n._mouseEnterTimeout),n._mouseEnterTimeout=null)):"touchend"!==e.srcEvent.type&&"pointerup"!==e.srcEvent.type||e.isFinal&&o._dispatchEvent(a.UI.Event.TOGGLE_MUTE):"mouseup"!==e.srcEvent.type&&"pointerup"!==e.srcEvent.type||e.isFinal&&o._dispatchEvent(a.UI.Event.TOGGLE_MUTE))})}o.addEventListener(a.UI.Event.PLAYER_CHANGED,function(){var e=a.UI;o.currentPlayer.isAd()?BoltAdManager.type===a.Ad.Type.STATIC_IMAGE||BoltAdManager.type===a.Ad.Type.THREE_TWO_FIFTY?s.enableUI(e.SOUND_BTN,!1):s.enableUI(e.SOUND_BTN,!0):o._adOnly||r.isMobile||s.enableUI(e.SOUND_BTN,!0)})}},_onVolumeChanged:function(){this._slider&&!this._slider.dragging&&this._updateHandle(),this._updateFill()},_onSliderUpdate:function(e,t){var i=this;if(i._tooltipTimeout&&clearTimeout(i._tooltipTimeout),i.soundBtn.setAttribute("data-zeus-tooltip","false"),o.hideTooltip(i.soundBtn),i._slider&&i._slider.dragging){LOG.info("disable volume button"),i.soundBtn.setAttribute("data-bolt-ui-enabled","false");var n=setInterval(function(){i._slider.dragging||(clearInterval(n),i.soundBtn.setAttribute("data-bolt-ui-enabled","true"))},100)}i._slider&&LOG.info("slider val",this._slider.getValue()[1]),this._dispatchEvent(a.VALUE_CHANGED,1-t)},invalidate:function(){var e=this;e._fillMaxHeight=parseFloat(getComputedStyle(e._background).height),e._slider.reflow(),e._updateHandle(),e._updateFill()},_updateFill:function(){var e=this._fill,t=n.getScreenPosition(this._handle),i=n.getScreenPosition(this._handle.parentNode),a=t.y-i.y,r=this.player.muted?0:this._fillMaxHeight-a+"px";e&&(e.style.height=r)},_updateHandle:function(){var e=this.player.muted?1:1-this.player.volume;this._slider.setValue(0,e,!0,!0)},open:function(){i.prototype.open.call(this);var e=this;e._tooltipTimeout&&clearTimeout(e._tooltipTimeout),e._tooltipTimeout=setTimeout(function(){e.soundBtn.setAttribute("data-zeus-tooltip","false")},1e3),e.invalidate()},close:function(){i.prototype.close.call(this),this._tooltipTimeout&&clearTimeout(this._tooltipTimeout),this.soundBtn.setAttribute("data-zeus-tooltip","true")},_onMediaMuted:function(e){LOG.info("media muted"),this._slider&&!this._slider.dragging&&this._updateHandle(),this._updateFill()},_onMediaUnmuted:function(e){LOG.info("media unmuted"),this._slider&&!this._slider.dragging&&this._updateHandle(),this._updateFill()},setPlayer:function(e){this.player=e,LOG.info("player volume",e.volume),e.addEventListener(a.Media.Event.VOLUME_CHANGED,this._onVolumeChanged.bind(this)),e.addEventListener(a.Media.Event.MUTED,this._onMediaMuted.bind(this)),e.addEventListener(a.Media.Event.UNMUTED,this._onMediaUnmuted.bind(this))}});return d}),define("agegate",["base_ui_module","zeus_utils","zeus_constants"],function(e,t,i){var n=window.client,a=(window.View,t.dom),r=t.css,o=e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),this._cookieName="playwireViewerBirthDate",this._cookieExpiryHours=24,this._container=a.getUI(i.UI.AGE_GATE_LAYER),this._form=a.getUI(i.UI.AGE_GATE_FORM),this._dayInput=a.getUI(i.UI.AGE_GATE_DAY_INPUT),this._monthInput=a.getUI(i.UI.AGE_GATE_MONTH_INPUT),this._yearInput=a.getUI(i.UI.AGE_GATE_YEAR_INPUT),this._submitBtn=a.getUI(i.UI.AGE_GATE_FORM_SUBMIT),this._failedMessage=a.getUI(i.UI.AGE_GATE_FAILED_MESSAGE),this._inputErrorMessage=a.getUI(i.UI.AGE_GATE_INPUT_ERROR),this._submitBtn.addEventListener("mouseup",this._validateInput.bind(this)),this._submitBtn.addEventListener("keypress",this._validateInput.bind(this)),this._dayInput.addEventListener("keyup",this._handleInputKey.bind(this)),this._monthInput.addEventListener("keyup",this._handleInputKey.bind(this)),this._yearInput.addEventListener("keyup",this._handleInputKey.bind(this)),n.hasTouch&&this._submitBtn.addEventListener("touchend",this._validateInput.bind(this)),this._inputs=[this._dayInput,this._monthInput,this._yearInput,this._submitBtn],this._inputs.sort(function(e,t){var i=parseInt(e.getAttribute("tabindex")),n=parseInt(t.getAttribute("tabindex"));return i-n})},init:function(){a.hideElement(this._container)},invalidateCookie:function(){var e=window.bdateInUTCMilliSeconds;LOG.debug("agegate cookie",e);var t=!1;if("number"==typeof e){var i=new Date,n=window.CurrentVideoConfig.settings.minAge,a=new Date(i.getFullYear()-n,i.getMonth(),i.getDate()),r=Date.parse(a.toString());t=r>=e}this._gateViewer(t,!0,e)},_validateInput:function(e){if("touchend"===e.type&&e.preventDefault(),"keypress"!==e.type||e.keyCode&&"13"==e.keyCode){var t=parseInt(this._dayInput.value),i=parseInt(this._monthInput.value),n=parseInt(this._yearInput.value),o=new Date,s=!1,d=!1;if(!i||i>12||1>i?(r.addClass(this._monthInput,"bolt-input-error"),s=!0):r.removeClass(this._monthInput,"bolt-input-error"),!n||n>o.getFullYear()?(r.addClass(this._yearInput,"bolt-input-error"),s=!0):r.removeClass(this._yearInput,"bolt-input-error"),(!t||t>31)&&(d=s=!0),!s&&!d&&!d)if(2!=i)d=8>i?i%2==0&&t>30:i%2!=0&&t>30;else if(d=t>29,!d){var l=n%4==0;l&&n%100==0&&(l=n%400==0),d=!l&&t>28}d?(r.addClass(this._dayInput,"bolt-input-error"),s=!0):r.removeClass(this._dayInput,"bolt-input-error"),s?(a.showElement(this._inputErrorMessage),this._inputErrorMessage.textContent="Please enter a valid date."):this._testAgeInputs(i,t,n,o)}},_testAgeInputs:function(e,t,i,n){var a=window.CurrentVideoConfig.settings.minAge||0,r=e-1,o=new Date(n.getFullYear()-a,n.getMonth(),n.getDate()),s=Date.parse(o.toString()),d=new Date(i,r,t),l=Date.parse(d.toString()),u=s>=l;this._gateViewer(u,!1,l)},_gateViewer:function(e,t,n){e?(a.hideElement(this._container),LOG.info("gate viewer",e),this._dispatchEvent(i.UI.Event.AGE_GATE_PASSED,{bd:n,expiry:this._cookieExpiryHours})):(t?(a.showElement(this._form),a.hideElement(this._failedMessage)):(a.hideElement(this._form),a.showElement(this._failedMessage)),this._dispatchEvent(i.UI.Event.AGE_GATE_FAILED),this.open())},_handleInputKey:function(e){var t=this._inputs.indexOf(e.target);if(!n.system.ios&&e.target.value.length===parseInt(e.target.getAttribute("maxlength"))){var i=this._inputs[t+1];i&&i.focus()}},open:function(){e.prototype.open.call(this),this._container&&(this._container.style.visibility="visible"),LOG.debug("agegate open")},close:function(){LOG.debug("agegate close"),e.prototype.close.call(this),this._container&&(this._container.style.visibility="hidden"),this._inputTimer&&(clearInterval(this._inputTimer),this._inputTimer=null)}});return o}),define("tooltip_manager",["base_ui_module","zeus_utils","zeus_constants"],function(e,t,i){var n,a=null,r=[],o=t.css,s=e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),n=this},init:function(){for(var e=this,t=document.getElementsByClassName("bolt-tooltip"),i=0;i<t.length;i++){var n=t[i],a=n.parentNode,o={tooltip:n,target:a,pointer:e._createTooltipPointer(n),isOpen:!1};n.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation()}),a.addEventListener("mouseenter",e.open.bind(a)),a.addEventListener("mouseleave",e.close.bind(a)),r.push(o)}this.invalidate()},_createTooltipPointer:function(e){e.style.display="none",e.style.visibility="visible";var t=document.createElement("div");return t.style.position="absolute",t.style.width=0,t.style.height=0,t.style.borderWidth="5px",t.style.borderStyle="solid",t.style.borderColor=getComputedStyle(e).backgroundColor+" transparent transparent",o.hasClass(e,"bolt-tooltip-bottom")&&(t.style.borderColor="transparent transparent "+getComputedStyle(e).backgroundColor+" transparent"),e.appendChild(t),t},invalidate:function(){for(var e in r){var t=r[e];if(t.isOpen){var i=t.tooltip,n=parseFloat(getComputedStyle(i).width),a=parseFloat(getComputedStyle(i).height),s=t.pointer,d=s.offsetWidth,l=s.offsetHeight,u=t.target,c=u.offsetWidth,h=u.offsetHeight;o.hasClass(i,"bolt-tooltip-bottom")&&(i.style.top=h+"px",s.style.top=-(a-l)+"px"),o.hasClass(i,"bolt-tooltip-right")?(i.style.left="auto",i.style.right=0,s.style.right="auto",s.style.left=n-d/2-c/2+"px"):o.hasClass(i,"bolt-tooltip-left")?(i.style.left=0,i.style.right="auto",s.style.right="auto",s.style.left=(c-d)/2+"px"):(i.style.left=-(n-c)/2+"px",s.style.right="auto",s.style.left=(n-d)/2+"px")}}},open:function(){a&&clearTimeout(a);var e=this,t=null;for(var o in r){var s=r[o];if(s.target===e){t=s.tooltip,a=setTimeout(function(){clearTimeout(a),a=null,t.style.display="block",s.isOpen=!0,n.invalidate(),a=setTimeout(function(){clearTimeout(a),t.style.display="none"},1e3)},i.UI.TOOLTIP_DELAY);break}}},close:function(){a&&(clearTimeout(a),a=null);var e=this,t=null;for(var i in r){var n=r[i];n.target===e&&(t=n.tooltip,t.style.display="none",n.isOpen=!1)}},_getTooltipOfElement:function(e,t){var i=e.querySelector('*[class*="bolt-tooltip"]');return i&&t?i.firstElementChild:i},setLabel:function(e,t){if(e){var i=this._getTooltipOfElement(e,!0);i.textContent=t}}});return s}),define("related_videos",["base_ui_module","hammer","zeus_utils","zeus_constants"],function(e,t,i,n){var a=i.dom,r=e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),this._html='<div class="bolt-related-container"><div class="bolt-related-header bolt-foreground">Related Videos</div><div class="bolt-related-menu"></div></div>',this._container=a.getUI(n.UI.RELATED_VIDEOS),this._container.insertAdjacentHTML("beforeend",this._html),this._menu=this._container.querySelector(".bolt-related-menu")},init:function(e){var t=this;if(PlayerState.on(PlayerState.STATE_CHANGED,function(){switch(PlayerState.state){case PlayerState.PLAY:case PlayerState.PLAYING:t.close()}},t),void 0!==e&&e.length>0){for(var i=this._menu;i.firstChild;)i.removeChild(i.firstChild);for(var n=0;n<e.length;n++){var a,r,o;window.PlayerSettings.freePlayer?(a=e[n].content,r=e[n].settings.title,o=a.videoId):(a=e[n],r=a.title,o=a.videoId);var s=document.createElement("div");s.setAttribute("class","bolt-related-title bolt-foreground"),s.textContent=r;var d=document.createElement("div");d.setAttribute("class","bolt-related-video"),d.setAttribute("data-video-id",o),d.style.backgroundImage="url("+a.thumb+")",d.addEventListener("click",this._onRelatedVideoClicked.bind(this));var l=document.createElement("div");l.setAttribute("class","bolt-related-video-border"),d.appendChild(s),d.appendChild(l),i.appendChild(d)}}},_onRelatedVideoClicked:function(e){e.stopPropagation();var t=e.currentTarget,a=t.getAttribute("data-video-id");i.log.info("related video clicked",a),this._dispatchEvent(n.UI.Event.RELATED_VIDEO_SELECTED,a),this.close()},open:function(){var e=this;e.isOpen||(e.isOpen=!0,a.showElement(this._container),View._prerollScreen&&View._prerollScreen.close())},close:function(){var e=this;e.isOpen&&(e.isOpen=!1,a.hideElement(this._container))}});return r}),define("watermark",["base_ui_module","zeus_utils","zeus_constants"],function(e,t,i){var n=(window.View,t.dom),a=t.css,r=e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),this._container=n.getUI(i.UI.WATERMARK),this._imageEl=n.getUI(i.UI.WATERMARK_IMG)},init:function(){this.create()},create:function(){t.log.info("creating watermark");var e=this;try{for(;e._container.firstChild;)e._container.removeChild(e._container.firstChild)}catch(i){}var r=PlayerSettings.watermark?PlayerSettings.watermark.image:null,o=PlayerSettings.watermark?PlayerSettings.watermark.text:null;!r&&o&&/.gif|.png|.jpg|.jpeg/i.test(o)&&(r=o);var s=PlayerSettings.watermark?PlayerSettings.watermark.href:null;if(r||o){if(ContentPlayer.watermark={image:r,href:s,text:o},e.open(),r?(e._imageEl||(e._imageEl=document.createElement("t._imageEl")),e._imageEl.setAttribute("src",t.normalizeProtocol(r)),e._container.appendChild(e._imageEl)):n.hideElement(e._imageEl),s){var d=document.createElement("a");d.href=t.normalizeProtocol(s),d.target="_blank",a.addClass(d,"bolt-custom-font"),a.addClass(d,"bolt-custom-text-color"),e._container.appendChild(d),r&&e._imageEl?d.appendChild(e._imageEl):d.textContent=o,d.title=o}else if(!r&&o){var l=document.createElement("p");l.textContent=o,e._container.appendChild(l)}e.updateAppearance()}},updateAppearance:function(){for(var e=this,t=["bottom-left","bottom-right","top-left","top-right"],i=0;i<t.length;i++)a.removeClass(e._container,t[i]);"top-right"===PlayerSettings.appearance.watermark.position?a.addClass(e._container,"top-right"):"bottom-left"===PlayerSettings.appearance.watermark.position?a.addClass(e._container,"bottom-left"):"top-left"===PlayerSettings.appearance.watermark.position?a.addClass(e._container,"top-left"):a.addClass(e._container,"bottom-right"),PlayerSettings.appearance.watermark.opacity&&(e._container.style.opacity=PlayerSettings.appearance.watermark.opacity)}});return r}),define("zeus_flashshim",["zeus_eventdispatcher","swfobject"],function(e){function t(t,n,a,r){LOG.debug(t,"flash shim instance",a),e.mixin(this),this._container=document.body,this._targetEl=document.getElementById(n),this._pastFirstQuartile=!1,this._pastMidpoint=!1,this._pastThirdQuartile=!1,this._poster=null,this._targetIsVideo="undefined"!=typeof this._targetEl.canPlayType,this._source=null,this._originalSource=null,this.fastSeekEnabled=!1,this._swf=null,this._swfId=null,this._isAd=r,this.type="flash",this.containerId=t,this.cors=null,this.videoPlayCount=0,this._isPreloading=!1,this.waiting=!1,this.currentTime=0,this.duration=0,this.paused=!1,this.muted=!1,this.fullscreen=!1,this.videoWidth=NaN,this.videoHeight=NaN,this.metadata=null,this.startTime=0,this.width=this._targetEl.clientWidth,this.height=this._targetEl.clientHeight,this.buffered=0,this.volume=1,this.canplay=!1,this.canplaythrough=!1,this.loop=null,this.stopped=!1,this.ended=!1,this.playing=!1,this.waiting=!1,this.hasStarted=!1,this.sourceChanged=!1,this.qualityChanged=!1,this.seekTime=null,this.adsCuepoints=[],this.previousCuepointIndex=-1,this.currentQuality=r?void 0:CurrentVideoConfig.settings.defaultHd?"hd":"sd",this.relatedVideos=[],this.playerReady=!1,this.autoplay=!1,this._preload=null,this._bufferedTime=0,this._flashEventCallbacks={target:null,onMetadataLoaded:function(e){var t=this.target,n=e.data;t._isPreloading=!1,t.metadata||(LOG.debug(t.containerId,"onMetadataLoaded",e.data),t.metadata=n,t.videoWidth=n.width,t.videoHeight=n.height,t._dispatchEvent(i.Media.Event.METADATA,t.metadata))},onCanPlay:function(e){var t=this.target;t.canplay=!0,t._wait(!1),t._dispatchEvent(i.Player.Event.CANPLAY)},onDurationChanged:function(e){var t=this.target;LOG.debug(t.containerId,"onDurationChanged",t._swf,"autoplay",t.autoplay,"sourcechanged",t.sourceChanged,"quality changed",t.qualityChanged),t.sourceChanged?(t.duration=e.data,LOG.debug(t.containerId,"new source duration",t.duration,"autoplay",t.autoplay),t._dispatchEvent(i.Media.Event.DURATION_CHANGE,t.duration),t.startTime=0,t._dispatchEvent(i.Media.Event.START_TIME_CHANGED,0),t.sourceChanged=!1,t.autoplay&&(LOG.info(t.containerId,"autoplay"),t.play())):t.qualityChanged?(t.qualityChanged=!1,t.fastSeekEnabled?(t.startTime=t.currentTime,t._dispatchEvent(i.Media.Event.START_TIME_CHANGED,t.currentTime),t.autoplay&&t.play()):t.seek(t.currentTime)):t.seekTime?t.fastSeekEnabled&&(t.seekTime=null,t.play()):t.autoplay&&t.play(),t._dispatchEvent(i.Media.Event.LOADED)},onCanPlayThrough:function(e){var t=this.target;t.canplaythrough=!0,t._dispatchEvent(i.Player.Event.CANPLAYTHROUGH)},onEnded:function(e){var t=this.target;t.playing=!1,t.ended=!0,t.stopped=!1,t.hasStarted=!1,t.autoplay=!1,t._dispatchEvent(i.Media.Event.ENDED)},onIOError:function(e){var t=this.target;LOG.error(t.containerId,"IO ERROR "+e.data)},onProgress:function(e){var t=this.target;t._bufferedTime=t.fastSeekEnabled?e.data+t.startTime:e.data,t.buffered=Math.round(100*t._bufferedTime/t.duration),t.buffered>100&&(t.buffered=100),t._dispatchEvent(i.Media.Event.LOAD_PROGRESS,t.buffered)},onPlaying:function(e){this.target._wait(!1)},onTimeUpdate:function(e){var t=this.target;t._wait(!1),e.data!=t.currentTime&&(t.currentTime=e.data+t.startTime,t.currentTime>t.duration&&(t.currentTime=t.duration),t.ended||t.paused||t.stopped||t.playing||(t.playing=!0,t._dispatchEvent(i.Media.Event.PLAYING)),t._dispatchEvent(i.Media.Event.TIME_UPDATE,t.currentTime),t._checkQuartiles())},onVolumeChanged:function(e){LOG.info("onVolumeChanged",e.data);var t=this.target;t.volume=e.data},onMuted:function(e){LOG.info("onMuted");var t=this.target;t.muted=!0},onUnmuted:function(e){LOG.info("onUnmuted");var t=this.target;t.muted=!1},onStop:function(e){var t=this.target;t.playing=!1,t.currentTime=0,t._dispatchEvent(i.Media.Event.STOPPED)},onSeekStart:function(e){var t=this.target;LOG.debug(t.containerId,"seek start",e.data),t.fastSeekEnabled?t._wait(!0):e.data>t._bufferedTime&&t._wait(!0),t._dispatchEvent(i.Media.Event.SEEKING)},onSeeked:function(e){var t=this.target,n=e.data;LOG.debug(t.containerId,"seeked",n),t.currentTime=t.fastSeekEnabled?n+t.startTime:n,t._dispatchEvent(i.Media.Event.TIME_UPDATE,t.currentTime),t._dispatchEvent(i.Media.Event.SEEKED),t.seekTime=null,t.play()},onSizeChanged:function(e){var t=this.target;t.width=e.data.width,t.height=e.data.height,t._dispatchEvent(i.Player.Event.SIZE_CHANGED,{width:t.width,height:t.height})},onContentChanged:function(e){var t=this.target;t.seekTime||(LOG.debug(t.containerId,"content changed"),t._dispatchEvent(i.Player.Event.CONTENT_CHANGED),t.autoplay&&t.play())},onSWFRemoved:function(e){var t=this.target;LOG.debug(t.containerId,"swf removed"),t._swf=null,t.playerReady=!1},onClick:function(e){var t=this.target;t._isAd||(t.playing?t.pause():t.hasStarted?t.resume():t.play())},onMediaNotFound:function(e){LOG.info("MEDIA NOT FOUND");var t=this.target;t._dispatchEvent(i.Media.Event.NOT_FOUND),t._wait(!1)}},this._init(),this._createFlashObject(n,a,Skin)}var i=window.ZeusConstants,n=window.client;return t.prototype={},t.prototype._flashEventCallbacks=null,t.prototype.stop=function(){this.stopped||(this.stopped=!0,this.paused=!1,this.playing=!1,this.pause())},t.prototype.play=function(){var e=this;e.paused=!1,e.stopped=!1,e.autoplay=!0,LOG.debug(e.containerId,"play player ready",e.playerReady,"metadata ",e.metadata,"hasStarted",e.hasStarted),e.playerReady&&(null===e.metadata?(LOG.info("metadata is null, preload the video"),e.preload()):(e.hasStarted||(LOG.debug(e.containerId,"PLAY",e.startTime),e._dispatchEvent(i.Media.Event.PLAY),e.hasStarted=!0),e.ended?e.replay():(e._swf.play(),(0==e._bufferedTime||e._bufferedTime<e.startTime)&&e._wait(!0))))},t.prototype.replay=function(){var e=this;LOG.debug(e.containerId,"replay"),e.ended=!1,e.autoplay=!0,e.fastSeekEnabled?(LOG.debug(e.containerId,"pseudostream replay"),LOG.debug(e.containerId,"startTime is ",e.startTime),e.startTime>0?e.seek(0):(e.stop(),e.play())):(e.stop(),e.play())},t.prototype.pause=function(){
var e=this;e.paused=!0,e.playing=!1,e._dispatchEvent(i.Media.Event.PAUSED),1==e.playerReady&&(LOG.debug(e.containerId,"pause"),e._swf.pause(),this.stopped&&this._swf.stop())},t.prototype.resume=function(){var e=this;this.playing||(e.hasStarted?(LOG.debug(e.containerId,"RESUME"),e.playerReady===!0&&(e.paused=!1,e._dispatchEvent(i.Media.Event.RESUME),e.stopped?e.play():e._swf.resume())):(e.paused=!1,e.play()))},t.prototype.show=function(e){var t=this;t._swf&&(t._swf.style.height=e?0:"100%")},t.prototype.unload=function(){this.pause()},t.prototype.remove=function(){this._swf&&(this._swf.removeAllEventCallbacks(),swfobject.removeSWF(this._swfId),LOG.debug(this.containerId,"swf removed"),this._dispatchEvent(i.Player.Event.REMOVED)),this._swf=null,this.playerReady=!1,this._flashEventCallbacks=null,this.removeAllListeners()},t.prototype.seek=function(e){function t(){n.startTime=e,n._dispatchEvent(i.Media.Event.START_TIME_CHANGED,n.startTime);var t=-1===n._originalSource.indexOf("?")?"?":"&",a=e>0?n._originalSource+t+"ec_seek="+n.startTime+"&start="+n.startTime:n._source;n._swf.setSource(a),n.preload()}var n=this;LOG.debug(n.containerId,"seek",e,"buffered",n._bufferedTime),n.seekTime=e,n.playerReady===!0?n.fastSeekEnabled?n.startTime>0?t():e<=n._bufferedTime?n._swf.seek(e):t():n._swf.seek(e):LOG.error("CANNOT SEEK BEFORE PLAYER READY")},t.prototype.setVolume=function(e){var t=this;t.volume=e,LOG.info("setVolume",e),t._dispatchEvent(i.Media.Event.VOLUME_CHANGED,t.volume),t.playerReady===!0&&t._swf.setVolume(e)},t.prototype.mute=function(e){var t=this;t.muted=e,1==t.playerReady&&(LOG.debug(t.containerId,"mute",e),t._swf.mute(e)),1==t.muted?t._dispatchEvent(i.Media.Event.MUTED):t._dispatchEvent(i.Media.Event.UNMUTED)},t.prototype.onVideoConfigChanged=function(){var e=this;e.playing=!1,e.ended=!1,e.stopped=!1,e.hasStarted=!1,e.duration=e.currentTime=0,e.buffered=0;var t=window.CurrentVideoConfig;null==e.loop&&"undefined"==typeof window.Playlist&&(e.loop=t?t.settings.loop:e.loop,LOG.debug(e.containerId,"loop via config",e.loop)),this.adsCuepoints="undefined"!=typeof t.advertising.cuepoints?t.advertising.cuepoints.concat():[],LOG.info(this.containerId,"ads cuepoints",this.adsCuepoints),e._dispatchEvent(i.Player.Event.CONFIG_CHANGED)},t.prototype.preload=function(){var e=this;e._isPreloading||(e._wait(!0),e.metadata=null,e.playerReady===!0?(LOG.debug(e.containerId,"FLASH preload"),e._isPreloading=!0,e._swf.preload()):(LOG.debug(e.containerId,"preload player is not ready"),e._preload=!0))},t.prototype.setQuality=function(e,t){var n=this;if(e!=n.currentQuality){if(n._originalSource=t,n.currentQuality=e,n.qualityChanged=!0,n._dispatchEvent(i.Player.Event.QUALITY_CHANGED,n.currentQuality),LOG.debug(n.containerId,"PSEUDO STREAM ENABLED",n.fastSeekEnabled),n.playing=!1,n.fastSeekEnabled){var a=-1===t.indexOf("?")?"?":"&";n._source=n.currentTime>0?t+a+"ec_seek="+n.currentTime+"&start="+n.currentTime:t}else n._source=t;LOG.debug(n.containerId,"setQuality","autoplay",n.autoplay,"_preload",n._preload,"playerReady",n.playerReady,"source",n._source),n.playerReady?(n._swf.setSource(n._source),n.preload()):(n._preload=!0,n._swf.setSource(n._source))}},t.prototype.resetQuartiles=function(){this._pastFirstQuartile=!1,this._pastMidpoint=!1,this._pastThirdQuartile=!1},t.prototype.setSource=function(e){LOG.debug(this.containerId,"setSource",e),this._source=e,this._originalSource=e,this.resetQuartiles(),this.metadata=null,this.playing=!1,this.hasStarted=!1,this.currentTime=0,this.ended=!1,this.sourceChanged=!0,this.fastSeekEnabled=ZeusUtils.fastSeekEnabled(e),LOG.debug(this.containerId,"PSEUDO STREAM ENABLED",this.fastSeekEnabled),n.browser.safari>0&&(this._source=this._source+"?"+Date.now()),this._swf&&(LOG.debug(this.containerId,"set swf source",this._source,"autoplay",this.autoplay),this._swf.setSource(this._source)),this.preload()},t.prototype.getSource=function(){return this._source},t.prototype.hitAdCuepoint=function(e){var t=e;this.previousCuepointIndex=this.currentVideoConfig.advertising.cuepoints.indexOf(t),this._dispatchEvent(i.Ad.Event.CUEPOINT,e)},t.prototype._init=function(){var e=this,t=e.config;if(t&&(e._poster=t.settings.poster,e._poster||t.video.content&&(e._poster=t.video.content.poster),e.loop=t.settings.loop,LOG.debug(e.containerId,"embed loop",e.loop),e.currentQuality=t.settings.defaultHd?"hd":"sd",e.onVideoConfigChanged()),e._targetIsVideo){for(e._source=e._originalSource=e._targetEl.getAttribute("src")||document.body.getAttribute("data-default-src"),e._poster||(e._poster=e._targetEl.poster);e._targetEl.children.length>0;)e._targetEl.removeChild(e._targetEl.firstChild);e._targetEl.src=""}LOG.debug(e.containerId,"POSTER",e._poster),e.sourceChanged=!!e._source,LOG.debug(e.containerId,"PSEUDO STREAM ENABLED",e.fastSeekEnabled)},t.prototype._createFlashObject=function(e,t,n){var a="11",r=i.Player.SWFROOT,o=i.Player.FLASH_SHIM,s=this,d={shimInstance:t,src:s._source,swfLocation:r,videoPlayer:i.Player.VIDEO_SHIM,swfPlayer:i.Player.SWF_PLAYER},l={allowscriptaccess:"always",wmode:"opaque",allowfullscreen:!0,quality:"high",bgcolor:"#000000"},u={id:e,name:e};if(void 0!==n){s._targetEl.id="";var c=document.createElement("div");c.style.position="absolute",c.id="dummy",c.style.top=0,c.style.left=0,c.style.bottom=0,c.style.right=0,c.style.width="100%",c.style.height="100%",c.style.backgroundColor="#000",c.style.display="block",s._targetEl.parentNode.appendChild(c),swfobject.embedSWF(o,c.id,"100%","100%",a,null,d,l,u)}else swfobject.embedSWF(o,s._targetEl.id,"100%","100%",a,null,d,l,u);s._swfId=u.id},t.prototype.isAd=function(e){var t=this;return"undefined"==typeof e?t._isAd:void(t._isAd=e)},t.prototype._registerEventCallback=function(e,t){var i=this;i._flashEventCallbacks.target=this;var n=i._flashEventCallbacks[t];"function"==typeof n?i._swf.addEventCallback(e,"_flashEventCallbacks."+t):console.warn(t,"is undefined")},t.prototype.swfLoaded=function(){LOG.debug(this.containerId,"swf loaded "),this._swf=swfobject.getObjectById(this._swfId),this._registerEventCallback("IOError","onIOError"),this._source&&this._swf.setSource(this._source)},t.prototype.onPlayerReady=function(){var e=this;LOG.debug(e.containerId,"player component is ready for",e._swf),e.playerReady=!0,e._registerEventCallback("loadedmetadata","onMetadataLoaded"),e._registerEventCallback("durationchange","onDurationChanged"),e._registerEventCallback("progress","onProgress"),e._registerEventCallback("playing","onPlaying"),e._registerEventCallback("canplay","onCanPlay"),e._registerEventCallback("canplaythrough","onCanPlayThrough"),e._registerEventCallback("timeupdate","onTimeUpdate"),e._registerEventCallback("volumechange","onVolumeChanged"),e._registerEventCallback("muted","onMuted"),e._registerEventCallback("unmuted","onUnmuted"),e._registerEventCallback("ended","onEnded"),e._registerEventCallback("stop","onStop"),e._registerEventCallback("seekstart","onSeekStart"),e._registerEventCallback("seeked","onSeeked"),e._registerEventCallback("sizechanged","onSizeChanged"),e._registerEventCallback("contentchanged","onContentChanged"),e._registerEventCallback("removedFromStage","onSWFRemoved"),e._registerEventCallback("click","onClick"),e._registerEventCallback("mediaNotFound","onMediaNotFound"),e._dispatchEvent(i.Player.Event.READY),e._swf.setVolume(e.volume),e._swf.mute(e.muted),(e.autoplay||e._preload)&&e.preload()},t.prototype._checkQuartiles=function(){var e=this;if(e.currentTime&&e.duration){var t=e.currentTime/e.duration*100;!e._pastFirstQuartile&&t>=25?(e._pastFirstQuartile=!0,e._dispatchEvent(i.Media.Event.FIRSTQUARTILE)):!e._pastMidpoint&&t>=50?(e._pastMidpoint=!0,e._dispatchEvent(i.Media.Event.MIDPOINT)):!e._pastThirdQuartile&&t>=75&&(e._pastThirdQuartile=!0,e._dispatchEvent(i.Media.Event.THIRDQUARTILE))}},t.prototype._wait=function(e){var t=this;if(-1==t._source.indexOf("rtmp")){if(e==t.waiting)return;1==e&&t._dispatchEvent(i.Media.Event.WAITING)}t.waiting=e},t.prototype.setFullscreen=function(e){e!==this.fullscreen&&(this.fullscreen=e)},t}),define("zeus_video_base",["zeus_eventdispatcher","zeus_utils","hls_lib"],function(e,t,i){var n=window.ZeusConstants,a=window.client,r=e.subclass({constructor:function(){this.video=null,this._poster=null,this._pastFirstQuartile=!1,this._pastMidpoint=!1,this._pastThirdQuartile=!1,this._bufferedTime=0,this._source=null,this.fastSeekEnabled=!1,this._isEnabled=!0,this._isRemoved=!1,this.type="native",this.videoPlayCount=0,this.cors=null,this.containerId=null,this.videoId=null,this.sourceChanged=!1,this._isAd=!1,this.buffered=0,this.ended=!1,this.paused=!1,this.muted=!1,this.fullscreen=!1,this.videoWidth=NaN,this.videoHeight=NaN,this.metadata=null,this.currentTime=0,this.duration=0,this.startTime=0,this.width=0,this.height=0,this.playing=!1,this.parent=null,this.canplay=!1,this.canplaythrough=!1,this.volume=1,this.loop=null,this.stopped=!1,this.hasStarted=!1,this.qualityChanged=!1,this.seekTime=null,this.adsCuepoints=[],this.previousCuepointIndex=-1,this.currentQuality=null,this.relatedVideos=[],this.autoplay=!1,this.waiting=!1,this._stalled=!1,this._originalSource=null,this._onLoadStart=this._onLoadStart.bind(this),this._onLoadedMetadata=this._onLoadedMetadata.bind(this),this._onLoadedData=this._onLoadedData.bind(this),this._onDurationChanged=this._onDurationChanged.bind(this),this._onPlay=this._onPlay.bind(this),this._onPause=this._onPause.bind(this),this._onSeeked=this._onSeeked.bind(this),this._onTimeUpdate=this._onTimeUpdate.bind(this),this._onWaiting=this._onWaiting.bind(this),this._onPlaying=this._onPlaying.bind(this),this._onProgress=this._onProgress.bind(this),this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onVolumeChange=this._onVolumeChange.bind(this),this._onEnded=this._onEnded.bind(this),this._onEmptied=this._onEmptied.bind(this),this._onStalled=this._onStalled.bind(this),this._onError=this._onError.bind(this),this._onAbort=this._onAbort.bind(this)}});return r.prototype._init=function(e,i,n){this._isAd=n,this.containerId=e,this.videoId=i,this.video=document.getElementById(i),this.parent=this.video.parentNode,this._source=this.video.src,this.startTime=this.video.startTime||0,this.width=this.video.clientWidth,this.height=this.video.clientHeight,this.volume=this.video.getAttribute("volume")||1,this.muted=this.video.muted,this.videoHeight=this.video.clientHeight,this.videoWidth=this.video.clientWidth,n||(this.loop=window.CurrentVideoConfig.settings.loop,this._poster=window.CurrentVideoConfig.settings.poster,this._poster||(window.CurrentVideoConfig&&window.CurrentVideoConfig.content?this._poster=window.CurrentVideoConfig.content.poster:this._poster=this.video.poster),this._poster=t.normalizeProtocol(this._poster),LOG.debug("poster",this._poster),this.currentQuality=CurrentVideoConfig.settings.defaultHd?"hd":"sd",this.onVideoConfigChanged())},r.prototype.isAd=function(e){LOG.debug("isAd() ABSTRACT METHOD")},r.prototype.preload=function(){var e=this,t=document.body.getAttribute("data-default-src");e._isAd||null!==e._source&&""!==e._source||e.setSource(t),LOG.debug(e.containerId,"preload source = ",e._source,"autoplay",e.autoplay),e._isEnabled||e.enable(!0),e.hls&&e.hls.destroy(),e._source.indexOf(".m3u8")>-1&&!a.nativeHLS?(e.hls=new i,e.hls.attachMedia(e.video),e.hls.on(i.Events.MANIFEST_PARSED,e._onHLSManifestParsed.bind(e)),e.hls.loadSource(e._source)):(e.video.src=e._source,a.browser.firefox>0&&e.video.setAttribute("preload","metadata"),e.video.load())},r.prototype._onHLSManifestParsed=function(e,t){LOG.info("hls manifest loaded, found "+t.levels.length+" quality level"),this.video.play()},r.prototype.play=function(){LOG.debug(this.containerId,this.videoId,"play()",this._isEnabled,this.video.src,this.video.currentSrc),this.show(!0),this.ended?this.replay():(this._isEnabled||this.enable(!0),this.video.play())},r.prototype.replay=function(){LOG.debug(this.containerId,"replay",this.video.src),this.ended=!1,this.fastSeekEnabled?(LOG.debug(this.containerId,"pseudostream replay"),LOG.debug(this.containerId,"startTime is ",this.startTime),this.startTime>0?(this.autoplay=!0,this.seek(0)):(this.stop(),this.play())):(this.autoplay=!0,this.seek(0))},r.prototype.pause=function(){LOG.debug(this.containerId,"pause",this.currentTime),this.paused=!0,this.video.pause()},r.prototype.resume=function(){this.playing||(LOG.debug(this.containerId,"resume",this.currentTime,this.video.currentTime),this.show(!0),this.video.play())},r.prototype.stop=function(){this.stopped||(LOG.debug(this.containerId,"STOP",this.video.src),this.stopped=!0,this.video.pause(),this.video.currentTime=0)},r.prototype.mute=function(e){console.warn("ABSTRACT METHOD NO OP")},r.prototype.setVolume=function(e){console.warn("ABSTRACT METHOD NO OP")},r.prototype.remove=function(e){LOG.debug(this.containerId,"video",this.videoId,"REMOVE"),this._isRemoved=!0,this.video&&(this._disableVideoListeners(),this.video.pause(),this.video.src="",this.video.poster="",e===!0?(this.video.parentNode.removeChild(this.video),this.video=null):this._enableVideoListeners()),this._dispatchEvent(n.Player.Event.REMOVED),this.removeAllListeners()},r.prototype.setSource=function(e){e=t.normalizeProtocol(e),this._isRemoved=!1,this._originalSource=e,this.resetQuartiles(),this.metadata=null,this.playing=!1,this.hasStarted=!1,this.paused=!1,this.ended=!1,this.sourceChanged=!0,this.duration=0,this.buffered=0,this._bufferedTime=0,this.startTime=0,this.currentTime=0,this.waiting=!1,this._dispatchEvent(n.Media.Event.START_TIME_CHANGED,this.startTime),this._dispatchEvent(n.Player.Event.CONTENT_CHANGED),this.fastSeekEnabled=t.fastSeekEnabled(e),LOG.debug(this.containerId,"PSEUDO STREAMING ENABLED",this.fastSeekEnabled),this._enableVideoListeners(),this._updateVideoSource(e)},r.prototype.setQuality=function(e,t){e!==this.currentQuality&&(LOG.debug(this.containerId,"setQuality",e,t),this._originalSource=t,this.autoplay=!0,this.currentQuality=e,this.qualityChanged=!0,this._dispatchEvent(n.Player.Event.QUALITY_CHANGED,this.currentQuality),this._updateVideoSource(t))},r.prototype._updateVideoSource=function(e){console.warn("ABSTRACT METHOD NO OP")},r.prototype.getSource=function(){return this._source},r.prototype.size=function(e,t){this.video.setAttribute("width",e),this.video.setAttribute("height",t),this.width=this.video.clientWidth,this.height=this.video.clientHeight,this._dispatchEvent(n.Player.Event.SIZE_CHANGED)},r.prototype.setFullscreen=function(e){e!==this.fullscreen&&(this.fullscreen=e)},r.prototype.show=function(e){e===!0&&"block"!=this.video.style.display?(LOG.debug(this.containerId,"show video"),this.video.style.display="block"):e===!1&&"none"!=this.video.style.display&&(LOG.debug(this.containerId,"hide video"),this.video.style.display="none")},r.prototype.hitAdCuepoint=function(e){var t=e;this.previousCuepointIndex=window.CurrentVideoConfig.advertising.cuepoints.indexOf(t),this._dispatchEvent(n.Ad.Event.CUEPOINT,e)},r.prototype.unload=function(){var e=this;LOG.info("unload video",this.video.currentSrc),e._isRemoved=!0,e._disableVideoListeners(),e.hls?e.hls.destroy():(e.video.src="",e.video.load())},r.prototype.enable=function(e){this._isEnabled=e,e===!0?(LOG.info(this.containerId,"ENABLE VIDEO",e,this.videoId,this._source,this.video.src),this._enableVideoListeners(),this.setSource(this._source)):(LOG.info(this.containerId,"DISABLE VIDEO",e,this.videoId,this._source,this.video.src),this.unload())},r.prototype._onDurationChanged=function(e){console.warn("ABSTRACT METHOD NO OP")},r.prototype._onPlay=function(e){this.stopped=!1,this.ended=!1,this.hasStarted?this.paused&&(this.paused=!1,this._dispatchEvent(n.Media.Event.RESUME)):(LOG.info("dispatching play event"),this._dispatchEvent(n.Media.Event.PLAY),this.hasStarted=!0)},r.prototype._onPause=function(e){LOG.debug(this.containerId,"onPause",this.currentTime),this.paused=!0,this.playing=!1,this._dispatchEvent(n.Media.Event.PAUSED),this.stopped&&this._dispatchEvent(n.Media.Event.STOPPED)},r.prototype._onSeeked=function(e){LOG.info("onSeeked",window.CurrentVideoConfig.settings.title,this.video.currentSrc),this.stopped||(this._dispatchEvent(n.Media.Event.SEEKED),this.autoplay&&this.video.play()),this.seekTime=null},r.prototype._onTimeUpdate=function(e){if(!this.video)return void LOG.error(this.containerId,"video is null");if(this._stalled=!1,this.currentTime=this.video.currentTime+this.startTime,this.currentTime>this.duration&&(this.currentTime=this.duration),this._dispatchEvent(n.Media.Event.TIME_UPDATE,this.currentTime),this._checkQuartiles(),a.system.android>0&&28===a.browser.chrome&&Math.floor(this.currentTime)===Math.floor(this.video.duration)){var t=new CustomEvent("ended");this.video.dispatchEvent(t)}},r.prototype._onWaiting=function(e){this.waiting=!0,this._dispatchEvent(n.Media.Event.WAITING)},r.prototype._onPlaying=function(e){LOG.debug(this.containerId,"onPlaying",this.currentTime,this.video.currentTime),this.playing=!0,this._dispatchEvent(n.Media.Event.PLAYING)},r.prototype._onProgress=function(e){try{var t=this.fastSeekEnabled?this.video.buffered.end(0)+this.startTime:this.video.buffered.end(0);t!==this._bufferedTime&&(t>this._bufferedTime&&(this._bufferedTime=t),this.buffered=Math.round(100*this._bufferedTime/this.duration),this.buffered>100&&(this.buffered=100))}catch(i){this.buffered=0,this._bufferedTime=0}this._dispatchEvent(n.Media.Event.LOAD_PROGRESS,this.buffered)},r.prototype._onLoadedMetadata=function(e){this.metadata||(this.metadata={duration:this.video.duration,videoWidth:this.video.videoWidth,videoHeight:this.video.videoHeight},LOG.debug(this.containerId,"video metadata",this.metadata,this.video.currentSrc),this._dispatchEvent(n.Media.Event.METADATA,this.metadata))},r.prototype._onCanPlay=function(e){LOG.debug(this.containerId,"onCanPlay",this.video.currentTime),this.waiting=!1,this.canplay=!0,this._dispatchEvent(n.Player.Event.CANPLAY),this._stalled&&(LOG.debug(this.containerId,"onCanPlay after stalled"),this._stalled=!1,this.video.play())},r.prototype._onCanPlayThrough=function(e){this.canplaythrough=!0,this._dispatchEvent(n.Player.Event.CANPLAYTHROUGH)},r.prototype._onVolumeChange=function(e){this.volume=this.video.volume,LOG.info("onVolumeChange",this.volume),this._dispatchEvent(n.Media.Event.VOLUME_CHANGED,this.volume)},r.prototype._onEnded=function(e){this._isAd||LOG.debug(this.containerId,"onEnded",window.CurrentVideoConfig.settings.title),this.ended=!0,this.playing=!1,this.paused=!1,this.hasStarted=!1,this._dispatchEvent(n.Media.Event.ENDED)},r.prototype._onEmptied=function(e){this._isRemoved||this.sourceChanged||(this._isAd||LOG.debug(this.containerId,"onEmptied",window.CurrentVideoConfig.settings.title,this.video.currentSrc),this._dispatchEvent(n.Media.Event.EMPTIED))},r.prototype._onStalled=function(e){this._isRemoved||(this._stalled=!0,this.playing&&(LOG.debug(this.containerId,"video stalled, calling play"),this.video.play()))},r.prototype._onError=function(e){var t="";if(!this._isRemoved){if(this.video.error.code)switch(this.video.error.code){case 1:t="USER ABORT";break;case 2:t="NETWORK ERROR";break;case 3:t="DECODE ERROR";break;case 4:t="MEDIA NOT SUPPORTED"}LOG.error(this.containerId,"ZeusVideo::video error",this.video.error.code,":",t),4===this.video.error.code?a.browser.firefoxWithoutMp4&&this._source.indexOf(".mp4")>-1&&!a.hasFlash?this._dispatchEvent(n.Media.Event.NOT_SUPPORTED):this._dispatchEvent(n.Media.Event.NOT_FOUND):""==this.video.src||this._isRemoved||this.sourceChanged||this._dispatchEvent(n.ERROR)}},r.prototype._onLoadedData=function(e){this._isLoading=!1,LOG.debug(this.containerId,"onLoadedData"),this._dispatchEvent(n.Media.Event.LOADED)},r.prototype._onLoadStart=function(e){this.video&&(this._isLoading=!0,LOG.info(this.containerId,"onLoadStart",this.video.currentSrc,this.video.src),this._dispatchEvent(n.Media.Event.WAITING))},r.prototype._onAbort=function(e){LOG.info(this.containerId,"onAbort",this.videoId,this.video.src)},r.prototype._enableVideoListeners=function(){LOG.debug("enable video listeners",this.videoId),this.video.addEventListener("loadstart",this._onLoadStart),this.video.addEventListener("loadedmetadata",this._onLoadedMetadata),this.video.addEventListener("loadeddata",this._onLoadedData),this.video.addEventListener("durationchange",this._onDurationChanged),this.video.addEventListener("play",this._onPlay),this.video.addEventListener("pause",this._onPause),this.video.addEventListener("seeked",this._onSeeked),this.video.addEventListener("timeupdate",this._onTimeUpdate),this.video.addEventListener("waiting",this._onWaiting),this.video.addEventListener("playing",this._onPlaying),this.video.addEventListener("progress",this._onProgress),this.video.addEventListener("canplay",this._onCanPlay),this.video.addEventListener("canplaythrough",this._onCanPlayThrough),this.video.addEventListener("volumechange",this._onVolumeChange),this.video.addEventListener("ended",this._onEnded),this.video.addEventListener("emptied",this._onEmptied),this.video.addEventListener("stalled",this._onStalled),this.video.addEventListener("error",this._onError),this.video.addEventListener("abort",this._onAbort)},r.prototype._disableVideoListeners=function(){LOG.debug(this.containerId,"disable video listeners"),this.video.removeEventListener("loadstart",this._onLoadStart),this.video.removeEventListener("loadedmetadata",this._onLoadedMetadata),this.video.removeEventListener("loadeddata",this._onLoadedData),this.video.removeEventListener("durationchange",this._onDurationChanged),this.video.removeEventListener("play",this._onPlay),this.video.removeEventListener("pause",this._onPause),this.video.removeEventListener("seeked",this._onSeeked),this.video.removeEventListener("timeupdate",this._onTimeUpdate),this.video.removeEventListener("waiting",this._onWaiting),this.video.removeEventListener("playing",this._onPlaying),this.video.removeEventListener("progress",this._onProgress),this.video.removeEventListener("canplay",this._onCanPlay),this.video.removeEventListener("canplaythrough",this._onCanPlayThrough),this.video.removeEventListener("volumechange",this._onVolumeChange),this.video.removeEventListener("ended",this._onEnded),this.video.removeEventListener("emptied",this._onEmptied),this.video.removeEventListener("stalled",this._onStalled),this.video.removeEventListener("error",this._onError),this.video.removeEventListener("abort",this._onAbort),this.video.removeEventListener("ended",this._onEnded)},r.prototype.onVideoConfigChanged=function(){(this.playing||this.paused)&&this.enable(!1);var e=window.CurrentVideoConfig;this._poster=e.content.poster,"undefined"==typeof this.loop&&"undefined"==typeof window.Playlist&&(this.loop=e?e.settings.loop:this.loop),this.adsCuepoints="undefined"!=typeof e.advertising.cuepoints?e.advertising.cuepoints.concat():[],this._dispatchEvent(n.Player.Event.CONFIG_CHANGED)},r.prototype.resetQuartiles=function(){this._pastFirstQuartile=!1,this._pastMidpoint=!1,this._pastThirdQuartile=!1},r.prototype._checkQuartiles=function(){if(this.currentTime&&this.duration){var e=this.currentTime/this.duration*100;!this._pastFirstQuartile&&e>=25?(this._pastFirstQuartile=!0,this._dispatchEvent(n.Media.Event.FIRSTQUARTILE,null)):!this._pastMidpoint&&e>=50?(this._pastMidpoint=!0,this._dispatchEvent(n.Media.Event.MIDPOINT,null)):!this._pastThirdQuartile&&e>=75&&(this._pastThirdQuartile=!0,this._dispatchEvent(n.Media.Event.THIRDQUARTILE,null))}},r}),define("zeus_video",["zeus_video_base"],function(e){var t=window.client,i=window.ZeusConstants,n=e.subclass({constructor:function(t,i,n,a){e.prototype.constructor.call(this),this._init(t,i,n,a)}});return n.prototype._init=function(t,i,n){e.prototype._init.call(this,t,i,n),this.video.oncontextmenu=function(){return!1},this._source&&(this.setSource(this._source),LOG.debug("PSEUDO STREAMING ENABLED",this.fastSeekEnabled)),this._enableVideoListeners()},n.prototype.isAd=function(e){return"undefined"==typeof e?this._isAd:void(this._isAd=e)},n.prototype.mute=function(e){LOG.info("mute",e),this.muted=this.video.muted=e,this.muted?this._dispatchEvent(i.Media.Event.MUTED):this._dispatchEvent(i.Media.Event.UNMUTED)},n.prototype.setVolume=function(e){var t="undefined"==typeof e?1:parseFloat(e);LOG.info("set volume",t),this.volume=this.video.volume=t},n.prototype._updateVideoSource=function(e){if(LOG.debug(this.containerId,"VIDEO::updateSource",e,"autoplay",this.autoplay,"currentTime",this.currentTime),this._source=e,this.qualityChanged){if(this.fastSeekEnabled&&this.currentTime>0){var t=-1===e.indexOf("?")?"?":"&";this._source=e+t+"ec_seek="+this.currentTime+"&start="+this.currentTime}this.hasStarted&&this.preload()}},n.prototype._onDurationChanged=function(e){var t=this;t.sourceChanged?(t.duration=t.video.duration,t._dispatchEvent(i.Media.Event.DURATION_CHANGE,t.duration),LOG.debug(t.containerId,"duration changed sourcechanged"),t.sourceChanged=!1,t.autoplay&&t.play()):t.qualityChanged?(LOG.debug(t.containerId,"duration changed, quality changed"),t.fastSeekEnabled?(t.startTime=t.currentTime,t._dispatchEvent(i.Media.Event.START_TIME_CHANGED,t.currentTime),t.play()):t.seek(t.currentTime),t.qualityChanged=!1):t.seekTime?(LOG.debug(t.containerId,"duration changed, seektime",t.seekTime),t.fastSeekEnabled&&(t.seekTime=null,t.play())):(LOG.debug(t.containerId,"duration changed, seek time",t.seekTime,"current source",t.video.currentSrc,"autoplay",t.autoplay),t.autoplay&&t.play())},n.prototype.seek=function(e){function n(){a.startTime=e,a._dispatchEvent(i.Media.Event.START_TIME_CHANGED,e);var n=-1===a._originalSource.indexOf("?")?"?":"&";if(t.browser.firefox>0){a._disableVideoListeners();var r=function(){LOG.info("FF video reset"),a.video.removeEventListener("emptied",r),a.video.src=e>0?a._originalSource+n+"ec_seek="+e+"&start="+e:a._source,a._enableVideoListeners(),a.video.load()};a.video.addEventListener("emptied",r),a.video.src=""}else a.video.src=e>0?a._originalSource+n+"ec_seek="+e+"&start="+e:a._source,a.video.load()}LOG.debug("seek",e);var a=this;a.seekTime=e,a.fastSeekEnabled?a.startTime>0?n():e<=a._bufferedTime?(LOG.info("Seeking pseudo-streamed video within the buffer",e,"of",a._bufferedTime),a.video.currentTime=e,a.seekTime=null):n():(a.video.currentTime=e,a.seekTime=null,a.playing||a.play())},n}),define("zeus_mobile_video",["zeus_video_base"],function(e){var t=window.ZeusConstants,i=window.client,n=e.subclass({constructor:function(t,n,a){e.prototype.constructor.call(this);var r=this;r._init(t,n,a),r.hasBeenTouched=!1,r._isEnabled=!1,i.system.iphone&&r.video.addEventListener("webkitendfullscreen",function(e){LOG.info("IOS",e.type),r._dispatchEvent(e.type)})}});return n.prototype._init=function(t,i,n){e.prototype._init.call(this,t,i,n),LOG.debug(this.containerId,"init",this.video)},n.prototype._updateVideoSource=function(e){LOG.debug(this.containerId,"updateSource",e,this.video.src,"autoplay",this.autoplay);var t=-1===e.indexOf("?")?"?":"&";this.qualityChanged&&this.fastSeekEnabled&&this.currentTime>0&&(t=-1===e.indexOf("?")?"?":"&",e=e+t+"ec_seek="+this.currentTime+"&start="+this.currentTime),e===this.video.src&&(t=-1===e.indexOf("?")?"?":"&",e=this._source+t+Date.now()),this._source=e,this.qualityChanged&&this.hasStarted&&this.preload()},n.prototype.isAd=function(e){return"undefined"==typeof e?this._isAd:void(this._isAd=e)},n.prototype.seek=function(e){function i(){n.startTime=e,n._dispatchEvent(t.Media.Event.START_TIME_CHANGED,e),n.video.src=e>0?n._source+"&ec_seek="+e+"&start="+e:n._source,n.video.load()}LOG.debug("seek",e);var n=this;n.seekTime=e,n.fastSeekEnabled?n.startTime>0?i():e<=n._bufferedTime?n.video.currentTime=e:i():(n.video.currentTime=e,n.playing||n.hasBeenTouched&&n.play())},n.prototype._onDurationChanged=function(e){LOG.debug(this.containerId,this.video,"durationchanged",this.video.duration,this.duration),this.sourceChanged?(this.duration=this.video.duration,this._dispatchEvent(t.Media.Event.DURATION_CHANGE,this.duration),LOG.debug(this.containerId,"duration changed sourcechanged"),this.sourceChanged=!1,this.hasBeenTouched&&this.autoplay&&this.play()):this.qualityChanged?(LOG.debug(this.containerId,"duration changed, quality changed"),this.fastSeekEnabled?(this.startTime=this.currentTime,this._dispatchEvent(t.Media.Event.START_TIME_CHANGED,this.currentTime),this.hasBeenTouched&&this.play()):this.seek(this.currentTime),this.qualityChanged=!1):this.seekTime?(LOG.debug(this.containerId,"duration changed, seektime",this.seekTime),this.fastSeekEnabled&&(this.seekTime=null,this.hasBeenTouched&&this.play())):this.autoplay&&this.hasBeenTouched&&(LOG.debug("duration changed & play"),this.play())},n.prototype.touch=function(){LOG.debug(this.videoId,"touch",this.video),this.enable(!1),this.hasBeenTouched=!0},n}),define("zeus_android_webkit_video",["zeus_video_base"],function(e){var t=window.ZeusConstants,i=e.subclass({constructor:function(t,i,n){e.prototype.constructor.call(this);var a=this;a._init(t,i,n),a.hasBeenTouched=!1,a._isEnabled=!1,a.video.style.visibility="hidden"}});return i.prototype._init=function(t,i,n){e.prototype._init.call(this,t,i,n),LOG.debug(this.containerId,"init",this.video)},i.prototype._updateVideoSource=function(e){LOG.debug(this.containerId,"updateSource",e,this.video.src,"autoplay",this.autoplay);var t=-1===e.indexOf("?")?"?":"&";this.qualityChanged&&this.fastSeekEnabled&&this.currentTime>0&&(t=-1===e.indexOf("?")?"?":"&",e=e+t+"ec_seek="+this.currentTime+"&start="+this.currentTime),e===this.video.src&&(t=-1===e.indexOf("?")?"?":"&",e=this._source+t+Date.now()),this._source=e,this.qualityChanged&&this.hasStarted&&this.preload()},i.prototype.isAd=function(e){return"undefined"==typeof e?this._isAd:void(this._isAd=e)},i.prototype.preload=function(){var e=document.getElementById(this.containerId).getAttribute("data-default-src");this._isAd||null!==this._source&&""!==this._source||this.setSource(e),this._isEnabled||this.enable(!0),this.video.src=this._source,this.video.load(),LOG.debug(this.containerId,"preload source = ",this.video.currentSrc)},i.prototype.seek=function(e){function i(){n.startTime=e,n._dispatchEvent(t.Media.Event.START_TIME_CHANGED,e),n.video.src=e>0?n._source+"&ec_seek="+e+"&start="+e:n._source,n.video.load()}LOG.debug("seek",e);var n=this;n.seekTime=e,n.fastSeekEnabled?n.startTime>0?i():e<=n._bufferedTime?n.video.currentTime=e:i():(n.video.currentTime=e,n.playing||n.hasBeenTouched&&n.play())},i.prototype._onDurationChanged=function(e){this.video.duration<5||(LOG.debug(this.containerId,this.video.currentSrc,"durationchanged",this.video.duration,this.duration),this.sourceChanged?(this.duration=this.video.duration,this._dispatchEvent(t.Media.Event.DURATION_CHANGE,this.duration),LOG.debug(this.containerId,"duration changed sourcechanged"),this.sourceChanged=!1,this.hasBeenTouched&&this.autoplay&&this.play()):this.qualityChanged?(LOG.debug(this.containerId,"duration changed, quality changed"),this.fastSeekEnabled?(this.startTime=this.currentTime,this._dispatchEvent(t.Media.Event.START_TIME_CHANGED,this.currentTime),this.hasBeenTouched&&this.play()):this.seek(this.currentTime),this.qualityChanged=!1):this.seekTime?(LOG.debug(this.containerId,"duration changed, seektime",this.seekTime),this.fastSeekEnabled&&(this.seekTime=null,this.hasBeenTouched&&this.play())):this.autoplay&&this.hasBeenTouched&&(LOG.debug("duration changed & play"),this.play()))},i.prototype._onLoadedMetadata=function(e){LOG.debug(this.containerId,"video metadata",this.metadata,this.video.currentSrc),this.metadata||(this.metadata={duration:this.video.duration,videoWidth:this.video.videoWidth,videoHeight:this.video.videoHeight},this._dispatchEvent(t.Media.Event.METADATA,this.metadata))},i.prototype._onLoadedData=function(e){this._isLoading=!1,LOG.debug(this.containerId,"onLoadedData",this.video.currentSrc),this._dispatchEvent(t.Media.Event.LOADED)},i.prototype._onLoadStart=function(e){this.video&&(this._isLoading=!0,LOG.info(this.containerId,"onLoadStart",this.video.currentSrc,this.video.src),this._dispatchEvent(t.Media.Event.WAITING));
},i.prototype._onCanPlay=function(e){return LOG.debug(this.containerId,"onCanPlay",this.video.currentSrc,this.video.duration),this.video.duration<5?(this._isAd||this.video.pause(),void this.video.play()):(this.waiting=!1,this.canplay=!0,this._dispatchEvent(t.Player.Event.CANPLAY),void(this._stalled&&(LOG.debug(this.containerId,"onCanPlay after stalled"),this._stalled=!1,this.video.play())))},i.prototype._onCanPlayThrough=function(e){LOG.debug(this.containerId,"canplaythrough",this.video.currentSrc,this.video.duration),this.canplaythrough=!0,this._dispatchEvent(t.Player.Event.CANPLAYTHROUGH)},i.prototype.touch=function(){LOG.debug(this.videoId,"touch",this.video),this.enable(!1),this.hasBeenTouched=!0},i.prototype.play=function(){this.video.style.visibility="visible",this.show(!0),this.ended?this.replay():(this._isEnabled||this.enable(!0),this.video.play())},i.prototype.remove=function(t){t&&(this.video.style.visibility="hidden"),e.prototype.remove.call(this,t)},i}),define("ios_video",["zeus_video_base"],function(e){var t=window.ZeusConstants,i=window.client,n=e.subclass({constructor:function(t,n,a){e.prototype.constructor.call(this);var r=this;r._init(t,n,a),r.hasBeenTouched=!1,r._isEnabled=!1,i.system.iphone&&r.video.addEventListener("webkitendfullscreen",function(e){LOG.info("IOS",e.type),r._dispatchEvent(e.type)})}});return n.prototype._init=function(t,i,n){e.prototype._init.call(this,t,i,n),LOG.debug(this.containerId,"init",this.video)},n.prototype._updateVideoSource=function(e){LOG.debug(this.containerId,"updateSource",e,this.video.src,"autoplay",this.autoplay);var t=-1===e.indexOf("?")?"?":"&";this.qualityChanged&&this.fastSeekEnabled&&this.currentTime>0&&(t=-1===e.indexOf("?")?"?":"&",e=e+t+"ec_seek="+this.currentTime+"&start="+this.currentTime),e===this.video.src&&(t=-1===e.indexOf("?")?"?":"&",e=this._source+t+Date.now()),this._source=e,this.qualityChanged&&this.hasStarted&&this.preload()},n.prototype.isAd=function(e){return"undefined"==typeof e?this._isAd:void(this._isAd=e)},n.prototype.seek=function(e){function i(){n.startTime=e,n._dispatchEvent(t.Media.Event.START_TIME_CHANGED,e),n.video.src=e>0?n._source+"&ec_seek="+e+"&start="+e:n._source,n.video.load()}LOG.debug("seek",e);var n=this;n.seekTime=e,n.fastSeekEnabled?n.startTime>0?i():e<=n._bufferedTime?n.video.currentTime=e:i():(n.video.currentTime=e,n.playing||n.hasBeenTouched&&n.play())},n.prototype._onDurationChanged=function(e){LOG.debug(this.containerId,this.video,"durationchanged",this.video.duration,this.duration),this.sourceChanged?(this.duration=this.video.duration,this._dispatchEvent(t.Media.Event.DURATION_CHANGE,this.duration),LOG.debug(this.containerId,"duration changed sourcechanged"),this.sourceChanged=!1,this.hasBeenTouched&&this.autoplay&&this.play()):this.qualityChanged?LOG.debug(this.containerId,"duration changed, quality changed"):this.seekTime?(LOG.debug(this.containerId,"duration changed, seektime",this.seekTime),this.fastSeekEnabled&&(this.seekTime=null,this.hasBeenTouched&&this.play())):this.autoplay&&this.hasBeenTouched&&(LOG.debug("duration changed & play"),this.play())},n.prototype._onLoadedData=function(){this.qualityChanged?(LOG.info("on loaded data:: new quality"),this.qualityChanged=!1,this.fastSeekEnabled?(this.startTime=this.currentTime,this._dispatchEvent(t.Media.Event.START_TIME_CHANGED,this.currentTime),this.hasBeenTouched&&this.play()):this.seek(this.currentTime)):(LOG.info("on loaded data"),e.prototype._onLoadedData.call(this))},n.prototype.touch=function(){LOG.debug(this.videoId,"touch",this.video),this.enable(!1),this.hasBeenTouched=!0},n}),define("zeus_ima_shim",["zeus_eventdispatcher","swfobject","zeus_utils"],function(e){function t(t,n){e.mixin(this);var a=Date.now(),r=i.Ad.IMA_SHIM,o=this;o._isAd=!0,o.contentPlayheadTime=0,o.duration=0,o.currentTime=0,o.volume=1,o.paused=!1,o.muted=!1,o.isAd=function(){return o._isAd},o.setVolume=function(e){o.volume=e,e>0?o.unmuteVolume=e:o.unmuteVolume=1,l&&l.setVolume(e)},o.mute=function(e){o.muted=!!e,LOG.info("Google Flash muted",o.muted),e?(o.unmuteVolume=o.volume>0?o.volume:1,l&&l.setVolume(0)):l&&l.setVolume(o.unmuteVolume)},o.pause=function(){o.paused=!0,l&&l.pause()},o.resume=function(){o.paused=!1,l&&l.resume()},o.play=function(){o.paused=!1,l&&l.play()},o.setFullscreen=function(e){},o.resize=function(e,t){p&&(p.style.width=e,p.style.height=t)},o.getWidth=function(){return u?"text"===u.title?u.width+20:u.width:0},o.getHeight=function(){return u?u.height:0};var s,d,l,u,c=document.getElementById(t),h="ima_"+a,p=document.createElement("div");p.style.position="absolute",p.style.top=0,p.style.left=0,p.style.right=0,p.style.bottom=0,p.setAttribute("id",h);var f=document.createElement("div");f.setAttribute("id","dummy"),c.appendChild(p),p.appendChild(f);var v={shimInstance:n,contentPlayheadTime:o.contentPlayheadTime,swfLocation:r.substr(0,r.lastIndexOf("/")+1)},g={id:i.Ad.PLAYER_ID_PREFIX+h,name:i.Ad.PLAYER_ID_PREFIX+h,style:"height:1px"},m={allowscriptaccess:"always",wmode:"opaque",allowfullscreen:!0,quality:"high",bgcolor:"#000000"};return swfobject.embedSWF(r,"dummy","100%","100%","11",null,v,m,g,o.onSwfLoaded),o.onSwfLoaded=function(){l=swfobject.getObjectById(g.id),l.style.height="100%",l.registerAdListener("adsManagerLoaded","onAd"),l.registerAdListener("adBreakReady","onAd"),l.registerAdListener("adMetadata","onAd"),l.registerAdListener("contentPausedRequested","onAd"),l.registerAdListener("contentResumeRequested","onAd"),l.registerAdListener("impression","onAd"),l.registerAdListener("interaction","onAd"),l.registerAdListener("clicked","onAd"),l.registerAdListener("loaded","onAd"),l.registerAdListener("started","onAd"),l.registerAdListener("skipped","onAd"),l.registerAdListener("paused","onAd"),l.registerAdListener("resumed","onAd"),l.registerAdListener("stopped","onAd"),l.registerAdListener("allAdsCompleted","onAd"),l.registerAdListener("volumeChanged","onAd"),l.registerAdListener("volumeMuted","onAd"),l.registerAdListener("durationChanged","onAd"),l.registerAdListener("exitFullscreen","onAd"),l.registerAdListener("fullscreen","onAd"),l.registerAdListener("firstQuartile","onAd"),l.registerAdListener("midpoint","onAd"),l.registerAdListener("thirdQuartile","onAd"),l.registerAdListener("remainingTimeChanged","onAd"),l.registerAdListener("skippableStateChanged","onAd"),l.registerAdListener("linearChanged","onAd"),l.registerAdListener("sizeChanged","onAd"),l.registerAdListener("expandedChanged","onAd"),l.registerAdListener("userMinimized","onAd"),l.registerAdListener("userClosed","onAd"),l.registerAdListener("userAcceptedInvitation","onAd"),l.registerAdListener("adError","onAd"),LOG.debug("[bolt3] ima swf loaded",l),LOG.debug(s),null!=s&&o.setTag(s,d),l.setVolume(o.volume)},o.setTag=function(e,t){LOG.debug("[bolt3] IMASHIM setTag",e,"autoplay",t),s=e,d=t,null!=l?(LOG.debug("[bolt3] send tag to swf",e),l.setTag({tag:s,playerAutoplay:d})):LOG.debug("[bolt3] ima swf is not yet loaded")},o.getTag=function(){return s},o.getMetadata=function(){return u},o.onAd=function(e){var t=e.type,n=e.data,a=t;switch(e.type){case"adsManagerLoaded":LOG.info("[bolt3] google ads manager loaded"),a=i.Ad.Event.READY;break;case"adBreakReady":break;case"adError":LOG.debug("[bolt3] google flash ad event",e.type),a=i.ERROR;break;case"adMetadata":LOG.debug("[bolt3] google flash ad event",e.type),u||(u=n),o.duration=n.duration,a=i.Media.Event.METADATA;break;case"clicked":LOG.debug("[bolt3] google flash ad event",e.type),a=i.Ad.Event.CLICKED;break;case"loaded":LOG.debug("[bolt3] google flash ad event",e.type),u=n,a=i.Media.Event.LOADED;break;case"started":return LOG.debug("[bolt3] google flash ad event",e.type),l.style.visibility="visible",o._dispatchEvent(i.Media.Event.PLAY),o._dispatchEvent(i.Media.Event.DURATION_CHANGE),void o._dispatchEvent(i.Media.Event.PLAYING);case"skipped":LOG.debug("[bolt3] google flash ad event",e.type),a=i.Ad.Event.SKIPPED;break;case"paused":a=i.Media.Event.PAUSED;break;case"resumed":a=i.Media.Event.RESUME;break;case"stopped":a=i.Media.Event.STOPPED;break;case"allAdsCompleted":a=i.Ad.Event.COMPLETED;break;case"volumeChanged":return o.volume=l.getVolume(),LOG.debug("[bolt3] google flash ad event",e.type,"volume",o.volume),o.volume>0?(o.muted=!1,o._dispatchEvent(i.Media.Event.UNMUTED)):(o.muted=!0,o._dispatchEvent(i.Media.Event.MUTED)),void o._dispatchEvent(i.Media.Event.VOLUME_CHANGED);case"volumeMuted":a=i.Media.Event.MUTED;break;case"contentPausedRequested":a=i.Ad.Event.CONTENT_PAUSE_REQUESTED;break;case"contentResumeRequested":LOG.debug("[bolt3] google flash ad event",e.type),a=i.Ad.Event.COMPLETED;break;case"exitFullscreen":a=i.Player.Event.EXIT_FULLSCREEN;break;case"fullscreen":a=i.Player.Event.ENTER_FULLSCREEN;break;case"firstQuartile":LOG.debug("[bolt3] google flash ad event",e.type),a=i.Media.Event.FIRSTQUARTILE;break;case"midpoint":LOG.debug("[bolt3] google flash ad event",e.type),a=i.Media.Event.MIDPOINT;break;case"thirdQuartile":LOG.debug("[bolt3] google flash ad event",e.type),a=i.Media.Event.THIRDQUARTILE;break;case"remainingTimeChanged":o.currentTime=n.currentTime,o._dispatchEvent(i.Media.Event.TIME_UPDATE,o.currentTime),a=i.Ad.Event.REMAINING_TIME_CHANGED;break;case"skippableStateChanged":break;case"linearChanged":a=i.Ad.Event.LINEAR_CHANGED;break;case"sizeChanged":LOG.debug("[bolt3] ad size changed",e.data),a=i.Player.Event.SIZE_CHANGED;break;case"expandedChanged":a=i.Ad.Event.EXPANDED_CHANGED;break;case"userMinimized":break;case"userClosed":a=i.Ad.Event.CLOSED;break;case"userAcceptedInvitation":break;case"impression":LOG.info("[bolt3] ad impression");break;case"interaction":}o._dispatchEvent(a,n)},o.remove=function(){p&&p.parentNode&&(LOG.debug(this,"remove"),p.parentNode.removeChild(p))},o.isLinear=function(){return u?u.linear:!1},o}var i=window.ZeusConstants;return t}),define("base_ad_player",["zeus_eventdispatcher","zeus_constants","zeus_utils"],function(e,t,i){"use strict";var n,a=(i.dom,Stapes.subclass({constructor:function(){n=window.BoltAdManager,this.container=n.container,this.containerId=n.containerId,this.containerInitialStyles=this.container?getComputedStyle(this.container):null,this.type=null,this.fullscreen=!1,this._volume=0,this._duration=0,this._currentTime=0,this._isLinear=!0,e.mixin(this)},isAd:function(){return!0},isLinear:function(){return this._isLinear},playAd:function(){},resume:function(){},pause:function(){},getDuration:function(){return this._duration},getCurrentTime:function(){return this._currentTime},setVolume:function(e){},getVolume:function(){return this._volume},mute:function(e){},setFullscreen:function(e){},getSource:function(){return n.bestMedia},end:function(){n._dispatchEvent(t.Media.Event.ENDED)},remove:function(){},updateLayout:function(){}}));return a}),define("zeus_googleFlashPlayer",["zeus_constants","zeus_ima_shim","zeus_utils","base_ad_player"],function(e,t,i,n){var a=(window.client,n.subclass({constructor:function(){n.prototype.constructor.call(this),this.customTag=null,this.type="google",this.timing=BoltAdManager.timing,this._isAd=!0,this._isLinear=!0,this.volume=1,this.muted=!1,this.buffered=0,this.currentTime=0,this.startTime=0,this.duration=0,this.fullscreen=!1,this._checkControlbarHeightIntervalId=null,this._nonLinearPseudoDuration=15,this._nonLinearCountdown=null,this._nonLinearPseudoTime=0;var i=e.Ad.PLAYER_ID_PREFIX+this.containerId;window[i]=this.ad=new t(this.containerId,"window['"+i+"']"),this.playerId=i,this.onAdEvent=this.onAdEvent.bind(this),this.ad.addEventListener(e.Media.Event.LOADED,this.onAdEvent),this.ad.addEventListener(e.ERROR,this.onAdEvent),this.ad.addEventListener(e.Ad.Event.COMPLETED,this.onAdEvent),this.ad.addEventListener(e.Ad.Event.SKIPPED,this.onAdEvent),this.ad.addEventListener(e.Ad.Event.READY,this.onAdEvent),this.ad.addEventListener(e.Ad.Event.CLICKED,this.onAdEvent),this.onMediaEvents=this.onMediaEvents.bind(this),this.ad.addEventListener(e.Media.Event.TIME_UPDATE,this.onMediaEvents),this.ad.addEventListener(e.Media.Event.PLAY,this.onMediaEvents),this.ad.addEventListener(e.Media.Event.DURATION_CHANGE,this.onMediaEvents),this.ad.addEventListener(e.Media.Event.PLAYING,this.onMediaEvents),this.ad.addEventListener(e.Media.Event.MUTED,this.onMediaEvents),this.ad.addEventListener(e.Media.Event.UNMUTED,this.onMediaEvents),this.ad.addEventListener(e.Media.Event.VOLUME_CHANGED,this.onMediaEvents),this.ad.addEventListener(e.Media.Event.METADATA,this.onMediaEvents),this.ad.addEventListener(e.Media.Event.FIRSTQUARTILE,this.onMediaEvents),this.ad.addEventListener(e.Media.Event.MIDPOINT,this.onMediaEvents),this.ad.addEventListener(e.Media.Event.THIRDQUARTILE,this.onMediaEvents)}}));return a.prototype.isAd=function(){return this._isAd},a.prototype.onAdEvent=function(t){LOG.debug(this,t.type);var n=t.type,a=this;switch(t.type){case e.Media.Event.LOADED:a.container.style.width="100%",a.container.style.height="100%",a.container.style.bottom=0,a.container.style.top=0,a._isLinear=a.ad.isLinear(),LOG.info("[bolt3] IMA LOADED",a.ad.getMetadata());var r=a.ad.getMetadata();if(r.skippable&&window.GoogleTrueViewPlayCount++,LOG.info("[bolt3] trueview playcount",window.GoogleTrueViewPlayCount),window.postLogMessage("trueview ad has been played "+window.GoogleTrueViewPlayCount+" times"),a.duration=a.getDuration(),a.currentTime=0,a.startTime=0,BoltAdManager.adtechGoogleAdCount){var o=BoltAdManager.adtechGoogleAdCount;i.xhr(o,"get",null,function(){LOG.info("ADTECH adcount for Google Ad has been fired",o),window.postLogMessage("ADTECH adcount for Google has been fired "+o,"success")},function(){LOG.error("[bolt3] Failed to fire ADTECH adcount for Google Ad ",o),window.postLogMessage("Failed to fire ADTECH adcount for Google Ad "+o,"error")})}BoltAdManager._dispatchEvent(n),a._isLinear||(a._dispatchEvent(e.Media.Event.PLAY),a._dispatchEvent(e.Media.Event.DURATION_CHANGE),a._dispatchEvent(e.Media.Event.START_TIME_CHANGED),a._resetNonLinearCountdown(),a._dispatchEvent(e.Media.Event.PLAYING),a._nonLinearCountdown=setInterval(function(){a._nonLinearPseudoTime+=1,a.currentTime=a._nonLinearPseudoTime,a._dispatchEvent(e.Media.Event.TIME_UPDATE,a.currentTime),a._nonLinearPseudoTime>a._nonLinearPseudoDuration&&(BoltAdManager._dispatchEvent("completed"),BoltAdManager._dispatchEvent(e.Media.Event.ENDED),clearInterval(a._nonLinearCountdown))},1e3)),a.ad.removeEventListener(t.type);break;case e.ERROR:try{window.postLogMessage("Ad Error. Google says: "+t.data.errorMessage,"error")}catch(s){}a.ad.removeAllListeners(),setTimeout(function(){a._dispatchEvent(e.ERROR)},500);break;case e.Ad.Event.SKIPPED:window.postLogMessage("Google Flash Ad skipped"),a.ad.removeEventListener(t.type);break;case e.Ad.Event.COMPLETED:window.postLogMessage("Google Flash Ad completed"),n=e.Media.Event.ENDED,BoltAdManager._dispatchEvent(n),a.ad.removeEventListener(t.type);break;case e.Ad.Event.READY:window.postLogMessage("Google Flash Ad Ready"),BoltAdManager._dispatchEvent(n),a.ad.removeEventListener(t.type);break;case e.Ad.Event.CLICKED:BoltAdManager._dispatchEvent(t.type)}},a.prototype.onMediaEvents=function(t){var i=this;switch(t.type){case e.Media.Event.VOLUME_CHANGED:i.muted||(i.volume=i.ad.volume,i._dispatchEvent(t.type));break;case e.Media.Event.MUTED:i.muted=!0,i._dispatchEvent(t.type);break;case e.Media.Event.UNMUTED:i.muted=!1,i._dispatchEvent(t.type);break;case e.Media.Event.TIME_UPDATE:i.currentTime=i.ad.currentTime,i._dispatchEvent(t.type,i.currentTime);break;case e.Media.Event.METADATA:LOG.info("[bolt3] AD METADATA",i.ad.getMetadata()),i._dispatchEvent(t.type);break;case e.Media.Event.DURATION_CHANGE:i.duration=i.ad.duration,i._dispatchEvent(t.type);break;case e.Media.Event.PLAY:case e.Media.Event.PLAYING:case e.Media.Event.FIRSTQUARTILE:case e.Media.Event.MIDPOINT:case e.Media.Event.THIRDQUARTILE:i._dispatchEvent(t.type)}},a.prototype.playAd=function(){window.postLogMessage("Loading Google Flash ad"),this.requestAd()},a.prototype.getDuration=function(){return this._isLinear?this.ad.duration:this._nonLinearPseudoDuration},a.prototype.getCurrentTime=function(){return this.currentTime},a.prototype.getVolume=function(){return this.ad.volume},a.prototype.setVolume=function(e){LOG.info("google flash set volume",e),this.ad.setVolume(e)},a.prototype.mute=function(e){LOG.info("google flash mute",e),this.ad.mute(e)},a.prototype.pause=function(){this.ad.pause()},a.prototype.resume=function(){this.ad.resume()},a.prototype.resize=function(e,t){this.ad.resize(e,t)},a.prototype.isLinear=function(){return!0},a.prototype._resetNonLinearCountdown=function(){this._nonLinearCountdown&&(clearInterval(this._nonLinearCountdown),this._nonLinearCountdown=null,this._nonLinearPseudoTime=0)},a.prototype.remove=function(){LOG.debug(this,"remove"),this.ad&&(this.ad.removeAllListeners(),this.ad.remove(),this.ad=null),BoltAdManager._dispatchEvent(e.Player.Event.REMOVED),this._isLinear||BoltAdManager._dispatchEvent(e.Player.Event.ENDED);try{delete window[this.playerId]}catch(t){}},a.prototype.requestAd=function(){var e=this,t={maxAdDuration:3e4,viewMode:"FULLSCREEN",overlay:0},i=[],n=BoltAdManager.selectedSiteTags.standard;n&&"undefined"!=typeof n.adTypes&&(("undefined"==typeof n.adTypes.linear||n.adTypes.linear)&&(0!=BoltAdManager.selectedSiteTags.trueView&&"preroll"===e.timing?0===window.GoogleTrueViewPlayCount&&1===window.ContentPlayer.videoPlayCount?i.push("skippablevideo"):(LOG.info("[bolt3] Skippable ad has been played once, requesting standardvideo"),window.postLogMessage("Trueview has ben played once. Requesting standard video ad"),i.push("standardvideo")):i.push("standardvideo")),("undefined"==typeof n.adTypes.nonlinear||n.adTypes.nonlinear)&&i.push("image","flash")),0===i.length&&(i=0!=BoltAdManager.selectedSiteTags.trueView&&"preroll"===e.timing&&1===window.ContentPlayer.videoPlayCount&&0===window.GoogleTrueViewPlayCount?["skippablevideo","flash","image"]:["standardvideo","flash","image"]),i.indexOf("skippablevideo")>-1?LOG.info("Trueview requested"):LOG.info("Trueview not requested"),t.viewMode="FULLSCREEN",t.adType=i.join("_");var a=encodeURIComponent(window.site.href),r=BoltAdManager.selectedSiteTags.coppa===!0;r&&LOG.info("COPPA compliance required"),this.ad.contentPlayheadTime=window.ContentPlayer.currentTime||0;var o="preroll"===this.timing?window.CurrentVideoConfig.settings.autoplay:!0;if(e.customTag){var s=e.customTag.concat();s=s.replace("[referrer_url]",a),s=s.replace("[description_url]",a),s=s.replace("[ad_type]",t.adType),s=s.replace("[timestamp]",Math.round(Date.now()/1e3).toString()),r&&(/&tfcd=1/i.test(s)||(s+="&tfcd=1")),s=this.appendMPTMPV(s),LOG.debug("[bolt3] Google Tag",s),window.postLogMessage("Requesting ad from Google "+s),this.ad.setTag(s,o)}else{var d="http://googleads.g.doubleclick.net/pagead/ads?max_ad_duration="+t.maxAdDuration+"&ad_type="+t.adType+"&description_url="+a+"&overlay="+t.overlay+"&client="+BoltAdManager.googlePublisherId+"&videoad_start_delay=0";r&&(d+="&tfcd=1"),d=this.appendMPTMPV(d),LOG.debug("[bolt3] Google Tag",d),window.postLogMessage("Requesting ad from Google "+d),this.ad.setTag(d,o)}},a.prototype.appendMPTMPV=function(e){return/mpt=playwire/.test(e)||(e+="&mpt=playwire"),/mpv=3\.2/.test(e)||(e+="&mpv=3.2"),e},a.prototype.setFullscreen=function(e){e!==this.fullscreen&&(this.fullscreen=e,this.ad.setFullscreen(e))},a.prototype.getSource=function(){return this.ad.getTag()},a}),define("googleAdsPlayer",["zeus_utils","zeus_constants","base_ad_player"],function(e,t,i){var n=window.site.protocol+"//s0.2mdn.net/instream/html5/ima3.js",a=window.client,r=i.subclass({constructor:function(){i.prototype.constructor.call(this),this.customTag=null,this.type="google",this.timing=BoltAdManager.timing,this._isAd=!0,this._isLinear=!1,this.fullscreen=!1,this.volume=1,this.muted=!1,this.buffered=0,this.currentTime=0,this.duration=0,this._intervalId=null,this.startTime=0,this._checkControlbarHeightIntervalId=null,this._sizeTrackerInterval=null,this._nonLinearPseudoDuration=15,this._nonLinearCountdown=null,this._nonLinearPseudoTime=0,this.sdkAdsManager=null,this.onAdsManagerLoaded=this.onAdsManagerLoaded.bind(this),this.onAdError=this.onAdError.bind(this),this.onContentPauseRequested=this.onContentPauseRequested.bind(this),this.onContentPauseRequested=this.onContentPauseRequested.bind(this),this.onAdEvent=this.onAdEvent.bind(this)}});return r.prototype.playAd=function(){function e(e,t){if(e&&"string"==typeof e){var i=document.createElement("script");i.onload=function(){t&&t()},i.src=e,LOG.debug(i),document.getElementsByTagName("head")[0].appendChild(i)}}function i(){LOG.debug("[bolt3] create ima"),r.setUpIMAContainer(),r.createAdsLoader(),r.resize("100%","100%")}window.postLogMessage("Loading Google HTML5 ad");var r=this;a.isMobile?(r.container.style.display="block",r.container.style.visibility="hidden",r.requestAd()):"undefined"==typeof google||"undefined"==typeof google.ima?e(n,function(){LOG.debug("[bolt3] loaded google for first time!"),t.Ad.IMA_ENABLED=!0,i(),r.requestAd()}):(LOG.debug("[bolt3] google already loaded!"),i(),r.requestAd())},r.prototype.setUpIMAContainer=function(){LOG.debug("[bolt3] setupIMAContainer");var e=this;e.container.style.display="block",e.container.style.visibility="hidden",e.adDisplayContainer=new google.ima.AdDisplayContainer(e.container,BoltAdManager.videoElement),e.adDisplayContainer.initialize(),a.isMobile&&e.createAdsLoader()},r.prototype.createAdsLoader=function(){var e=this;if(e.adDisplayContainer)LOG.debug("[bolt3] create ads loader"),e.adsLoader=new google.ima.AdsLoader(e.adDisplayContainer),e.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,e.onAdsManagerLoaded,!1),e.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,e.onAdError,!1);else var t=setInterval(function(){e.adDisplayContainer&&(clearInterval(t),e.createAdsLoader())},100)},r.prototype.requestAd=function(){var e=this;if(e.adsLoader){var t={maxAdDuration:3e4,viewMode:"FULLSCREEN",overlay:0},i=[],n=a.isMobile?BoltAdManager.selectedSiteTags.html5.mobile:BoltAdManager.selectedSiteTags.html5.desktop;LOG.info("[bolt3] google tags",n),n&&"undefined"!=typeof n.adTypes&&(("undefined"==typeof n.adTypes.linear||n.adTypes.linear)&&(0!=BoltAdManager.selectedSiteTags.trueView&&"preroll"===e.timing?0===window.GoogleTrueViewPlayCount&&1===window.ContentPlayer.videoPlayCount?i.push("skippablevideo"):(LOG.info("[bolt3] Skippable ad has been played once, requesting standardvideo"),window.postLogMessage("Trueview ad has been played once. Requesting standard video."),i.push("standardvideo")):i.push("standardvideo")),("undefined"==typeof n.adTypes.nonlinear||n.adTypes.nonlinear)&&i.push("image")),0===i.length&&(i=0!=BoltAdManager.selectedSiteTags.trueView&&"preroll"===e.timing&&1===window.ContentPlayer.videoPlayCount&&0===window.GoogleTrueViewPlayCount?["skippablevideo","image"]:["standardvideo","image"]),a.isMobile&&a.system.iphone&&(i=["standardvideo"]),i.indexOf("skippablevideo")>-1?LOG.info("Trueview requested"):LOG.info("Trueview not requested"),t.adType=i.join("_"),e.adsRequest=new google.ima.AdsRequest;var r=encodeURIComponent(window.site.href),o=BoltAdManager.selectedSiteTags.coppa===!0;if(o&&LOG.info("COPPA compliance required"),e.customTag){var s=e.customTag.concat();s=s.replace("[referrer_url]",r),s=s.replace("[description_url]",r),s=s.replace("[ad_type]",t.adType),s=s.replace("[timestamp]",Math.round(Date.now()/1e3).toString()),o&&(/&tfcd=1/i.test(s)||(s+="&tfcd=1")),LOG.info("Google Tag "+s),e.adsRequest.adTagUrl=s}else{var d="http://googleads.g.doubleclick.net/pagead/ads?&max_ad_duration="+t.maxAdDuration+"&ad_type="+t.adType+"&description_url="+r+"&overlay="+t.overlay+"&client="+BoltAdManager.googlePublisherId+"&videoad_start_delay=0";o&&(d+="&tfcd=1"),LOG.info("Google Tag "+d),e.adsRequest.adTagUrl=d}/mpt=playwire/.test(e.adsRequest.adTagUrl)||(e.adsRequest.adTagUrl+="&mpt=playwire"),/mpv=3\.2/.test(e.adsRequest.adTagUrl)||(e.adsRequest.adTagUrl+="&mpv=3.2"),window.postLogMessage("Requesting Ad from google "+e.adsRequest.adTagUrl),e.adsRequest.linearAdSlotWidth=e.container.clientWidth,e.adsRequest.linearAdSlotHeight=e.container.clientHeight,e.adsRequest.nonLinearAdSlotWidth=e.container.clientWidth,e.adsRequest.nonLinearAdSlotHeight=e.container.clientHeight;try{e.adsLoader.requestAds(e.adsRequest)}catch(l){e.onAdError()}}else var u=setInterval(function(){e.adsLoader&&(clearInterval(u),e.requestAd())},100)},r.prototype.onAdsManagerLoaded=function(e){LOG.debug("[bolt3] onAdsManagerLoaded");var i=this,n=new google.ima.AdsRenderingSettings;n.loadVideoTimeout=3e4,n.autoAlign=!1,n.useStyledNonLinearAds=!1,n.restoreCustomPlaybackStateOnAdBreakComplete=!0,a.isMobile?i.sdkAdsManager=e.getAdsManager(BoltAdManager.videoElement,n):i.sdkAdsManager=e.getAdsManager(i.container,n),i.sdkAdsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,i.onAdError),i.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,i.onContentPauseRequested),i.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,i.onContentResumeRequested),i.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,i.onAdEvent),i.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.LOADED,i.onAdEvent),i.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.STARTED,i.onAdEvent),i.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,i.onAdEvent),i.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.FIRST_QUARTILE,i.onAdEvent),i.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.MIDPOINT,i.onAdEvent),i.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.THIRD_QUARTILE,i.onAdEvent),i.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.CLICK,i.onAdEvent),i.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.PAUSED,i.onAdEvent),i.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,i.onAdEvent),i.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.USER_CLOSE,i.onAdEvent),i.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,i.onAdEvent);try{var r=i.container.clientWidth,o=i.container.clientHeight;LOG.debug("[bolt3] init ads manager size",r,o),i.sdkAdsManager.init(r,o,google.ima.ViewMode.FULLSCREEN),i.sdkAdsManager.start(),LOG.debug("[bolt3] Starting google ads manager"),BoltAdManager._dispatchEvent(t.Ad.Event.READY),i._sizeTrackerInterval=setInterval(function(){i.resize()},100)}catch(s){LOG.debug("[bolt3] Google ads manager did not start"),window.postLogMessage("Google ads manager did not start","error"),i.onAdError()}},r.prototype.setFullscreen=function(e){e!==this.fullscreen&&(this.fullscreen=e)},r.prototype.getDuration=function(){return this._isLinear?this.ad.getDuration():this._nonLinearPseudoDuration},r.prototype.getCurrentTime=function(){var e=this;return"undefined"!=typeof e.sdkAdsManager?e._isLinear?e.getDuration()-e.sdkAdsManager.getRemainingTime():e.currentTime:0},r.prototype.getVolume=function(){var e=this;return"undefined"!=typeof e.sdkAdsManager?e.sdkAdsManager.getVolume():null},r.prototype.setVolume=function(e){var i=this;a.isMobile||"undefined"==typeof i.sdkAdsManager||(LOG.debug("[bolt3] IMA setvolume",e),i.sdkAdsManager.setVolume(e),this.volume=e,i._dispatchEvent(t.Media.Event.VOLUME_CHANGED))},r.prototype.mute=function(e){!a.isMobile&&this.sdkAdsManager&&(this.muted=!!e,LOG.info("Google mute",this.muted),e?(this.sdkAdsManager.setVolume(0),this._dispatchEvent(t.Media.Event.MUTED)):(this.sdkAdsManager.setVolume(this.volume),this._dispatchEvent(t.Media.Event.UNMUTED)))},r.prototype.pause=function(){var e=this;"undefined"!=typeof e.sdkAdsManager&&e.sdkAdsManager.pause()},r.prototype.resume=function(){var e=this;"undefined"!=typeof e.sdkAdsManager&&(e.sdkAdsManager.resume(),BoltAdManager._dispatchEvent(t.Media.Event.PLAYING))},r.prototype.resize=function(e,t){var i=this,n=e||i.container.clientWidth,a=t||i.container.clientHeight,r="px";"string"==typeof e&&(r=e.indexOf("px")>0?"px":e.indexOf("%")>0?"%":"px");var o="px";if("string"==typeof t&&(o=t.toString().indexOf("px")>0?"px":t.indexOf("%")>0?"%":"px"),i.adContainerInnerDiv=i.container.querySelector("div"),i.adContainerInnerIFrame=i.container.querySelector("iframe"),i._isLinear)i.adContainerInnerDiv.style.width=parseFloat(n)+r,i.adContainerInnerDiv.style.height=parseFloat(a)+o;else{if(!i.ad)return;i.ad.getWidth()&&(i.adContainerInnerDiv.style.width=i.ad.getWidth()+"px",i.adContainerInnerDiv.style.left=(i.container.clientWidth-i.ad.getWidth())/2+"px"),i.ad.getHeight()&&(i.adContainerInnerDiv.style.height=i.ad.getHeight()+10+"px",i.adContainerInnerDiv.style.top=(i.container.clientHeight-(i.ad.getHeight()+10))/2+"px"),i.adContainerInnerIFrame.style.width="100%",i.adContainerInnerIFrame.style.height="100%"}},r.prototype.setFullscreen=function(e){e!==this.fullscreen&&(this.fullscreen=e)},r.prototype.remove=function(){var e=this;if(LOG.debug("[bolt3] Ad removed"),clearInterval(e._intervalId),clearInterval(e._sizeTrackerInterval),clearInterval(e._checkControlbarHeightIntervalId),a.isMobile)a.system.iphone&&e.iphoneExit();else try{e.adsLoader.destroy(),e.adDisplayContainer.destroy()}catch(t){}e._resetNonLinearCountdown(),e.container.style.display="none",e.container.style.visibility="hidden",BoltAdManager._dispatchEvent("removed")},r.prototype.iphoneExit=function(){var e=this;e._isLinear&&(BoltAdManager.videoElement.pause(),BoltAdManager.videoElement.webkitExitFullscreen())},r.prototype.onAdError=function(e){var i=this;if(e){var n=e.getError();LOG.error("[bolt3] AdError",n.getMessage(),n.getVastErrorCode()),window.postLogMessage("Ad error. Google says: "+n.getMessage(),"error")}i._dispatchEvent(t.ERROR)},r.prototype.onContentPauseRequested=function(){LOG.debug("GoogleAds::contentPauseRequested")},r.prototype.onContentResumeRequested=function(){LOG.debug("GoogleAds::contentResumeRequested")},r.prototype.onAdEvent=function(i){var n=this;switch(n.ad=i.getAd(),LOG.debug("[bolt3] ad event",i.type),n._isLinear=n.ad.isLinear(),i.type){case google.ima.AdEvent.Type.LOADED:if(BoltAdManager.adtechGoogleAdCount){var r=BoltAdManager.adtechGoogleAdCount;e.xhr(r,"get",null,function(){LOG.info("ADTECH adcount for Google HTML5 Ad has been fired",r),window.postLogMessage("ADTECH adcount for Google HTML5 ad has been fired "+r,"success")},function(){LOG.error("[bolt3] Failed to fire ADTECH adcount for Google HTML5 Ad ",r),window.postLogMessage("Failed to fire ADTECH adcount for Google HTML5 Ad "+r,"error")})}LOG.info("[bolt3] Got a skippable google ad?",n.ad.isSkippable()),window.postLogMessage("Received an ad from Google"),n.ad.isSkippable()&&(window.GoogleTrueViewPlayCount++,LOG.info("[bolt3] TrueView Ad played has now been played ",window.GoogleTrueViewPlayCount," times"),window.postLogMessage("TrueView Ad played is now playing "+window.GoogleTrueViewPlayCount," times")),n.duration=n.getDuration(),n.currentTime=0,n.startTime=0,BoltAdManager._dispatchEvent(t.Media.Event.LOADED),n._dispatchEvent(t.Media.Event.PLAY),n._dispatchEvent(t.Media.Event.DURATION_CHANGE),n._dispatchEvent(t.Media.Event.START_TIME_CHANGED),n.container.style.visibility="visible",n._isLinear?a.isMobile&&(BoltAdManager.videoElement.style.display="block",BoltAdManager.videoElement.style.visibility="visible"):(n._resetNonLinearCountdown(),BoltAdManager._dispatchEvent(t.Media.Event.PLAYING),n._nonLinearCountdown=setInterval(function(){n._nonLinearPseudoTime+=1,n.currentTime=n._nonLinearPseudoTime,n._dispatchEvent(t.Media.Event.TIME_UPDATE,n.currentTime),n._nonLinearPseudoTime>n._nonLinearPseudoDuration&&n.complete()},1e3));break;case google.ima.AdEvent.Type.STARTED:n.adContainerInnerDiv=n.container.querySelector("div"),n.adContainerInnerIFrame=n.container.querySelector("iframe"),n._checkTime=n._checkTime.bind(this),n._isLinear&&(n._intervalId=setInterval(n._checkTime,100)),n._dispatchEvent(t.Media.Event.PLAYING);break;case google.ima.AdEvent.Type.COMPLETE:break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:n.complete();break;case google.ima.AdEvent.Type.SKIPPED:BoltAdManager._dispatchEvent(t.Ad.Event.SKIPPED),
LOG.debug("[bolt3] Ad skipped"),window.postLogMessage("Google HTML5 Ad skipped"),n.end();break;case google.ima.AdEvent.Type.USER_CLOSE:BoltAdManager._dispatchEvent(t.Ad.Event.CLOSED),LOG.debug("[bolt3] Ad closed"),window.postLogMessage("Ad closed"),n.end();break;case google.ima.AdEvent.Type.FIRST_QUARTILE:n._dispatchEvent(t.Media.Event.FIRSTQUARTILE);break;case google.ima.AdEvent.Type.MIDPOINT:n._dispatchEvent(t.Media.Event.MIDPOINT);break;case google.ima.AdEvent.Type.THIRD_QUARTILE:n._dispatchEvent(t.Media.Event.THIRDQUARTILE);break;case google.ima.AdEvent.Type.CLICK:BoltAdManager._dispatchEvent(t.Ad.Event.CLICKED);break;case google.ima.AdEvent.Type.PAUSED:BoltAdManager._dispatchEvent(t.Media.Event.PAUSED),n._dispatchEvent(t.Media.Event.PAUSED);break;case google.ima.AdEvent.Type.RESUMED:n._dispatchEvent(t.Media.Event.RESUME)}},r.prototype.complete=function(){LOG.info("Google Ad Complete");var e=this;setTimeout(function(){BoltAdManager._dispatchEvent(t.Ad.Event.COMPLETED),e.end()},500)},r.prototype.end=function(){var e=this;e._intervalId&&clearInterval(e._intervalId),BoltAdManager._dispatchEvent(t.Media.Event.ENDED),e.sdkAdsManager.destroy(),e.sdkAdsManager=null},r.prototype._resetNonLinearCountdown=function(){this._nonLinearCountdown&&(clearInterval(this._nonLinearCountdown),this._nonLinearCountdown=null,this._nonLinearPseudoTime=0)},r.prototype._removeInnerDiv=function(){var e=this;e.container&&(e.adContainerInnerDiv=e.container.querySelector("div"),e.adContainerInnerDiv&&e.adContainerInnerDiv.parentNode.removeChild(e.adContainerInnerDiv)),e.adContainerInnerDiv=null},r.prototype._checkTime=function(){if(this.ad){var e=this.getCurrentTime();e>this.currentTime&&(this.currentTime=e,this._dispatchEvent(t.Media.Event.TIME_UPDATE,this.currentTime))}},r.prototype.getSource=function(){return this.adsRequest?this.adsRequest.adTagUrl:null},r.prototype.isLinear=function(){return!0},r}),define("zeus_vpaidshim",["zeus_eventdispatcher","swfobject","zeus_utils"],function(e){function t(t,n){e.mixin(this);var a,r,o=i.Ad.VPAID_SHIM,s="11",d=document.getElementById(t),l=o,u=null,c=!1,h=null,p=null,f=!1,v=this;v.isAd=function(){return!0},v.containerId=t,v.type=i.Ad.Type.FLASH_VPAID,v.shimInstance=n,v.duration=0,v.currentTime=0,v.volume=1,v.remainingTime=0,v.startTime=0,v.paused=!1,v.muted=!1,v.fullscreen=!1,v.hasStarted=!1,v.skin=null;var g=null,m=!1,E=!1,y=!1,_=!1,b=!1,A=!0,T=!0,w=!1,L=!1,S=0,I=function(){E||(E=!0,b=!1,S=Date.now(),g.initAd(r,a))},C=function(){clearInterval(p),p=setInterval(function(){v.currentTime<v.duration&&(v.currentTime++,v._dispatchEvent(i.Media.Event.TIME_UPDATE,v.currentTime))},1e3)},M={shim:n,onSWFLoaded:"onPlayerLoaded"},O={allowscriptaccess:"always",wmode:"opaque",allowfullscreen:!0,quality:"high",bgcolor:"#000000"},P={id:i.Ad.PLAYER_ID_PREFIX+t+"_"+Date.now()};P.name=P.id,client.browser.ie||(P.style="visibility:hidden"),v.loadPlayer=function(){if(!L){L=!0;var e=document.createElement("div");e.style.width="100%",e.style.height="100%",client.browser.ie&&(e.marginLeft="-10000px"),e.setAttribute("id","dummy"),d.appendChild(e),M.initialWidth=parseFloat(d.getAttribute("data-zeus-initial-width")),M.initialHeight=parseFloat(d.getAttribute("data-zeus-initial-height")),swfobject.embedSWF(l,"dummy","100%","100%",s,null,M,O,P)}},v.onPlayerLoaded=function(){L=!1,g=swfobject.getObjectById(P.id),D("vastLoaded","onVastLoaded"),D("vpaidLoaded","onVPaidTagLoaded"),D("vpaidUnitLoaded","onVpaidSwfLoaded"),D("AdLoaded","onAdLoaded"),D("AdDurationChange","onAdDurationChange"),D("AdError","onAdError"),D("AdStarted","onAdStarted"),D("AdStopped","onAdStopped"),D("AdPaused","onAdPaused"),D("AdResume","onAdResume"),D("AdPlaying","onAdPlaying"),D("AdSkipped","onAdSkipped"),D("AdVolumeChange","onAdVolumeChange"),D("AdRemainingTimeChange","onAdRemainingTimeChange"),D("AdVideoStart","onAdVideoStart"),D("AdVideoFirstQuartile","onAdVideoFirstQuartile"),D("AdVideoMidpoint","onAdVideoMidpoint"),D("AdVideoThirdQuartile","onAdVideoThirdQuartile"),D("AdVideoComplete","onAdVideoComplete"),D("AdExpandedChange","onAdExpandedChange"),D("AdUserClose","onAdUserClose"),D("AdUserMinimize","onAdUserMinimize"),D("AdInteraction","onAdInteraction"),D("AdClickThru","onAdClicked"),D("AdLinearChange","onAdLinearChange"),D("AdSkippableStateChange","onAdSkippableStateChange"),null!=u?v.loadVPAIDSwf(u):null!=v.vastTag&&v.loadVastTag(v.vastTag)},v.loadVastTag=function(e){LOG.debug("[bolt3] loading vast tag",e),m=!1,f=!1,c=!1,v.vastTag=e,null!=g?g.loadTag(e):v.loadPlayer()},v.onVastLoaded=function(e){v._dispatchEvent(e.type)},v.onVPaidTagLoaded=function(e){LOG.debug("[bolt3] vpaid tag loaded",e.data),y=!1,u=e.data.adLoader,a=e.data.adParams,v._dispatchEvent(e.type),v.loadVPAIDSwf(u)},v.setAdData=function(e){v.setParameters(e.linear.parameters),v.setId(e.vast.id),e.hasOwnProperty("duration")&&(v.duration=function(e){if(null===e||"string"!=typeof e||-1===e.indexOf(":"))return e;for(var t=e.split(":"),i=0,n=1;t.length>0;)i+=n*parseInt(t.pop(),10),n*=60;return i}(e.duration))},v.setParameters=function(e){a=e},v.setId=function(e){LOG.debug("[bolt3] VPAID says it is from",e),window.postLogMessage("VPAID says it is from "+e),r=e},v.setSource=function(e){u=e},v.getSource=function(){return u},v.loadVPAIDSwf=function(e){if(f=!1,c=!1,u=e,null!=g){if(_)return;LOG.debug("[bolt3] Loading VPAID Flash file"),window.postLogMessage("Loading VPAID Flash file "+u),_=!0,g.loadVPAID(u)}else v.loadPlayer()},v.onVpaidSwfLoaded=function(e){LOG.debug("[bolt3] VPAID Flash loaded.",u),window.postLogMessage("VPAID Flash file loaded"),_=!1,c=!0,v._dispatchEvent(e.type),LOG.debug("[bolt3] Autoplay",m?"on":"off"),window.postLogMessage("Autoplay "+(m?"on":"off")),m&&I()},v.remove=function(e){if(e===!0){swfobject.removeSWF(P.id);var n=document.getElementById(t);LOG.debug("[bolt3] vpaid removed"),window.postLogMessage("vpaid removed"),n.parentNode.removeChild(n)}else g&&(swfobject.removeSWF(P.id),LOG.debug("[bolt3] vpaid swf removed"),window.postLogMessage("vpaid swf removed"));g=null,m=!1,_=!1,E=!1,y=!1,f=!1,c=!1,v._dispatchEvent(i.Player.Event.REMOVED)},v.play=function(){return b?void 0:(m=!0,null==u?void LOG.error("[bolt3] vpaidswf url has not been set"):void(null!=g?c?f?g.startAd():(LOG.debug("[bolt3] Ad has not been loaded"),window.postLogMessage("Ad has not been loaded"),I()):(LOG.debug("[bolt3] vpaid swf has not been loaded"),window.postLogMessage("vpaid swf has not been loaded"),v.loadVPAIDSwf(u)):v.loadPlayer()))},v.pause=function(){LOG.debug("pause call is omitted")},v.resume=function(){},v.setVolume=function(e){v.volume=e,g&&f&&g.setAdVolume(e)},v.mute=function(e){v.muted=e,e?v._dispatchEvent(i.Media.Event.MUTED):v._dispatchEvent(i.Media.Event.UNMUTED),g&&f&&g.muteAd(e)},v.skip=function(){g&&f&&g.skipAd()},v.stop=function(){g&&f&&g.stopAd()},v.onAdLoaded=function(e){h&&clearTimeout(h),LOG.debug("[bolt3] VPAID has a third-party ad loader. It has been loaded."),window.postLogMessage("VPAID has a third-party ad loader. It has been loaded."),E=!1,f=!0,m&&(LOG.debug("[bolt3] Ad started"),window.postLogMessage("Starting VPAID"),g.startAd())},v.onAdDurationChange=function(e){var t=parseInt(e.data);t>0&&(v.duration=t),h&&clearTimeout(h),LOG.debug("[bolt3] Ad duration",v.duration),window.postLogMessage("Ad duration "+v.duration+" seconds"),v._dispatchEvent(i.Media.Event.METADATA),v._dispatchEvent(i.Media.Event.DURATION_CHANGE,v.duration)},v.onAdError=function(e){if(LOG.error("[bolt3] Ad Error",e.data),e.data.message&&"string"==typeof e.data.message?window.postLogMessage("Ad error. The Vpaid says "+e.data.message,"error"):window.postLogMessage("Ad error","error"),clearTimeout(h),g){swfobject.removeSWF(P.id);try{g.parentNode.removeChild(g)}catch(t){}}v._dispatchEvent(i.ERROR,e.data.message)};var k=0;v.onAdStarted=function(e){clearTimeout(h),g.style.visibility="visible",client.browser.ie&&(g.style.marginLeft=0),window.postLogMessage("VPAID dispatched AdStarted event","success"),b=!0,v.hasStarted=!0,k=Date.now(),v._dispatchEvent(i.Media.Event.LOADED),v._dispatchEvent(i.Media.Event.PLAY),v.onAdPlaying()},v.onAdPlaying=function(e){v.playing||(LOG.debug("[bolt3] ad playing"),v.playing=!0,C()),v._dispatchEvent(i.Media.Event.PLAYING)},v.onAdPaused=function(e){LOG.info("[bolt3] ad paused"),v.paused=!0,clearInterval(p),v._dispatchEvent(i.Media.Event.PAUSED)},v.onAdSkipped=function(e){LOG.info("[bolt3] ad skipped"),v._dispatchEvent(i.Ad.Event.SKIPPED)},v.onAdResume=function(e){LOG.debug("[bolt3] ad resume"),C(),v._dispatchEvent(i.Media.Event.RESUME)},v.onAdStopped=function(e){LOG.info("[bolt3] Ad stopped (ended)"),v.complete()},v.onAdVolumeChange=function(e){v.muted||v._dispatchEvent(i.Media.Event.VOLUME_CHANGED,e.data)},v.onAdRemainingTimeChange=function(e){clearInterval(p),v.remainingTime=e.data,v.duration>0&&(v.currentTime=v.duration-v.remainingTime),v._dispatchEvent(i.Ad.Event.REMAINING_TIME_CHANGED,v.remainingTime),v._dispatchEvent(i.Media.Event.TIME_UPDATE,v.currentTime)},v.onAdVideoStart=function(e){C()},v.onAdVideoFirstQuartile=function(e){LOG.debug("[bolt3] Reached ad firstQuartile"),v._dispatchEvent(i.Media.Event.FIRSTQUARTILE)},v.onAdVideoMidpoint=function(e){LOG.debug("[bolt3] Reached ad midpoint"),v._dispatchEvent(i.Media.Event.MIDPOINT)},v.onAdVideoThirdQuartile=function(e){LOG.debug("[bolt3] Reached ad third quartile"),v._dispatchEvent(i.Media.Event.THIRDQUARTILE)},v.onAdVideoComplete=function(e){LOG.debug("[bolt3] Reached ad completion")},v.onAdClicked=function(e){LOG.debug("[bolt3] ad clicked"),window.postLogMessage("Ad clicked"),v._dispatchEvent(i.Ad.Event.CLICKED),v.paused&&v.resume()},v.onAdUserClose=function(e){LOG.info("[bolt3] ad user close")},v.onAdUserMinimize=function(e){LOG.info("[bolt3] ad user minimize")},v.onAdExpandedChange=function(e){T=e.data,LOG.info("[bolt3] ad expanded changed, expanded",T),"Adotube"===r&&T===!1&&A===!1&&v.complete()},v.onAdInteraction=function(e){LOG.info("[bolt3] ad interaction",e)},v.onAdLinearChange=function(e){A=e.data,LOG.info(r,"ad linear change, linear?",A)},v.onAdSkippableStateChange=function(e){w=e.data,LOG.info("[bolt3] ad skippable state changed, skippable",w)},v.setFullscreen=function(e){e!==v.fullscreen&&(LOG.info("[bolt3] fullscreen",e),v.fullscreen=e)},v.complete=function(){clearInterval(p),v._dispatchEvent(i.Media.Event.ENDED)};var D=function(e,t){"function"==typeof v[t]&&g.addEventCallback(e,t)};return v.loadPlayer(),v}var i=window.ZeusConstants;return t}),define("staticImageAdsPlayer",["zeus_eventdispatcher","zeus_utils"],function(e){function t(){i=window.BoltAdManager,e.mixin(this),this._isAd=!0,this.containerId=i.containerId,this.container=i.container,this._isLinear=!0,this._checkControlbarHeightIntervalId=null,this._sizeTrackerInterval=null,this.type=n.Ad.Type.STATIC_IMAGE,this.startTime=0,this.currentTime=0,this.duration=a}var i,n=window.ZeusConstants,a=10;return t.prototype.isAd=function(){return this._isAd},t.prototype.isLinear=function(){return this._isLinear},t.prototype.playAd=function(){var e=this;e.imgElement=document.createElement("img"),e.imgElement.setAttribute("src",i.staticImage.src);var t="bolt_image_"+Math.floor(1e9*Math.random()+1);e.imgElement.setAttribute("id",t),e.imgElement.setAttribute("width",i.staticImage.width),e.imgElement.setAttribute("height",i.staticImage.height),e.container.appendChild(e.imgElement),e.containerWidth=e.container.offsetWidth,e.containerHeight=e.container.offsetHeight,e.centerAd(),i._dispatchEvent(n.Media.Event.LOADED),e._dispatchEvent(n.Media.Event.PLAY),i._dispatchEvent(n.Media.Event.PLAYING),e._dispatchEvent(n.Media.Event.PLAYING),e._sizeTrackerInterval=setInterval(function(){e.centerAd()},100)},t.prototype.play=function(){function e(){i._dispatchEvent(n.Ad.Event.CLICKED,o);var e=window.open(o,"_bolt_advertiser");e.focus()}var t=this,r=setInterval(function(){t.currentTime>a+.5?(clearInterval(r),LOG.info("StaticImageAds::ended"),t.imgElement&&(t.imgElement.parentNode.removeChild(t.imgElement),t.imgElement.removeEventListener("mousedown",e,!1)),t._dispatchEvent(n.Media.Event.ENDED),i._dispatchEvent(n.Media.Event.ENDED)):(t.currentTime+=.01,t._dispatchEvent(n.Media.Event.TIME_UPDATE,t.currentTime),i._dispatchEvent(n.Media.Event.TIME_UPDATE,t.currentTime))},10),o=i.staticImage.clickthrough;t.handleClicks=e,t.imgElement&&(t.imgElement.addEventListener("mousedown",e,!1),t.imgElement.style.cursor="pointer")},t.prototype.handleClicks=function(){i._dispatchEvent("clicked");var e=window.open(i.staticImage.clickthrough,"_bolt_advertiser");e.focus()},t.prototype.getDuration=function(){return a},t.prototype.remove=function(){var e=this;e.container.style.display="none",i._dispatchEvent(n.Player.Event.REMOVED),clearTimeout(e.timeout),clearInterval(e.timer),clearInterval(e._sizeTrackerInterval),e.removeAllListeners()},t.prototype.enterFullscreen=function(){this.setFullscreen(!0)},t.prototype.exitFullscreen=function(){this.setFullscreen(!1)},t.prototype.resize=function(e,t){LOG.debug("[bolt3] STATIC IMAGE AD RESIZE",e,t);var i=this;i.container.style.width=e,i.container.style.height=t,i.containerWidth=i.container.offsetWidth,i.containerHeight=i.container.offsetHeight,i.centerAd()},t.prototype.setFullscreen=function(e){var t=this;LOG.info("[bolt3] static image set fullscreen",e),t.fullscreen=e},t.prototype.getVolume=function(){return null},t.prototype.setVolume=function(){return null},t.prototype.getCurrentTime=function(){return this.currentTime/1e3},t.prototype.pause=function(){},t.prototype.resume=function(){},t.prototype.mute=function(){},t.prototype.centerAd=function(){var e=this;e.imgElement.setAttribute("style","margin-left:"+(e.container.offsetWidth-i.staticImage.width)/2+"px;margin-top:"+(e.container.offsetHeight-i.staticImage.height)/2+"px",!1)},t.prototype.getSource=function(){return this.imgElement.src},t}),define("vastAdsPlayer",["zeus_utils","zeus_constants","hammer","base_ad_player"],function(e,t,i,n){var a=window.client,r=n.subclass({constructor:function(){n.prototype.constructor.call(this),this.paused=!1}});return r.prototype.playAd=function(){function e(){i.adPlayer.hasBeenTouched=!0,i.adPlayer.isAd(!0),i.adPlayer.setSource(BoltAdManager.bestMedia.src),BoltAdManager.videoElement.style.visibility="visible",i.adPlayer.show(!0),i.initializeVastAd(),a.system.iphone||i.setClickthrough()}var i=this,n=BoltAdManager.bestMedia.src,r=t.Ad.PLAYER_ID_PREFIX+i.containerId;if(a.isMobile)a.system.android&&a.engine.webkit&&!a.browser.chrome&&!a.browser.opera?require(["zeus_android_webkit_video"],function(t){i.adPlayer=new t(i.containerId,r),e()}):a.system.ios?require(["ios_video"],function(t){i.adPlayer=new t(i.containerId,r),e()}):require(["zeus_mobile_video"],function(t){i.adPlayer=new t(i.containerId,r),e()});else{BoltAdManager.videoElement=document.createElement("video"),BoltAdManager.videoElement.setAttribute("id",r),i.containerWidth=i.container.clientWidth,i.containerHeight=i.container.clientHeight,BoltAdManager.videoElement.setAttribute("width","100%"),BoltAdManager.videoElement.setAttribute("height","100%"),BoltAdManager.videoElement.setAttribute("style","position:absolute;top:0;left:0;bottom:0;right:0;");var o=BoltAdManager.bestMedia.type===t.Mime.MP4&&a.browser.firefoxWithoutMp4||BoltAdManager.bestMedia.type===t.Mime.FLV||BoltAdManager.bestMedia.type===t.Mime.SWF;o&&(a.hasFlash?window.postLogMessage("Using Flash to play the ad"):window.postLogMessage("Flash is required to play the ad media","warn")),i.container.style.background="black",o?a.hasFlash?BoltAdManager.type===t.Ad.Type.FLASH_VPAID?(LOG.debug("[bolt3] Ad contains VPAID. Setting VPAID up."),window.postLogMessage("Ad contains VPAID. Setting VPAID up."),require(["zeus_vpaidshim"],function(e){window[r]&&delete window[r];var a=window[r]=new e(i.containerId,"window['"+r+"']");a.setAdData(BoltAdManager.ad),i.adPlayer=a,i.adPlayer.addEventListener(t.Ad.Event.CLICKED,function(){BoltAdManager._dispatchEvent(t.Ad.Event.CLICKED)}),a.setSource(n),i.initializeVastAd(),i.initClickTrackers(),i.container.style.background="none"})):require(["zeus_flashshim"],function(e){window[r]&&delete window[r],i.container.appendChild(BoltAdManager.videoElement);var a=window[r]=new e(i.containerId,r,"window['"+r+"']");a.addOnceEventListener(t.Media.Event.NOT_FOUND,function(){BoltAdManager._dispatchEvent(t.Ad.Event.FAILED)}),a.isAd(!0),a.setSource(n),i.adPlayer=a,i.initializeVastAd(),i.setClickthrough()}):(window.postLogMessage("Flash is required to play the ad but it's not found"),BoltAdManager._dispatchEvent(t.Ad.Event.FAILED)):require(["zeus_video"],function(e){i.container.appendChild(BoltAdManager.videoElement),i.adPlayer=new e(i.containerId,r),i.adPlayer.isAd(!0),i.adPlayer.setSource(n),i.initializeVastAd(),i.setClickthrough()})}},r.prototype.initializeVastAd=function(){var e=this;a.isMobile||e.adPlayer.addEventListener(t.Media.Event.LOADED,function(e){LOG.debug("[bolt3] Ad media loaded"),window.postLogMessage("Ad media loaded"),BoltAdManager._dispatchEvent(t.Media.Event.LOADED),BoltAdManager.ad.linear.trackImpressions(BoltAdManager.vastImpressions)}),e.adPlayer.addEventListener(t.Media.Event.DURATION_CHANGE,function(i){e.duration=e.adPlayer.duration,BoltAdManager._dispatchEvent(t.Media.Event.DURATION_CHANGE)},!1),e.adPlayer.addEventListener(t.Media.Event.ENDED,function(e){BoltAdManager.ad.linear.track("complete"),BoltAdManager._dispatchEvent(t.Media.Event.ENDED)},!1),e.adPlayer.addEventListener(t.Media.Event.PAUSED,function(i){BoltAdManager._dispatchEvent(t.Media.Event.PAUSED),BoltAdManager.ad.linear.track("pause"),e.paused=!0},!1),e.adPlayer.addEventListener(t.Media.Event.PLAYING,function(i){LOG.debug("[bolt3] tracking playing event"),BoltAdManager._dispatchEvent(t.Media.Event.PLAYING),BoltAdManager.ad.linear.track("start"),BoltAdManager.ad.linear.track("creativeView"),e.paused=!1},!1),e.adPlayer.addEventListener(t.Player.Event.CANPLAY,function(e){BoltAdManager._dispatchEvent(t.Player.Event.CANPLAY)},!1),e.adPlayer.addEventListener(t.Media.Event.METADATA,function(i){e.duration=e.adPlayer.duration,BoltAdManager._dispatchEvent(t.Media.Event.METADATA)},!1),e.adPlayer.addEventListener(t.Media.Event.MUTED,function(e){BoltAdManager.ad.linear.track("mute"),BoltAdManager._dispatchEvent(t.Media.Event.MUTED)}),e.adPlayer.addEventListener(t.Media.Event.UNMUTED,function(e){BoltAdManager.ad.linear.track("unmute"),BoltAdManager._dispatchEvent(t.Media.Event.UNMUTED)}),e.adPlayer.addEventListener(t.ERROR,function(t){e._dispatchEvent(t)}),a.isMobile?(e.adPlayer.enable(!0),e.adPlayer.preload(),BoltAdManager._dispatchEvent(t.Media.Event.LOADED),BoltAdManager.ad.linear.trackImpressions(BoltAdManager.vastImpressions)):("native"===e.adPlayer.type?e.adPlayer.preload():"flash"===e.adPlayer.type||e.adPlayer.type===t.Ad.Type.FLASH_VPAID&&e.adPlayer.play(),e.currentVolume=BoltAdManager.videoElement.volume),e.watchQuartiles(BoltAdManager,e.adPlayer)},r.prototype.watchQuartiles=function(){var e=this,i=!1,n=!1,a=!1,r=BoltAdManager.type===t.Ad.Type.FLASH_VPAID;if(r)e.adPlayer.addEventListener(t.Media.Event.FIRSTQUARTILE,function(){BoltAdManager._dispatchEvent(t.Media.Event.FIRSTQUARTILE),BoltAdManager.ad.linear.track("firstQuartile"),i=!0}),e.adPlayer.addEventListener(t.Media.Event.MIDPOINT,function(){BoltAdManager._dispatchEvent(t.Media.Event.MIDPOINT),BoltAdManager.ad.linear.track("midpoint"),n=!0}),e.adPlayer.addEventListener(t.Media.Event.THIRDQUARTILE,function(){BoltAdManager._dispatchEvent(t.Media.Event.THIRDQUARTILE),BoltAdManager.ad.linear.track("thirdQuartile"),a=!0});else{var o=setInterval(function(){e.currentTime=e.adPlayer.currentTime,e.percentPlayed=100*e.currentTime/e.duration,e.percentPlayed>=25&&(i||(BoltAdManager._dispatchEvent(t.Media.Event.FIRSTQUARTILE),BoltAdManager.ad.linear.track("firstQuartile"),i=!0)),e.percentPlayed>=50&&(n||(BoltAdManager._dispatchEvent(t.Media.Event.MIDPOINT),BoltAdManager.ad.linear.track("midpoint"),n=!0)),e.percentPlayed>=75&&(a||(BoltAdManager._dispatchEvent(t.Media.Event.THIRDQUARTILE),BoltAdManager.ad.linear.track("thirdQuartile"),a=!0))},100);e.adPlayer.addEventListener(t.Media.Event.ENDED,function(e){clearInterval(o)})}},r.prototype.initClickTrackers=function(){var e=BoltAdManager.ad.getLinear(),i=[];try{i=e.tracking.events.click}catch(n){}Array.isArray(i)&&BoltAdManager.addEventListener(t.Ad.Event.CLICKED,function(){BoltAdManager.ad.linear.track("click")})},r.prototype.setClickthrough=function(){function n(e){a.isMobile&&r.pause(),BoltAdManager._dispatchEvent(t.Ad.Event.CLICKED,s),LOG.debug("[bolt3] opening "+s),window.postLogMessage("Opening "+s);var i=window.open(s,"_bolt_advertiser");i.focus(),a.isMobile&&(r.clickElement.style.display="none",d.off("tap",n),r.adPlayer.addOnceEventListener(t.Media.Event.PLAYING,function(){setTimeout(function(){r.clickElement.style.display="block",d.on("tap",n)},500)}))}var r=this,o=BoltAdManager.ad.getLinear();if("undefined"!=typeof o&&null!==o.clickThrough){r.initClickTrackers();var s=e.substituteMacros(o.clickThrough);if(LOG.debug("[bolt3] set clickthrough to "+s),window.postLogMessage("Set clickthrough to "+s),r.clickElement=document.createElement("div"),r.clickElement.setAttribute("style","position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%;z-index:1"),r.clickElement.setAttribute("id","clickthrough_"+r.containerId),r.container.appendChild(r.clickElement),a.isMobile){var d=new i(r.clickElement);d.on("tap",n)}else r.clickElement.addEventListener("click",n,!1);r.clickElement.style.cursor="pointer"}},r.prototype.getDuration=function(){return this.duration},r.prototype.getVolume=function(){return this.adPlayer.volume},r.prototype.getCurrentTime=function(){return this.currentTime},r.prototype.pause=function(){this.adPlayer.pause()},r.prototype.resume=function(){this.adPlayer.play()},r.prototype.setVolume=function(e){var t=this;"flash"===t.adPlayer.type||"flashvpaid"===t.adPlayer.type?this.adPlayer.setVolume(e):this.adPlayer.volume=e},r.prototype.end=function(){LOG.debug("[bolt3] Vast ad ends");var e=this;e.adPlayer&&(a.isMobile?a.system.iphone?e.adPlayer.video.webkitExitFullScreen():e.adPlayer.show(!1):"flash"===e.adPlayer.type||BoltAdManager.type===t.Ad.Type.FLASH_VPAID?e.adPlayer.remove(!1):e.adPlayer.remove(!0)),"undefined"!=typeof e.clickElement&&null!=e.clickElement.parentNode&&e.clickElement.parentNode.removeChild(e.clickElement),BoltAdManager._dispatchEvent(t.Player.Event.REMOVED)},r.prototype.remove=function(){var e=this;e.end()},r.prototype.isLinear=function(){return!0},r}),define("coull_html_overlay",["base_ad_player","zeus_constants","zeus_utils"],function(e,t,i){var n=i.dom,a=e.subclass({constructor:function(){e.prototype.constructor.call(this),this.type=t.Ad.Type.OVERLAY,this._isLinear=!1,this._timer=null,this.VPAID=null,this._onAdError=this._onAdError.bind(this),this._onAdStarted=this._onAdStarted.bind(this),this._onAdLoaded=this._onAdLoaded.bind(this),this._onAdStopped=this._onAdStopped.bind(this),this._onAdUserClose=this._onAdUserClose.bind(this),this._onAdClicked=this._onAdClicked.bind(this),this._onAdImpression=this._onAdImpression.bind(this)}});return a.prototype.playAd=function(){var e=this;n.hideElement(t.UI.AD_CONTAINER),e.frame=document.createElement("iframe"),e.frame.frameBorder=0,e.frame.allowfullscreen=!0,e.frame.style.display="none",e.frame.onload=function(){var t=e.frame.contentWindow.document.createElement("script");t.src=BoltAdManager.bestMedia.src,t.onload=function(){e.VPAID=e.frame.contentWindow.getVPAIDAd(),LOG.info("coull vpaid",e.VPAID);var t=Skin.clientWidth,i=Skin.clientHeight,n={env:"production",slot:e.container,params:{video_id:CurrentVideoConfig.content.videoId,categories:"",tags:"",video_title:CurrentVideoConfig.settings.title,video_description:CurrentVideoConfig.settings.title,device_os:client.os_string,video_duration:ContentPlayer.duration||CurrentVideoConfig.duration,ad_type:"ov",player_width:t,player_height:i,page_url:window.site.href}};e.VPAID.initAd(t,i,"normal",null,null,n),e.VPAID.subscribe(e._onAdLoaded,"AdLoaded"),e.VPAID.subscribe(e._onAdStarted,"AdStarted"),e.VPAID.subscribe(e._onAdStopped,"AdStopped"),e.VPAID.subscribe(e._onAdError,"AdError"),e.VPAID.subscribe(e._onAdUserClose,"AdUserClose"),e.VPAID.subscribe(e._onAdClicked,"AdClickThru"),e.VPAID.subscribe(e._onAdImpression,"AdImpression")},e.frame.contentWindow.document.body.appendChild(t)},e.container.appendChild(e.frame),e.container.style.height=0},a.prototype._onAdLoaded=function(e){var i=this;window.postLogMessage("Coull HTML overlay ad is loaded"),BoltAdManager._dispatchEvent(t.Media.Event.LOADED),i.VPAID.unsubscribe(i._onAdLoaded,"AdLoaded"),i.VPAID.startAd()},a.prototype._onAdStarted=function(e){var i=this;i.VPAID.unsubscribe(i._onAdStarted,"AdStarted"),window.postLogMessage("Coull HTML overlay ad starts"),BoltAdManager._dispatchEvent(t.Ad.Event.STARTED),BoltAdManager._dispatchEvent(t.Media.Event.PLAYING)},a.prototype._onAdStopped=function(e){var t=this;window.postLogMessage("Coull HTML overlay ad is complete"),t.VPAID.unsubscribe(t._onAdStopped,"AdStopped"),t.end()},a.prototype._onAdUserClose=function(e){var i=this;i.VPAID.unsubscribe(i._onAdUserClose,"AdUserClose"),window.postLogMessage("Coull HTML overlay ad is closed"),BoltAdManager._dispatchEvent(t.Ad.Event.CLOSED),i.end()},a.prototype._onAdClicked=function(e){var i=this;window.postLogMessage("Coull HTML overlay ad is clicked"),i.VPAID.unsubscribe(i._onAdClicked,"AdClickThru"),BoltAdManager._dispatchEvent(t.Ad.Event.CLICKED)},a.prototype._onAdImpression=function(e){var t=this;window.postLogMessage("Coull HTML overlay fires AdImpression"),t.VPAID.unsubscribe(t._onAdImpression,"AdImpression"),BoltAdManager.ad.nonlinears.trackImpressions(BoltAdManager.vastImpressions)},a.prototype._onAdError=function(e){window.postLogMessage("Coull HTML overlay ad failed to play");var i=this;i.VPAID.unsubscribe(i._onAdError,"AdError"),i.VPAID.unsubscribe(i._onAdLoaded,"AdLoaded"),i.VPAID.unsubscribe(i._onAdStarted,"AdStarted"),i.VPAID.unsubscribe(i._onAdStopped,"AdStopped"),i.VPAID.unsubscribe(i._onAdError,"AdError"),i.VPAID.unsubscribe(i._onAdUserClose,"AdUserClose"),i.VPAID.unsubscribe(i._onAdClicked,"AdClickThru"),i.VPAID.unsubscribe(i._onAdImpression,"AdImpression"),i._dispatchEvent(t.ERROR)},a.prototype.updateLayout=function(e){var t=this;if(LOG.info("window resize"),t.VPAID){var i=t.container.clientWidth,n=Skin.clientHeight;LOG.info("Resize ad to ",i,n),t.VPAID.resizeAd(t.container.clientWidth,n)}},a.prototype.remove=function(){var e=this;e.VPAID&&(e.VPAID.unsubscribe(e._onAdError,"AdError"),e.VPAID.unsubscribe(e._onAdLoaded,"AdLoaded"),e.VPAID.unsubscribe(e._onAdStarted,"AdStarted"),e.VPAID.unsubscribe(e._onAdStopped,"AdStopped"),e.VPAID.unsubscribe(e._onAdError,"AdError"),e.VPAID.unsubscribe(e._onAdUserClose,"AdUserClose"),e.VPAID.unsubscribe(e._onAdClicked,"AdClickThru"),e.VPAID.unsubscribe(e._onAdImpression,"AdImpression")),e._duration=0,e._timer=null,e.frame&&e.frame.parentNode.removeChild(e.frame),e.VPAID=null,window.postLogMessage("Coull HTML overlay removed")},a}),define("linear_jsvpaid",["zeus_constants","zeus_utils","base_ad_player"],function(e,t,i){function n(e){LOG.info("JS playback");var t=this;t.loader=e,t.vpaid=e.vpaid,t._timer=null}function a(e){LOG.info("Native playback");var t=this;t.loader=e,t._onVideoMetadata=t._onVideoMetadata.bind(t),t._onVideoEnded=t._onVideoEnded.bind(t),t._onVideoTimeupdate=t._onVideoTimeupdate.bind(t),t._onVideoPaused=t._onVideoPaused.bind(t),t._onVideoPlaying=t._onVideoPlaying.bind(t),BoltAdManager.videoElement.addEventListener("loadedmetadata",t._onVideoMetadata),BoltAdManager.videoElement.addEventListener("ended",t._onVideoEnded),BoltAdManager.videoElement.addEventListener("pause",t._onVideoPaused),BoltAdManager.videoElement.addEventListener("playing",t._onVideoPlaying)}var r=window.client;n.prototype={videoStarted:function(){},durationChanged:function(){var t=this;LOG.info("ad duration changed",t.vpaid.getAdRemainingTime(),t.vpaid.getAdDuration()),t.loader.duration<=0&&(t.loader.sourceChanged=!0,t.loader.duration=t.loader.vpaid.getAdDuration(),t.loader._dispatchEvent(e.Media.Event.DURATION_CHANGE,t.loader.duration),BoltAdManager._dispatchEvent(e.Media.Event.PLAYING),t._timer=setInterval(function(){t._updateTime()},50))},_updateTime:function(){var e=this;e.loader._setCurrentTime(e.getCurrentTime())},getCurrentTime:function(){return this.loader.duration>0?this.loader.duration-this.vpaid.getAdRemainingTime():0},setVolume:function(e){this.vpaid&&this.vpaid.setAdVolume(e)},destroy:function(){clearInterval(this._timer)}},a.prototype={videoStarted:function(){var t=this;BoltAdManager.videoElement.style.visibility="visible",BoltAdManager.videoElement.style.display="block",t.loader.sourceChanged=!0,t.loader.duration=BoltAdManager.videoElement.duration,t.loader._dispatchEvent(e.Media.Event.DURATION_CHANGE,t.loader.duration),t.loader._dispatchEvent(e.Media.Event.PLAYING),BoltAdManager.videoElement.addEventListener("timeupdate",t._onVideoTimeupdate)},durationChanged:function(){},_onVideoMetadata:function(e){LOG.info("[bolt3] ad video metadata loaded");var t=this;BoltAdManager.videoElement.removeEventListener("loadedmetadata",t._onVideoMetadata)},_onVideoEnded:function(){},_onVideoPaused:function(){},_onVideoPlaying:function(){},_onVideoTimeupdate:function(){var e=this;e.loader._setCurrentTime(e.getCurrentTime())},getCurrentTime:function(){return BoltAdManager.videoElement.currentTime},setVolume:function(e){BoltAdManager.videoElement.volume=e},destroy:function(){var e=this;BoltAdManager.videoElement.removeEventListener("loadedmetadata",e._onVideoMetadata),BoltAdManager.videoElement.removeEventListener("ended",e._onVideoEnded),BoltAdManager.videoElement.removeEventListener("pause",e._onVideoPaused),BoltAdManager.videoElement.removeEventListener("playing",e._onVideoPlaying),BoltAdManager.videoElement.removeEventListener("timeupdate",e._onVideoTimeupdate),BoltAdManager.videoElement.src="",BoltAdManager.videoElement.load()}};var o=i.subclass({constructor:function(t,n){i.prototype.constructor.call(this,t);var a=this;a.type=e.Ad.Type.JS_VPAID,a.creativeData=n,a.paused=!1,a.frame=null,a.vpaid=null,a.duration=a.currentTime=0,a.sourceChanged=!1,a.fullscreen=!1,a.volume=0,a.muted=!1,a.hasStarted=!1,a.timer=null,a._firstQuartile=a._midpoint=a._thirdQuartile=!1,a._error=!1,a._adHandler=null,a.provider=null,a._setNativePlayback=a._setNativePlayback.bind(a),a._onAdLoaded=a._onAdLoaded.bind(a),a._onAdStarted=a._onAdStarted.bind(a),a._onAdStopped=a._onAdStopped.bind(a),a._onAdError=a._onAdError.bind(a),a._onAdLog=a._onAdLog.bind(a),a._onAdClick=a._onAdClick.bind(a),a._onAdVideoStart=a._onAdVideoStart.bind(a),a._onAdDurationChanged=a._onAdDurationChanged.bind(a),a._onAdFirstQuartile=a._onAdFirstQuartile.bind(a),a._onAdMidpoint=a._onAdMidpoint.bind(a),a._onAdThirdQuartile=a._onAdThirdQuartile.bind(a),a._nativePlayback=!1}});return o.prototype._setNativePlayback=function(){var e=this;e._nativePlayback=!0,BoltAdManager.videoElement.removeEventListener("loadstart",e._setNativePlayback)},o.prototype.playAd=function(){var t=this;LOG.info("[bolt3] "+t.provider+" JS VPAID"),window.postLogMessage("Loading "+t.provider+" JS VPAID");var i=BoltAdManager.container,n=e.Ad.PLAYER_ID_PREFIX+BoltAdManager.containerId;r.isMobile?(BoltAdManager.videoElement||LOG.error("Video element is undefined"),t._nativePlayback=!0,t._createVPAID()):(BoltAdManager.videoElement=document.createElement("video"),BoltAdManager.videoElement.setAttribute("id",n),BoltAdManager.videoElement.setAttribute("width","100%"),BoltAdManager.videoElement.setAttribute("height","100%"),BoltAdManager.videoElement.setAttribute("style","position:absolute;top:0;left:0;bottom:0;right:0;"),t.containerWidth=t.container.clientWidth,t.containerHeight=t.container.clientHeight,i.appendChild(BoltAdManager.videoElement),BoltAdManager.videoElement.addEventListener("loadstart",t._setNativePlayback),t._createVPAID())},o.prototype._createVPAID=function(){var e=this,t=e.container;e.frame=document.createElement("iframe"),e.frame.frameBorder=0,e.frame.allowfullscreen=!0,
e.frame.style.display="none",e.frame.onload=function(){var t=e.frame.contentWindow.document.createElement("script");t.src=BoltAdManager.bestMedia.src,t.onload=function(){e.vpaid=e.frame.contentWindow.getVPAIDAd(),e.vpaid.handshakeVersion("2.0"),e.vpaid.subscribe(e._onAdLoaded,"AdLoaded"),e.vpaid.subscribe(e._onAdStarted,"AdStarted"),e.vpaid.subscribe(e._onAdStopped,"AdStopped"),e.vpaid.subscribe(e._onAdError,"AdError"),e.vpaid.subscribe(e._onAdLog,"AdLog"),e.vpaid.subscribe(e._onAdClick,"AdClickThru"),e.vpaid.subscribe(e._onAdVideoStart,"AdVideoStart"),e.vpaid.subscribe(e._onAdDurationChanged,"AdDurationChange"),e.creativeData=e._getCreativeData(),e.environmentVars=e._getEnvironmentVars(),LOG.info("creative data",e.creativeData),LOG.info("environment vars",e.environmentVars),e.vpaid.initAd(BoltAdManager.videoElement.offsetWidth,BoltAdManager.videoElement.offsetHeight,"normal",600,e.creativeData,e.environmentVars)},e.frame.contentWindow.document.body.appendChild(t)},t.appendChild(e.frame)},o.prototype._getEnvironmentVars=function(){return{slot:BoltAdManager.container,videoSlot:BoltAdManager.videoElement,videoSlotCanAutoPlay:!0}},o.prototype._getCreativeData=function(){return this.creativeData||{}},o.prototype._onAdLoaded=function(){LOG.info("[bolt3] "+this.provider+" JS VPAID::ad loaded",this.frame);this.vpaid.startAd()},o.prototype._onAdStarted=function(){var e=this;LOG.info("[bolt3] "+this.provider+" JS VPAID::ad started"),e.vpaid.unsubscribe(this._onAdStarted,"AdStarted"),e._nativePlayback===!0?(LOG.info("Using native video playback"),e._adHandler=new a(e)):e._nativePlayback===!1&&(LOG.info("Using JS playback"),e._adHandler=new n(e))},o.prototype._onAdVideoStart=function(){var t=this;LOG.info("[bolt3] "+t.provider+" JS VPAID::on ad video start"),t.vpaid.unsubscribe(t._onAdVideoStart,"AdVideoStart"),t.playing=!0,t.pause=!1,t._trackCreativeView(),BoltAdManager._dispatchEvent(e.Media.Event.LOADED),t._dispatchEvent(e.Media.Event.PLAY),t._adHandler.videoStarted()},o.prototype._onAdDurationChanged=function(){this._adHandler.durationChanged()},o.prototype._onAdStopped=function(){LOG.info("[bolt3] "+this.provider+" JS VPAID::ad stopped");var t=this;t._error||(LOG.info(t.provider+" js vpaid ended"),t._dispatchEvent(e.Media.Event.ENDED),BoltAdManager.ad.linear.track("complete"),clearInterval(t.timer),setTimeout(function(){BoltAdManager._dispatchEvent(e.Media.Event.ENDED)},1e3))},o.prototype._trackCreativeView=function(){var e=this;BoltAdManager.ad.linear.track("creativeView"),BoltAdManager.ad.linear.trackImpressions(BoltAdManager.vastImpressions),BoltAdManager.ad.linear.track("start"),e.hasStarted=!0},o.prototype._setCurrentTime=function(t){var i=this;i.currentTime=t,i._dispatchEvent(e.Media.Event.TIME_UPDATE,i.currentTime),i._checkQuartiles()},o.prototype._onAdError=function(i,n){t.log.error("[bolt3] "+this.provider+" JS VPAID::ad error ",n,i),"string"==typeof i?window.postLogMessage("Ad Error. "+this.provider+" JS VPAID says "+i,"error"):window.postLogMessage("Ad Error. "+this.provider+" JS VPAID failed to play","error"),this._error=!0,this.remove(),this._dispatchEvent(e.ERROR,i)},o.prototype._checkQuartiles=function(){var e=this;e._firstQuartile?e._midpoint?e._thirdQuartile||e.currentTime/e.duration>.75&&(e._thirdQuartile=!0,e._onAdThirdQuartile()):e.currentTime/e.duration>.5&&(e._midpoint=!0,e._onAdMidpoint()):e.currentTime/e.duration>.25&&(e._firstQuartile=!0,e._onAdFirstQuartile())},o.prototype._onAdFirstQuartile=function(){LOG.info(this.provider+" JS vpaid:: first quartile"),this._dispatchEvent(e.Media.Event.FIRSTQUARTILE),BoltAdManager._dispatchEvent(e.Media.Event.FIRSTQUARTILE),BoltAdManager.ad.linear.track("firstQuartile")},o.prototype._onAdMidpoint=function(){LOG.info(this.provider+" JS vpaid:: midpoint"),this._dispatchEvent(e.Media.Event.MIDPOINT),BoltAdManager._dispatchEvent(e.Media.Event.MIDPOINT),BoltAdManager.ad.linear.track("midpoint")},o.prototype._onAdThirdQuartile=function(){LOG.info(this.provider+" JS vpaid:: third quartile"),this._dispatchEvent(e.Media.Event.THIRDQUARTILE),BoltAdManager._dispatchEvent(e.Media.Event.THIRDQUARTILE),BoltAdManager.ad.linear.track("thirdQuartile")},o.prototype._onAdClick=function(){var e=this;LOG.info("[bolt3] "+e.provider+" clicked");var i=BoltAdManager.ad.getLinear(),n=[];try{n=i.tracking.events.click}catch(a){}if(Array.isArray(n)&&n.length>0)for(var r=0;r<n.length;r++){var o=n[r].url;t.log.debug("[bolt3] tracking click",o),t.xhr(o,"get")}BoltAdManager._dispatchEvent("clicked")},o.prototype._onAdLog=function(e){LOG.info(e)},o.prototype.pause=function(){},o.prototype.resume=function(){this.vpaid&&this.vpaid.resumeAd()},o.prototype.getDuration=function(){return this.duration},o.prototype.getCurrentTime=function(){return this.vpaid?this._adHandler.getCurrentTime():0},o.prototype.setVolume=function(t){if(!r.isMobile)try{this.volume=t,this._dispatchEvent(e.Media.Event.VOLUME_CHANGED,this.volume),this._adHandler.setVolume(t)}catch(i){}},o.prototype.getSource=function(){return BoltAdManager.videoElement.currentSrc||this.media},o.prototype._removeAssets=function(){var e=this,i=e.container.children;if(t.log.warn("Element to remove",i),i.length>1)for(var n=0;n<i.length;n++){var a=i[n];a!==BoltAdManager.videoElement&&e.container.removeChild(a)}},o.prototype._removeVideoElement=function(){var e=this;if(r.isMobile)r.system.iphone?BoltAdManager.videoElement.webkitExitFullScreen():e.show(!1),BoltAdManager.videoElement.src="",BoltAdManager.videoElement.load();else try{BoltAdManager.videoElement.parentNode.removeChild(BoltAdManager.videoElement)}catch(t){}},o.prototype._unsubscribe=function(){var e=this;if(e.vpaid){LOG.info("unsubs vpaid events");try{e.vpaid.unsubscribe(e._onAdLoaded,"AdLoaded")}catch(t){}try{e.vpaid.unsubscribe(e._onAdStarted,"AdStarted")}catch(t){}try{e.vpaid.unsubscribe(e._onAdStopped,"AdStopped")}catch(t){}try{e.vpaid.unsubscribe(e._onAdError,"AdError")}catch(t){}try{e.vpaid.unsubscribe(e._onAdLog,"AdLog")}catch(t){}try{e.vpaid.unsubscribe(e._onAdClick,"AdClickThrough")}catch(t){}try{e.vpaid.unsubscribe(e._onAdVideoStart,"AdVideoStart")}catch(t){}try{e.vpaid.unsubscribe(e._onAdDurationChanged,"AdDurationChange")}catch(t){}}},o.prototype.remove=function(){LOG.info("Remove ad");var e=this;if(e._unsubscribe(),e._adHandler&&e._adHandler.destroy(),e.vpaid)try{e.vpaid.stopAd()}catch(t){}try{e.container.removeChild(e.frame)}catch(t){}e._removeAssets(),e._removeVideoElement()},o.prototype.mute=function(t){if(!r.isMobile&&t!==this.muted){this.muted=t;var i=this.volume;t?(i=0,this._dispatchEvent(e.Media.Event.MUTED)):this._dispatchEvent(e.Media.Event.UNMUTED),this.vpaid.setAdVolume(i)}},o.prototype.setFullscreen=function(t){t!==this.fullscreen&&(this.fullscreen=t,t?this._dispatchEvent(e.Player.Event.ENTER_FULLSCREEN):this._dispatchEvent(e.Player.Event.EXIT_FULLSCREEN))},o.prototype.stop=function(){},o.prototype.show=function(e){var i=BoltAdManager.videoElement;e===!0&&"block"!=i.style.display?(t.log.debug(this.containerId,"show video"),i.style.display="block"):e===!1&&"none"!=i.style.display&&(t.log.debug(this.containerId,"hide video"),i.style.display="none")},o.prototype.isLinear=function(){return!0},o}),define("zeus_liverail_jsvpaid",["linear_jsvpaid","zeus_constants"],function(e,t){var i=e.subclass({constructor:function(i){e.prototype.constructor.call(this,i),this.provider=t.Ad.Provider.LIVERAIL}});return i}),define("yume_jsvpaid",["linear_jsvpaid","zeus_constants"],function(e,t){var i=e.subclass({constructor:function(i){e.prototype.constructor.call(this,i),this.provider=t.Ad.Provider.YUME}});return i}),define("threeTwoFiftyAdsPlayer",["zeus_constants","zeus_utils","base_ad_player"],function(e,t,n){var e=window.ZeusConstants,a=10,r=4e3,o=n.subclass({constructor:function(t,i){n.prototype.constructor.call(this),this.type=e.Ad.Type.THREE_TWO_FIFTY,this._isLinear="undefined"!=typeof t?t:!0,this._checkControlbarHeightIntervalId=null,this._sizeTrackerInterval=null,this.startTime=0,this.currentTime=0,this.duration=a,this.iframeLoaded=!1,this.adTimer=null,i&&(this.container=i)}});return o.prototype.playAd=function(){var t=this;t.iframeElement=document.createElement("iframe");var i=BoltAdManager.threeTwoFifty.src;t.iframeId="bolt_iframe_"+Math.floor(1e9*Math.random()+1),t.iframeDivId="div_"+t.iframeId;var n='<!DOCTYPE html><html><head></head><body><div id="'+t.iframeDivId+'" style="width: 300px; height: 250px; overflow: hidden; left: 50%; margin-left: -150px; position: absolute; top: 50%; margin-top: -125px;border: 0px"><script language="javascript1.1" id= "script_'+t.iframeId+'" src="'+i+(new Date).getTime()+' "></script></div></body></html>';t.iframeElement.name=t.iframeId,t._isLinear?t.iframeElement.setAttribute("style","width: 300px !important;height: 250px !important; overflow: hidden; position: absolute; left: 50% !important; top: 50% !important; margin-left: -150px !important; margin-top: -140px !important; z-index: 99 !important;"):t.iframeElement.setAttribute("style","width: 100% !important;height: 100% !important; overflow: hidden; position: absolute;top:0;left:0"),t.iframeElement.onerror=t.iframeError,t.iframeElement.scrolling="no",t.container.appendChild(t.iframeElement),LOG.debug("[bolt3] ::300x250:: Ad is in the DOM"),t.iframeElement.src="javascript:'"+n+"'",t.newAdFrame=window.frames[t.iframeId],LOG.debug("[bolt3] IFRAME LOADED"),t.iframeLoaded=!0,BoltAdManager._dispatchEvent(e.Media.Event.LOADED),t._dispatchEvent(e.Media.Event.PLAY),BoltAdManager._dispatchEvent(e.Media.Event.PLAYING),t._dispatchEvent(e.Media.Event.PLAYING),t._sizeTrackerInterval=setInterval(function(){},100)},o.prototype.iframeError=function(e){alert(e)},o.prototype.crawl=function(){var t,n,a=this,o=a.newAdFrame;LOG.debug("[bolt3] CRAWLING AD FRAME"),setTimeout(function(){if(t=o.document.getElementById(a.iframeDivId)){if(LOG.debug("[bolt3] ::CRAWLING:: INNNER HTML"),n=t.childNodes,n.length<=1)return 1==n.length&&"script_"+a.iframeId==n[0].id?(LOG.debug("[bolt3] ::CRAWLING:: ORIGINAL SCRIPT TAG REMAINS ONLY"),void(a.iframeLoaded=!1)):(LOG.debug("[bolt3] ::CRAWLING:: NO CONTENT EXISTS IN FRAME"),void(a.iframeLoaded=!1));if(LOG.debug("[bolt3] ::CRAWLING:: IFRAME CONTENT EXISTS, LET's ANALYZE"),imgSearch=t.getElementsByTagName("img"),objSearch=t.getElementsByTagName("object"),iframeSearch=t.getElementsByTagName("iframe"),iframeSearch.length>0){for(LOG.debug("[bolt3] ::CRAWLING:: FOUND CHILD IFRAME NODE(s)"),LOG.info(iframeSearch),i=0;i<iframeSearch.length;i++)if(LOG.info("IFRAME size",iframeSearch[i].clientWidth,"x",iframeSearch[i].clientHeight),300==iframeSearch[i].clientWidth&&iframeSearch[i].clientHeight>=250){if(LOG.debug("[bolt3] ::CRAWLING:: FOUND CHILD IFRAME THAT HAS DIMENSIONS COMPATIBLE WITH 300x250"),iframeSearch[i].childNodes.length>0)return LOG.debug("[bolt3] ::CRAWLING SUCCESS:: FOUND 300x250 IFRAME WITH CHILD NODES"),LOG.info(iframeSearch[i]),void(a.iframeLoaded=!0);LOG.debug("[bolt3] ::CRAWLING:: FOUND CHILD IFRAME THAT IS 300x250 BUT IT HAS NO CHILD NODES - KEEP LOOKING")}}else LOG.debug("[bolt3] ::CRAWLING:: NO CHILD IFRAME NODES EXIST");if(imgSearch.length>0){for(LOG.debug("[bolt3] ::CRAWLING:: FOUND CHILD IMAGE NODE(s)"),LOG.info(iframeSearch),i=0;i<imgSearch.length;i++)if(LOG.info("IMAGE size",imgSearch[i].clientWidth,"x",imgSearch[i].clientHeight),300==imgSearch[i].clientWidth&&imgSearch[i].clientHeight>=250)return LOG.debug("[bolt3] ::CRAWLING SUCCESS:: FOUND 300x250 IMAGE OBJECT"),LOG.info(imgSearch[i]),void(a.iframeLoaded=!0);LOG.debug("[bolt3] ::CRAWLING:: IMAGES FOUND BUT NONE APPEAR TO BE SUITABLE FOR AD SPECS - NOW LOOKING FOR SUITABLE FLASH OBJECTS")}else LOG.debug("[bolt3] ::CRAWLING:: NO CHILD IMAGE NODES EXIST");if(objSearch.length>0){for(LOG.debug("[bolt3] ::CRAWLING:: FOUND FLASH OBJECT CHILD NODE(s)"),LOG.info(objSearch),i=0;i<objSearch.length;i++)if(300==objSearch[i].clientWidth&&objSearch[i].clientHeight>=250)return LOG.debug("[bolt3] ::CRAWLING SUCCESS:: FOUND A 300x250 FLASH OBJECT"),LOG.info(objSearch[i].parentNode),void(a.iframeLoaded=!0);return LOG.info(objSearch),void(a.iframeLoaded=!0)}LOG.debug("[bolt3] ::CRAWLING:: NO CHILD FLASH OBJECT NODES EXIST"),LOG.debug("[bolt3] ::CRAWLING FAILED:: CONTINUING PLAYBACK"),window.postLogMessage("350 Ad does not have a suitable content","error");try{clearInterval(a.adTimer),a.iframeElement.parentNode.removeChild(a.iframeElement)}catch(r){}return a._dispatchEvent(e.Media.Event.ENDED),BoltAdManager._dispatchEvent(e.Media.Event.ENDED),a.iframeLoaded=!1,void(a.adTimer=null)}},r)},o.prototype.play=function(){function t(){BoltAdManager._dispatchEvent(e.Ad.Event.CLICKED,clickthrough);var t=window.open(clickthrough,"_bolt_advertiser");t.focus()}var i=this;LOG.debug("[bolt3] ThreeTwoFiftyAdsPlayer play function"),window.postLogMessage("Starting 350 ad. Duration "+a+" seconds"),i.adTimer=setInterval(function(){if(i.currentTime>=a){if(clearInterval(i.adTimer),LOG.debug("[bolt3] ThreeTwoFiftyAds::ended ",i.currentTime),window.postLogMessage("350 Ad completes in "+i.currentTime),i.iframeElement){try{i.iframeElement.parentNode.removeChild(i.iframeElement)}catch(n){}i.iframeElement.removeEventListener("mousedown",t,!1)}i._dispatchEvent(e.Media.Event.ENDED),BoltAdManager._dispatchEvent(e.Media.Event.ENDED)}else i.currentTime+=.01,i._dispatchEvent(e.Media.Event.TIME_UPDATE,i.currentTime),BoltAdManager._dispatchEvent(e.Media.Event.TIME_UPDATE,i.currentTime)},10),i.iframeElement&&(i.iframeElement.addEventListener("mousedown",t,!1),i.iframeElement.style.cursor="pointer")},o.prototype.handleClicks=function(){BoltAdManager._dispatchEvent("clicked");var e=window.open(BoltAdManager.staticImage.clickthrough,"_bolt_advertiser");e.focus()},o.prototype.getDuration=function(){return a},o.prototype.remove=function(){var t=this;t.container.style.display="none",BoltAdManager._dispatchEvent(e.Player.Event.REMOVED),clearTimeout(t.timeout),clearInterval(t.timer),clearInterval(t._sizeTrackerInterval),t.removeAllListeners()},o.prototype.enterFullscreen=function(){this.setFullscreen(!0)},o.prototype.exitFullscreen=function(){this.setFullscreen(!1)},o.prototype.resize=function(e,t){LOG.debug("[bolt3] 350 AD RESIZE",e,t);var i=this;i.container.style.width=e,i.container.style.height=t,i.containerWidth=i.container.offsetWidth,i.containerHeight=i.container.offsetHeight},o.prototype.setFullscreen=function(e){var t=this;e?t._isLinear&&setTimeout(function(){t.container.style.width="100%",t.container.style.height="100%"},100):t._isLinear&&setTimeout(function(){t.container.style.width=t.containerWidth,t.container.style.height=t.containerHeight},100),t.fullscreen=e},o.prototype.getVolume=function(){return null},o.prototype.setVolume=function(){return null},o.prototype.getCurrentTime=function(){return this.currentTime/1e3},o.prototype.pause=function(){},o.prototype.resume=function(){},o.prototype.mute=function(){},o.prototype.centerAd=function(){var e=this;e.imgElement.setAttribute("style","margin-left:"+(e.container.offsetWidth-BoltAdManager.staticImage.width)/2+"px;margin-top:"+(e.container.offsetHeight-BoltAdManager.staticImage.height)/2+"px",!1)},o.prototype.getSource=function(){return this.iframeElement.src},o}),define("google_html_overlay",["base_ad_player","zeus_constants","zeus_utils"],function(e,t,i){"use strict";var n=window.site.protocol+"//s0.2mdn.net/instream/html5/ima3.js",a=window.client,r=window.View,o=window.Skin,s=i.dom,d=(i.css,e.subclass({constructor:function(){e.prototype.constructor.call(this),this._duration=30,this._isLinear=!1,this._isAd=!0,this.type=t.Ad.Type.OVERLAY,this.adDisplayContainer=null,this.adsManager=null},playAd:function(){window.postLogMessage("Loading Google HTML5 Overlay ad");var e=this;s.hideElement(t.UI.AD_CONTAINER),e.onAdsManagerLoaded=e.onAdsManagerLoaded.bind(e),e.onAdError=e.onAdError.bind(e),e.onAdEvent=e.onAdEvent.bind(e),e.initialWidth=o.clientWidth,e.initialHeight=150,e.container.style.display="block",e.container.style.visibility="hidden",e.container.style.backgroundColor="red",e.container.style.width=e.initialWidth+"px",e.container.style.height=e.initialHeight+"px",e.container.style.top="auto",e.container.style.bottom=s.getUI(t.UI.CONTROLBAR).clientHeight+10+"px";var i=function(e,t){if(e&&"string"==typeof e){var i=document.createElement("script");i.onload=function(){t&&t()},i.src=e,LOG.debug(i),document.getElementsByTagName("head")[0].appendChild(i)}},a=function(){LOG.debug("[bolt3] create ima"),e.setUpIMAContainer(),e.createAdsLoader()};"undefined"==typeof google||"undefined"==typeof google.ima?i(n,function(){LOG.debug("[bolt3] loaded google for first time!"),t.Ad.IMA_ENABLED=!0,a(),e.requestAd()}):(LOG.debug("[bolt3] google already loaded!"),a(),e.requestAd())}}));return d.prototype.setUpIMAContainer=function(){i.log.debug("[bolt3] setupIMAContainer");var e=this;e.adDisplayContainer=new google.ima.AdDisplayContainer(e.container,BoltAdManager.videoElement),e.adDisplayContainer.initialize()},d.prototype.createAdsLoader=function(){var e=this;if(e.adDisplayContainer)LOG.debug("[bolt3] create ads loader"),e.adsLoader=new google.ima.AdsLoader(e.adDisplayContainer),e.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,e.onAdsManagerLoaded,!1),e.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,e.onAdError,!1);else var t=setInterval(function(){e.adDisplayContainer&&(clearInterval(t),e.createAdsLoader())},100)},d.prototype.requestAd=function(){var e=this,t=3e4,i="text_image",n=encodeURIComponent(window.site.href);if(e.adsLoader){if(e.adsRequest=new google.ima.AdsRequest,e.customTag){var a=e.customTag.concat();a=a.replace("[referrer_url]",n),a=a.replace("[description_url]",n),a=a.replace("[ad_type]",i),a=a.replace("[timestamp]",Math.round(Date.now()/1e3).toString()),e.adsRequest.adTagUrl=a}else e.adsRequest.adTagUrl="http://googleads.g.doubleclick.net/pagead/ads?&max_ad_duration="+t+"&ad_type="+i+"&description_url="+n+"&overlay=0&channel="+BoltAdManager.googleChannel+"&client="+BoltAdManager.googlePublisherId+"&slotname="+BoltAdManager.googleSlotname+"&videoad_start_delay=0";/mpt=playwire/.test(e.adsRequest.adTagUrl)||(e.adsRequest.adTagUrl+="&mpt=playwire"),/mpv=3\.2/.test(e.adsRequest.adTagUrl)||(e.adsRequest.adTagUrl+="&mpv=3.2"),window.postLogMessage("Requesting Ad from google "+e.adsRequest.adTagUrl),LOG.info("Requesting Ad from google "+e.adsRequest.adTagUrl),e.adsRequest.nonLinearAdSlotWidth=e.initialWidth,e.adsRequest.nonLinearAdSlotHeight=e.initialHeight;try{e.adsLoader.requestAds(e.adsRequest)}catch(r){e.onAdError()}}else var o=setInterval(function(){e.adsLoader&&(clearInterval(o),e.requestAd())},100)},d.prototype.onAdsManagerLoaded=function(e){var i=this;LOG.debug("[bolt3] onAdsManagerLoaded");var n=new google.ima.AdsRenderingSettings;n.autoAlign=!0,n.useStyledNonLinearAds=!0,i.adsManager=e.getAdsManager(i.container,n),i.adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,i.onAdError),i.adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,i.onAdEvent),i.adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,i.onAdEvent),i.adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,i.onAdEvent),i.adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,i.onAdEvent),i.adsManager.addEventListener(google.ima.AdEvent.Type.CLICK,i.onAdEvent),i.adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,i.onAdEvent),i.adsManager.addEventListener(google.ima.AdEvent.Type.USER_CLOSE,i.onAdEvent),i.adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,i.onAdEvent);try{LOG.debug("[bolt3] init ads manager size",i.initialWidth,i.initialHeight),i.adsManager.init(i.initialWidth,i.initialHeight,google.ima.ViewMode.NORMAL),i.adsManager.start(),LOG.debug("[bolt3] Starting google ads manager"),BoltAdManager._dispatchEvent(t.Ad.Event.READY)}catch(a){LOG.info(a),LOG.debug("[bolt3] Google ads manager did not start"),window.postLogMessage("Google ads manager did not start","error"),i.onAdError()}},d.prototype.updateLayout=function(){var e=this;if(e.ad){if(e.googleDiv=e.container.querySelector("div"),e.googleIframe=e.container.querySelector("iframe"),e.ad.getWidth()){var t=e.ad.getWidth();LOG.info("Google overlay ad width",t),LOG.info("Google overlya ad left",(o.clientWidth-t)/2+"px"),e.container.style.width=e.googleDiv.style.width=e.ad.getWidth()+"px",e.container.style.left=(o.clientWidth-e.ad.getWidth())/2+"px"}e.ad.getHeight()&&(e.container.style.top="auto",e.container.style.height=e.googleDiv.style.height=e.ad.getHeight()+10+"px"),e.googleIframe.style.width="100%",e.googleIframe.style.height="100%"}},d.prototype.remove=function(){var e=this;if(LOG.debug("[bolt3] Ad removed"),!a.isMobile){try{e.adsManager.destroy()}catch(t){}try{e.adDisplayContainer.destroy()}catch(t){}}e._removeInnerDiv(),e.container.style.display="none",e.container.style.visibility="hidden",BoltAdManager._dispatchEvent("removed")},d.prototype.onAdError=function(e){var i=this;if(e){var n=e.getError();LOG.error("[bolt3] AdError",n.getMessage(),n.getVastErrorCode()),window.postLogMessage("Ad error. Google says: "+n.getMessage(),"error")}try{i.googleDiv.parentNode.removeChild(i.googleDiv)}catch(a){}i._dispatchEvent(t.ERROR)},d.prototype.onAdEvent=function(e){var n=this;switch(n.ad=e.getAd(),LOG.debug("[bolt3] ad event",e.type),n._isLinear=n.ad.isLinear(),e.type){case google.ima.AdEvent.Type.LOADED:if(BoltAdManager.adtechGoogleAdCount){var a=BoltAdManager.adtechGoogleAdCount;i.xhr(a,"get",null,function(){LOG.info("ADTECH adcount for Google HTML5 Ad has been fired",a),window.postLogMessage("ADTECH adcount for Google HTML5 ad has been fired "+a,"success")},function(){LOG.error("[bolt3] Failed to fire ADTECH adcount for Google HTML5 Ad ",a),window.postLogMessage("Failed to fire ADTECH adcount for Google HTML5 Ad "+a,"error")})}BoltAdManager._dispatchEvent(t.Media.Event.LOADED),window.postLogMessage("Received an ad from Google"),n.container.style.visibility="visible",r.invalidate(),BoltAdManager._dispatchEvent(t.Media.Event.PLAYING);break;case google.ima.AdEvent.Type.STARTED:n.googleDiv=n.container.querySelector("div"),n.googleIframe=n.container.querySelector("iframe"),n._checkTime=n._checkTime.bind(this),n._isLinear&&(n._intervalId=setInterval(n._checkTime,100)),BoltAdManager._dispatchEvent(t.Media.Event.PLAYING);break;case google.ima.AdEvent.Type.COMPLETE:BoltAdManager._dispatchEvent(t.Ad.Event.COMPLETED),n.end();break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:break;case google.ima.AdEvent.Type.SKIPPED:BoltAdManager._dispatchEvent(t.Ad.Event.SKIPPED),LOG.debug("[bolt3] Ad skipped"),window.postLogMessage("Google HTML5 Ad skipped"),n.end();break;case google.ima.AdEvent.Type.USER_CLOSE:BoltAdManager._dispatchEvent(t.Ad.Event.CLOSED),LOG.debug("[bolt3] Ad closed"),window.postLogMessage("Ad closed"),n.end();break;case google.ima.AdEvent.Type.CLICK:BoltAdManager._dispatchEvent("clicked");break;case google.ima.AdEvent.Type.PAUSED:BoltAdManager._dispatchEvent(t.Media.Event.PAUSED),n._dispatchEvent(t.Media.Event.PAUSED)}},d.prototype.end=function(){var e=this;e._intervalId&&clearInterval(e._intervalId),BoltAdManager._dispatchEvent(t.Media.Event.ENDED);try{e.googleDiv.parentNode.removeChild(e.googleDiv)}catch(i){}},d.prototype._removeInnerDiv=function(){var e=this;e.container&&(e.googleDiv=e.container.querySelector("div"),e.googleDiv&&e.googleDiv.parentNode.removeChild(e.googleDiv)),e.googleDiv=null},d.prototype._checkTime=function(){},d.prototype.getSource=function(){return this.adsRequest?this.adsRequest.adTagUrl:null},d}),define("aol_jsvpaid",["linear_jsvpaid","zeus_utils","zeus_constants"],function(e,t,i){var n=window.ZeusUtils.log,a=window.BoltAdManager,r=e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),this.provider=i.Ad.Provider.AOL},_onAdStarted:function(){var t=this;e.prototype._onAdStarted.call(this),t._trackCreativeView(),a._dispatchEvent(i.Media.Event.LOADED),t._dispatchEvent(i.Media.Event.PLAY)},_onAdVideoStart:function(){n.info(this.provider+" Ad Video Started")}});return r}),define("spotx_jsvpaid",["linear_jsvpaid","zeus_constants"],function(e,t){var i=e.subclass({constructor:function(i,n){e.prototype.constructor.call(this,i,n),this.provider=t.Ad.Provider.SPOTX},_onAdVideoStart:function(){this._onAdStarted(),e.prototype._onAdVideoStart.call(this)}});return i}),define("adap_jsvpaid",["linear_jsvpaid","zeus_utils","zeus_constants"],function(e,t,i){var n=e.subclass({constructor:function(t,n){e.prototype.constructor.call(this,t,n),this.provider=i.Ad.Provider.ADAP},_createVPAID:function(){var e=this,t=e.container;e.frame=document.createElement("iframe"),e.frame.frameBorder=0,e.frame.allowfullscreen=!0,e.frame.style.display="none",e.frame.onload=function(){var t=e.frame.contentWindow.document.createElement("script");t.src=BoltAdManager.bestMedia.src,t.onload=function(){e.vpaid=e.frame.contentWindow.getVPAIDAd(),e.vpaid.handshakeVersion("2.0"),e.vpaid.subscribe(e._onAdLoaded,"AdLoaded"),e.vpaid.subscribe(e._onAdStarted,"AdStarted"),e.vpaid.subscribe(e._onAdStopped,"AdStopped"),e.vpaid.subscribe(e._onAdError,"AdError"),e.vpaid.subscribe(e._onAdLog,"AdLog"),e.vpaid.subscribe(e._onAdClick,"AdClickThru"),e.vpaid.subscribe(e._onAdVideoStart,"AdVideoStart"),e.vpaid.subscribe(e._onAdDurationChanged,"AdDurationChange"),e.creativeData=e._getCreativeData(),e.environmentVars=e._getEnvironmentVars(),LOG.info("creative data",e.creativeData),LOG.info("environment vars",e.environmentVars),e.vpaid.initAd(BoltAdManager.videoElement.offsetWidth,BoltAdManager.videoElement.offsetHeight,"normal",600,e.creativeData,e.environmentVars)},e.frame.contentWindow.document.body.appendChild(t)},t.appendChild(e.frame)},_getCreativeData:function(){var e;try{e={AdParameters:this.creativeData}}catch(t){LOG.error(t)}return e}});return n});